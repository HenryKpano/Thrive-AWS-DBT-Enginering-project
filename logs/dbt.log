[0m19:29:00.114068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c2d650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109465610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109467750>]}


============================== 19:29:00.116935 | 46e40285-1c64-4bb4-ba5d-6e2c7e01e338 ==============================
[0m19:29:00.116935 [info ] [MainThread]: Running with dbt=1.10.0-b2
[0m19:29:00.117296 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/henk/.dbt', 'log_path': '/Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:29:00.124936 [info ] [MainThread]: dbt version: 1.10.0-b2
[0m19:29:00.125157 [info ] [MainThread]: python version: 3.11.5
[0m19:29:00.125320 [info ] [MainThread]: python path: /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/bin/python3
[0m19:29:00.125457 [info ] [MainThread]: os info: macOS-15.4.1-arm64-arm-64bit
[0m19:29:00.201398 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m19:29:00.201730 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m19:29:00.244010 [info ] [MainThread]: Using profiles dir at /Users/henk/.dbt
[0m19:29:00.244330 [info ] [MainThread]: Using profiles.yml file at /Users/henk/.dbt/profiles.yml
[0m19:29:00.244474 [info ] [MainThread]: Using dbt_project.yml file at /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/dbt_project.yml
[0m19:29:00.245005 [info ] [MainThread]: adapter type: redshift
[0m19:29:00.245184 [info ] [MainThread]: adapter version: 1.9.3
[0m19:29:00.284294 [info ] [MainThread]: Configuration:
[0m19:29:00.284609 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:29:00.284761 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:29:00.284889 [info ] [MainThread]: Required dependencies:
[0m19:29:00.285088 [debug] [MainThread]: Executing "git --help"
[0m19:29:00.300733 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:29:00.301331 [debug] [MainThread]: STDERR: "b''"
[0m19:29:00.301512 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:29:00.301680 [info ] [MainThread]: Connection:
[0m19:29:00.301939 [info ] [MainThread]:   host: thrive-redshift-dw.cvbrliu5nty0.ca-central-1.redshift.amazonaws.com
[0m19:29:00.302140 [info ] [MainThread]:   user: awsuser
[0m19:29:00.302270 [info ] [MainThread]:   port: 5439
[0m19:29:00.302391 [info ] [MainThread]:   database: thrivedev
[0m19:29:00.302512 [info ] [MainThread]:   method: database
[0m19:29:00.302630 [info ] [MainThread]:   cluster_id: None
[0m19:29:00.302742 [info ] [MainThread]:   iam_profile: None
[0m19:29:00.302856 [info ] [MainThread]:   schema: dev_bronze
[0m19:29:00.302969 [info ] [MainThread]:   sslmode: prefer
[0m19:29:00.303077 [info ] [MainThread]:   region: None
[0m19:29:00.303188 [info ] [MainThread]:   sslmode: prefer
[0m19:29:00.303301 [info ] [MainThread]:   region: None
[0m19:29:00.303410 [info ] [MainThread]:   autocreate: False
[0m19:29:00.303526 [info ] [MainThread]:   db_groups: []
[0m19:29:00.303633 [info ] [MainThread]:   ra3_node: False
[0m19:29:00.303741 [info ] [MainThread]:   connect_timeout: None
[0m19:29:00.303848 [info ] [MainThread]:   role: None
[0m19:29:00.303959 [info ] [MainThread]:   retries: 1
[0m19:29:00.304064 [info ] [MainThread]:   autocommit: True
[0m19:29:00.304171 [info ] [MainThread]:   access_key_id: None
[0m19:29:00.304280 [info ] [MainThread]:   is_serverless: None
[0m19:29:00.304583 [info ] [MainThread]: Registered adapter: redshift=1.9.3
[0m19:29:00.369752 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m19:29:00.372353 [debug] [MainThread]: Using redshift connection "debug"
[0m19:29:00.372502 [debug] [MainThread]: On debug: select 1 as id
[0m19:29:00.372629 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:29:00.372783 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m19:29:00.374904 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m19:29:00.865050 [debug] [MainThread]: SQL status: SUCCESS in 0.492 seconds
[0m19:29:00.922515 [debug] [MainThread]: On debug: Close
[0m19:29:00.923003 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:29:00.923200 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:29:00.925817 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.8456419, "process_in_blocks": "0", "process_kernel_time": 0.214177, "process_mem_max_rss": "132923392", "process_out_blocks": "0", "process_user_time": 0.817823}
[0m19:29:00.926119 [debug] [MainThread]: Command `dbt debug` succeeded at 19:29:00.926055 after 0.85 seconds
[0m19:29:00.926311 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:29:00.926512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090f2b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053f5d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108839650>]}
[0m19:29:00.926761 [debug] [MainThread]: Flushing usage events
[0m19:29:01.151781 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:42:58.335978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089956d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089ed650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089efc90>]}


============================== 20:42:58.339111 | e409c39e-2ac6-4b90-a512-ac3ca0886dca ==============================
[0m20:42:58.339111 [info ] [MainThread]: Running with dbt=1.10.0-b2
[0m20:42:58.339467 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/henk/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:42:58.425798 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m20:42:58.426131 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m20:42:58.522133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e409c39e-2ac6-4b90-a512-ac3ca0886dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106431b50>]}
[0m20:42:58.547838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e409c39e-2ac6-4b90-a512-ac3ca0886dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c5310>]}
[0m20:42:58.548679 [info ] [MainThread]: Registered adapter: redshift=1.9.3
[0m20:42:58.610063 [debug] [MainThread]: checksum: 5a225a3ea19c91174578d2c3f7f3bd92801a2649697bdcbd194e936bd8925adb, vars: {}, profile: , target: , version: 1.10.0b2
[0m20:42:58.610918 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:42:58.611128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e409c39e-2ac6-4b90-a512-ac3ca0886dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d8c110>]}
[0m20:42:59.084545 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_thrive1_redshift_dw.gold.dimensions
- models.dbt_thrive1_redshift_dw.gold.facts
- models.dbt_thrive1_redshift_dw.silver.facts
[0m20:42:59.086888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e409c39e-2ac6-4b90-a512-ac3ca0886dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10959d410>]}
[0m20:42:59.114056 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m20:42:59.115255 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m20:42:59.120878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e409c39e-2ac6-4b90-a512-ac3ca0886dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109da29d0>]}
[0m20:42:59.121150 [info ] [MainThread]: Found 1 model, 504 macros
[0m20:42:59.121318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e409c39e-2ac6-4b90-a512-ac3ca0886dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c83150>]}
[0m20:42:59.122101 [info ] [MainThread]: 
[0m20:42:59.122280 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:42:59.122409 [info ] [MainThread]: 
[0m20:42:59.122649 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m20:42:59.123035 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev_dev_bronze_dev_silver'
[0m20:42:59.130668 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_bronze_dev_silver"
[0m20:42:59.130912 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: BEGIN
[0m20:42:59.131044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:42:59.131188 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m20:42:59.132923 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:42:59.557188 [debug] [ThreadPool]: SQL status: SUCCESS in 0.425 seconds
[0m20:42:59.559355 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_bronze_dev_silver"
[0m20:42:59.559959 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_bronze_dev_silver"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_bronze_dev_silver'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_bronze_dev_silver'
[0m20:42:59.690167 [debug] [ThreadPool]: SQL status: SUCCESS in 0.129 seconds
[0m20:42:59.732907 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: ROLLBACK
[0m20:42:59.782590 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: Close
[0m20:42:59.786836 [debug] [MainThread]: Using redshift connection "master"
[0m20:42:59.787028 [debug] [MainThread]: On master: BEGIN
[0m20:42:59.787155 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:42:59.787288 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m20:42:59.787481 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:43:00.201883 [debug] [MainThread]: SQL status: SUCCESS in 0.414 seconds
[0m20:43:00.203523 [debug] [MainThread]: Using redshift connection "master"
[0m20:43:00.204204 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m20:43:00.281854 [debug] [MainThread]: SQL status: SUCCESS in 0.077 seconds
[0m20:43:00.283755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e409c39e-2ac6-4b90-a512-ac3ca0886dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095989d0>]}
[0m20:43:00.284408 [debug] [MainThread]: On master: ROLLBACK
[0m20:43:00.348675 [debug] [MainThread]: On master: Close
[0m20:43:00.352439 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m20:43:00.352756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_bronze_dev_silver, now model.dbt_thrive1_redshift_dw.stg_dim_user)
[0m20:43:00.352947 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m20:43:00.354814 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m20:43:00.355466 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m20:43:00.355789 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m20:43:00.356436 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:43:00.356687 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.stg_dim_user' was properly closed.
[0m20:43:00.356990 [debug] [MainThread]: Command end result
[0m20:43:00.367955 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m20:43:00.369033 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m20:43:00.372676 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/run_results.json
[0m20:43:00.375617 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.079709, "process_in_blocks": "0", "process_kernel_time": 0.266902, "process_mem_max_rss": "142229504", "process_out_blocks": "0", "process_user_time": 1.397321}
[0m20:43:00.375937 [debug] [MainThread]: Command `dbt compile` succeeded at 20:43:00.375889 after 2.08 seconds
[0m20:43:00.376149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089ef3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089efe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a361b90>]}
[0m20:43:00.376360 [debug] [MainThread]: Flushing usage events
[0m20:43:00.605167 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:53:51.315782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b25c910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b268c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2b7850>]}


============================== 20:53:51.318923 | 31ca98be-9931-4df0-9fcd-da166255bccf ==============================
[0m20:53:51.318923 [info ] [MainThread]: Running with dbt=1.10.0-b2
[0m20:53:51.319287 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/henk/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:53:51.409587 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m20:53:51.409966 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m20:53:51.505009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31ca98be-9931-4df0-9fcd-da166255bccf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c176150>]}
[0m20:53:51.529444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31ca98be-9931-4df0-9fcd-da166255bccf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ac4810>]}
[0m20:53:51.530191 [info ] [MainThread]: Registered adapter: redshift=1.9.3
[0m20:53:51.592426 [debug] [MainThread]: checksum: 5a225a3ea19c91174578d2c3f7f3bd92801a2649697bdcbd194e936bd8925adb, vars: {}, profile: , target: , version: 1.10.0b2
[0m20:53:51.647819 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m20:53:51.648154 [debug] [MainThread]: Partial parsing: added file: dbt_thrive1_redshift_dw://models/silver/dimensions/stg_dim_conversation_part.sql
[0m20:53:51.648311 [debug] [MainThread]: Partial parsing: added file: dbt_thrive1_redshift_dw://models/silver/dimensions/stg_dim_conversation_start.sql
[0m20:53:51.753372 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_thrive1_redshift_dw.silver.facts
- models.dbt_thrive1_redshift_dw.gold.facts
- models.dbt_thrive1_redshift_dw.gold.dimensions
[0m20:53:51.755879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31ca98be-9931-4df0-9fcd-da166255bccf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3120d0>]}
[0m20:53:51.813646 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m20:53:51.817804 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m20:53:51.824127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31ca98be-9931-4df0-9fcd-da166255bccf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118007dd0>]}
[0m20:53:51.824383 [info ] [MainThread]: Found 3 models, 504 macros
[0m20:53:51.824547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31ca98be-9931-4df0-9fcd-da166255bccf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b17c250>]}
[0m20:53:51.825320 [info ] [MainThread]: 
[0m20:53:51.825481 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:53:51.825606 [info ] [MainThread]: 
[0m20:53:51.825824 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m20:53:51.827590 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev_dev_bronze_dev_silver'
[0m20:53:51.835115 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_bronze_dev_silver"
[0m20:53:51.835370 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: BEGIN
[0m20:53:51.835501 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:53:51.835642 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m20:53:51.837402 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:53:52.363190 [debug] [ThreadPool]: SQL status: SUCCESS in 0.528 seconds
[0m20:53:52.363792 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_bronze_dev_silver"
[0m20:53:52.364195 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_bronze_dev_silver"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_bronze_dev_silver'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_bronze_dev_silver'
[0m20:53:52.439084 [debug] [ThreadPool]: SQL status: SUCCESS in 0.074 seconds
[0m20:53:52.474406 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: ROLLBACK
[0m20:53:52.561921 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: Close
[0m20:53:52.570675 [debug] [MainThread]: Using redshift connection "master"
[0m20:53:52.570985 [debug] [MainThread]: On master: BEGIN
[0m20:53:52.571208 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:53:52.571447 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m20:53:52.571768 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:53:53.002705 [debug] [MainThread]: SQL status: SUCCESS in 0.431 seconds
[0m20:53:53.005167 [debug] [MainThread]: Using redshift connection "master"
[0m20:53:53.006312 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m20:53:53.096678 [debug] [MainThread]: SQL status: SUCCESS in 0.089 seconds
[0m20:53:53.101986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31ca98be-9931-4df0-9fcd-da166255bccf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1180a9950>]}
[0m20:53:53.103166 [debug] [MainThread]: On master: ROLLBACK
[0m20:53:53.155709 [debug] [MainThread]: On master: Close
[0m20:53:53.159906 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m20:53:53.160257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_bronze_dev_silver, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_part)
[0m20:53:53.160439 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m20:53:53.162813 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m20:53:53.163056 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m20:53:53.163285 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m20:53:53.163627 [debug] [Thread-2 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.stg_dim_conversation_start'
[0m20:53:53.163954 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.stg_dim_user'
[0m20:53:53.164174 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m20:53:53.164355 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m20:53:53.164542 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m20:53:53.166701 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m20:53:53.167211 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m20:53:53.169548 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m20:53:53.170251 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m20:53:53.170844 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m20:53:53.171292 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m20:53:53.171815 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m20:53:53.172654 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:53:53.172937 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.stg_dim_conversation_part' was properly closed.
[0m20:53:53.173177 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.stg_dim_conversation_start' was properly closed.
[0m20:53:53.173405 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.stg_dim_user' was properly closed.
[0m20:53:53.174100 [debug] [MainThread]: Command end result
[0m20:53:53.191463 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m20:53:53.192581 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m20:53:53.197172 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/run_results.json
[0m20:53:53.200014 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.9223073, "process_in_blocks": "0", "process_kernel_time": 0.239438, "process_mem_max_rss": "140754944", "process_out_blocks": "0", "process_user_time": 1.156511}
[0m20:53:53.200295 [debug] [MainThread]: Command `dbt compile` succeeded at 20:53:53.200238 after 1.92 seconds
[0m20:53:53.200546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055b5dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105654310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105654d50>]}
[0m20:53:53.200794 [debug] [MainThread]: Flushing usage events
[0m20:53:53.413155 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:13:50.548304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096d6bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10983f290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10983fe50>]}


============================== 21:13:50.551242 | 9db5d965-01ba-49e7-86d4-0199ed2dedd0 ==============================
[0m21:13:50.551242 [info ] [MainThread]: Running with dbt=1.10.0-b2
[0m21:13:50.551592 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/henk/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:13:50.642723 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m21:13:50.643057 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m21:13:50.733157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9db5d965-01ba-49e7-86d4-0199ed2dedd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107285410>]}
[0m21:13:50.759540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9db5d965-01ba-49e7-86d4-0199ed2dedd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107014950>]}
[0m21:13:50.760289 [info ] [MainThread]: Registered adapter: redshift=1.9.3
[0m21:13:50.821207 [debug] [MainThread]: checksum: 5a225a3ea19c91174578d2c3f7f3bd92801a2649697bdcbd194e936bd8925adb, vars: {}, profile: , target: , version: 1.10.0b2
[0m21:13:50.876351 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m21:13:50.876681 [debug] [MainThread]: Partial parsing: added file: dbt_thrive1_redshift_dw://models/silver/fact/stg_fact_consolidated_messages.sql
[0m21:13:50.976071 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_thrive1_redshift_dw.gold.dimensions
- models.dbt_thrive1_redshift_dw.silver.facts
- models.dbt_thrive1_redshift_dw.gold.facts
[0m21:13:50.978557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9db5d965-01ba-49e7-86d4-0199ed2dedd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109382150>]}
[0m21:13:51.037455 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m21:13:51.038899 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m21:13:51.045094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9db5d965-01ba-49e7-86d4-0199ed2dedd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096e7f50>]}
[0m21:13:51.045372 [info ] [MainThread]: Found 4 models, 504 macros
[0m21:13:51.045538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9db5d965-01ba-49e7-86d4-0199ed2dedd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afbe890>]}
[0m21:13:51.046366 [info ] [MainThread]: 
[0m21:13:51.046537 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:13:51.046668 [info ] [MainThread]: 
[0m21:13:51.046905 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m21:13:51.048713 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev_dev_bronze_dev_silver'
[0m21:13:51.056468 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_bronze_dev_silver"
[0m21:13:51.056689 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: BEGIN
[0m21:13:51.056821 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:13:51.056977 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m21:13:51.058803 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:13:51.454043 [debug] [ThreadPool]: SQL status: SUCCESS in 0.397 seconds
[0m21:13:51.455806 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_bronze_dev_silver"
[0m21:13:51.456759 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_bronze_dev_silver"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_bronze_dev_silver'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_bronze_dev_silver'
[0m21:13:51.535042 [debug] [ThreadPool]: SQL status: SUCCESS in 0.077 seconds
[0m21:13:51.578762 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: ROLLBACK
[0m21:13:51.628602 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: Close
[0m21:13:51.633976 [debug] [MainThread]: Using redshift connection "master"
[0m21:13:51.634211 [debug] [MainThread]: On master: BEGIN
[0m21:13:51.634379 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:13:51.634556 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m21:13:51.634798 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:13:52.016099 [debug] [MainThread]: SQL status: SUCCESS in 0.381 seconds
[0m21:13:52.018335 [debug] [MainThread]: Using redshift connection "master"
[0m21:13:52.019133 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m21:13:52.097893 [debug] [MainThread]: SQL status: SUCCESS in 0.078 seconds
[0m21:13:52.102052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9db5d965-01ba-49e7-86d4-0199ed2dedd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b00e5d0>]}
[0m21:13:52.102621 [debug] [MainThread]: On master: ROLLBACK
[0m21:13:52.153999 [debug] [MainThread]: On master: Close
[0m21:13:52.162002 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m21:13:52.162390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_bronze_dev_silver, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_part)
[0m21:13:52.162589 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m21:13:52.165069 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m21:13:52.165307 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m21:13:52.165520 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m21:13:52.165833 [debug] [Thread-2 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.stg_dim_conversation_start'
[0m21:13:52.166142 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.stg_dim_user'
[0m21:13:52.166328 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m21:13:52.166491 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m21:13:52.166651 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m21:13:52.168654 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m21:13:52.168998 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m21:13:52.170498 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m21:13:52.170860 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m21:13:52.171014 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m21:13:52.171300 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m21:13:52.171569 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m21:13:52.171906 [debug] [Thread-4 (]: Began running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m21:13:52.172143 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages'
[0m21:13:52.172300 [debug] [Thread-4 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m21:13:52.174457 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m21:13:52.174879 [debug] [Thread-4 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m21:13:52.175203 [debug] [Thread-4 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m21:13:52.175683 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:13:52.175830 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.stg_dim_conversation_part' was properly closed.
[0m21:13:52.175962 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.stg_dim_conversation_start' was properly closed.
[0m21:13:52.176088 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.stg_dim_user' was properly closed.
[0m21:13:52.176206 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages' was properly closed.
[0m21:13:52.176760 [debug] [MainThread]: Command end result
[0m21:13:52.192962 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m21:13:52.193930 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m21:13:52.198384 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/run_results.json
[0m21:13:52.201023 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.6881397, "process_in_blocks": "0", "process_kernel_time": 0.236928, "process_mem_max_rss": "143228928", "process_out_blocks": "0", "process_user_time": 1.136582}
[0m21:13:52.201281 [debug] [MainThread]: Command `dbt compile` succeeded at 21:13:52.201230 after 1.69 seconds
[0m21:13:52.201495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109850110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109850210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056bdd50>]}
[0m21:13:52.201717 [debug] [MainThread]: Flushing usage events
[0m21:13:52.427144 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:01:40.167482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d8cd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de4390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de6850>]}


============================== 22:01:40.170631 | 1e997e87-8d32-44c3-b047-664821780440 ==============================
[0m22:01:40.170631 [info ] [MainThread]: Running with dbt=1.10.0-b2
[0m22:01:40.171006 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/logs', 'debug': 'False', 'profiles_dir': '/Users/henk/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt compile', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:01:40.253114 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m22:01:40.253426 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m22:01:40.342780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e997e87-8d32-44c3-b047-664821780440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d8ead0>]}
[0m22:01:40.369634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e997e87-8d32-44c3-b047-664821780440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045bd8d0>]}
[0m22:01:40.370460 [info ] [MainThread]: Registered adapter: redshift=1.9.3
[0m22:01:40.436825 [debug] [MainThread]: checksum: 5a225a3ea19c91174578d2c3f7f3bd92801a2649697bdcbd194e936bd8925adb, vars: {}, profile: , target: , version: 1.10.0b2
[0m22:01:40.495963 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 1 files changed.
[0m22:01:40.496330 [debug] [MainThread]: Partial parsing: added file: dbt_thrive1_redshift_dw://models/gold/dimensions/dim_conversation_start.sql
[0m22:01:40.496492 [debug] [MainThread]: Partial parsing: added file: dbt_thrive1_redshift_dw://models/gold/dimensions/dim_user.sql
[0m22:01:40.496637 [debug] [MainThread]: Partial parsing: added file: dbt_thrive1_redshift_dw://models/gold/dimensions/dim_conversation_part.sql
[0m22:01:40.496808 [debug] [MainThread]: Partial parsing: updated file: dbt_thrive1_redshift_dw://models/silver/fact/stg_fact_consolidated_messages.sql
[0m22:01:40.612107 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_thrive1_redshift_dw.gold.facts
- models.dbt_thrive1_redshift_dw.silver.facts
[0m22:01:40.614772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e997e87-8d32-44c3-b047-664821780440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10822f090>]}
[0m22:01:40.673062 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m22:01:40.676831 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m22:01:40.682994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e997e87-8d32-44c3-b047-664821780440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fe64d0>]}
[0m22:01:40.683261 [info ] [MainThread]: Found 7 models, 504 macros
[0m22:01:40.683431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e997e87-8d32-44c3-b047-664821780440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b00810>]}
[0m22:01:40.684313 [info ] [MainThread]: 
[0m22:01:40.684471 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:01:40.684597 [info ] [MainThread]: 
[0m22:01:40.684811 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m22:01:40.686643 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev_dev_bronze_dev_silver'
[0m22:01:40.686893 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev_dev_bronze_dev_gold'
[0m22:01:40.694798 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_bronze_dev_silver"
[0m22:01:40.696821 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_bronze_dev_gold"
[0m22:01:40.697108 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: BEGIN
[0m22:01:40.697295 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_gold: BEGIN
[0m22:01:40.697454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:01:40.697591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:01:40.697765 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:01:40.697916 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:01:40.699847 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:01:40.700069 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:01:41.184408 [debug] [ThreadPool]: SQL status: SUCCESS in 0.487 seconds
[0m22:01:41.185038 [debug] [ThreadPool]: SQL status: SUCCESS in 0.488 seconds
[0m22:01:41.185548 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_bronze_dev_gold"
[0m22:01:41.185811 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_bronze_dev_silver"
[0m22:01:41.186106 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_gold: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_bronze_dev_gold"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_bronze_dev_gold'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_bronze_dev_gold'
[0m22:01:41.186411 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_bronze_dev_silver"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_bronze_dev_silver'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_bronze_dev_silver'
[0m22:01:41.277152 [debug] [ThreadPool]: SQL status: SUCCESS in 0.090 seconds
[0m22:01:41.278611 [debug] [ThreadPool]: SQL status: SUCCESS in 0.092 seconds
[0m22:01:41.324092 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_gold: ROLLBACK
[0m22:01:41.324864 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: ROLLBACK
[0m22:01:41.383333 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: Close
[0m22:01:41.383635 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_gold: Close
[0m22:01:41.389315 [debug] [MainThread]: Using redshift connection "master"
[0m22:01:41.389562 [debug] [MainThread]: On master: BEGIN
[0m22:01:41.389744 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:01:41.389929 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:01:41.390197 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:01:41.780178 [debug] [MainThread]: SQL status: SUCCESS in 0.390 seconds
[0m22:01:41.782459 [debug] [MainThread]: Using redshift connection "master"
[0m22:01:41.784061 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m22:01:41.851374 [debug] [MainThread]: SQL status: SUCCESS in 0.067 seconds
[0m22:01:41.855965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e997e87-8d32-44c3-b047-664821780440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fe9890>]}
[0m22:01:41.857557 [debug] [MainThread]: On master: ROLLBACK
[0m22:01:41.917982 [debug] [MainThread]: On master: Close
[0m22:01:41.927146 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:01:41.927787 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:01:41.928246 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:01:41.928827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_bronze_dev_silver, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_part)
[0m22:01:41.929279 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_bronze_dev_gold, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_start)
[0m22:01:41.929778 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.stg_dim_user'
[0m22:01:41.930180 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:01:41.930549 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:01:41.930888 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:01:41.935304 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:01:41.938385 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:01:41.941169 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:01:41.942473 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:01:41.942772 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:01:41.943080 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:01:41.943606 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:01:41.944079 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:01:41.944518 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:01:41.944970 [debug] [Thread-4 (]: Began running node model.dbt_thrive1_redshift_dw.dim_user
[0m22:01:41.945388 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:01:41.945865 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:01:41.946126 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:01:41.946572 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.dim_user'
[0m22:01:41.946871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_conversation_part, now model.dbt_thrive1_redshift_dw.dim_conversation_part)
[0m22:01:41.947190 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_user, now model.dbt_thrive1_redshift_dw.dim_conversation_start)
[0m22:01:41.947471 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_conversation_start, now model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages)
[0m22:01:41.947728 [debug] [Thread-4 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_user
[0m22:01:41.947979 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:01:41.948208 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:01:41.948436 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:01:41.951360 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:01:41.954010 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:01:41.956478 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:01:41.960144 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:01:41.961415 [debug] [Thread-4 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_user
[0m22:01:41.961675 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:01:41.961889 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:01:41.962297 [debug] [Thread-4 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_user
[0m22:01:41.962697 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:01:41.962896 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:01:41.963252 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:01:41.963732 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:01:41.964371 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:01:41.964562 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_conversation_part' was properly closed.
[0m22:01:41.964735 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages' was properly closed.
[0m22:01:41.964896 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_conversation_start' was properly closed.
[0m22:01:41.965046 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_user' was properly closed.
[0m22:01:41.965695 [debug] [MainThread]: Command end result
[0m22:01:41.978547 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m22:01:41.979363 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m22:01:41.982970 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/run_results.json
[0m22:01:41.985717 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.8570695, "process_in_blocks": "0", "process_kernel_time": 0.282748, "process_mem_max_rss": "141901824", "process_out_blocks": "0", "process_user_time": 1.246737}
[0m22:01:41.985937 [debug] [MainThread]: Command `dbt compile` succeeded at 22:01:41.985896 after 1.86 seconds
[0m22:01:41.986128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ddf050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ddef50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102cec390>]}
[0m22:01:41.986322 [debug] [MainThread]: Flushing usage events
[0m22:01:42.210944 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:02:15.789428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a6a710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110aafe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ab7d90>]}


============================== 22:02:15.792197 | 3a2fdb4a-e660-4300-a0b9-c5d56bd249da ==============================
[0m22:02:15.792197 [info ] [MainThread]: Running with dbt=1.10.0-b2
[0m22:02:15.792557 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/henk/.dbt', 'log_path': '/Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:02:15.878921 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m22:02:15.879254 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m22:02:15.968124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a2fdb4a-e660-4300-a0b9-c5d56bd249da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113cead0>]}
[0m22:02:15.991430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a2fdb4a-e660-4300-a0b9-c5d56bd249da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051c4a10>]}
[0m22:02:15.992080 [info ] [MainThread]: Registered adapter: redshift=1.9.3
[0m22:02:16.052996 [debug] [MainThread]: checksum: 5a225a3ea19c91174578d2c3f7f3bd92801a2649697bdcbd194e936bd8925adb, vars: {}, profile: , target: , version: 1.10.0b2
[0m22:02:16.107855 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:02:16.108060 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:02:16.110686 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_thrive1_redshift_dw.gold.facts
- models.dbt_thrive1_redshift_dw.silver.facts
[0m22:02:16.120661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a2fdb4a-e660-4300-a0b9-c5d56bd249da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112898d50>]}
[0m22:02:16.148407 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m22:02:16.149698 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m22:02:16.156296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a2fdb4a-e660-4300-a0b9-c5d56bd249da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111eb3f50>]}
[0m22:02:16.156582 [info ] [MainThread]: Found 7 models, 504 macros
[0m22:02:16.156747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a2fdb4a-e660-4300-a0b9-c5d56bd249da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ea8310>]}
[0m22:02:16.157703 [info ] [MainThread]: 
[0m22:02:16.157879 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:02:16.158004 [info ] [MainThread]: 
[0m22:02:16.158252 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m22:02:16.160151 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev'
[0m22:02:16.160389 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev'
[0m22:02:16.169164 [debug] [ThreadPool]: Using redshift connection "list_thrivedev"
[0m22:02:16.170730 [debug] [ThreadPool]: Using redshift connection "list_thrivedev"
[0m22:02:16.171021 [debug] [ThreadPool]: On list_thrivedev: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev"} */

    select distinct nspname from pg_namespace
[0m22:02:16.171205 [debug] [ThreadPool]: On list_thrivedev: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev"} */

    select distinct nspname from pg_namespace
[0m22:02:16.171412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:02:16.171578 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:02:16.171763 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:02:16.171916 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:02:16.173986 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:02:16.174225 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:02:16.718534 [debug] [ThreadPool]: SQL status: SUCCESS in 0.547 seconds
[0m22:02:16.719650 [debug] [ThreadPool]: SQL status: SUCCESS in 0.548 seconds
[0m22:02:16.761887 [debug] [ThreadPool]: On list_thrivedev: Close
[0m22:02:16.762630 [debug] [ThreadPool]: On list_thrivedev: Close
[0m22:02:16.763361 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrivedev, now create_thrivedev_dev_bronze_dev_gold)
[0m22:02:16.763583 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrivedev, now create_thrivedev_dev_bronze_dev_silver)
[0m22:02:16.763882 [debug] [ThreadPool]: Creating schema "database: "thrivedev"
schema: "dev_bronze_dev_gold"
"
[0m22:02:16.764127 [debug] [ThreadPool]: Creating schema "database: "thrivedev"
schema: "dev_bronze_dev_silver"
"
[0m22:02:16.797492 [debug] [ThreadPool]: Using redshift connection "create_thrivedev_dev_bronze_dev_gold"
[0m22:02:16.798869 [debug] [ThreadPool]: Using redshift connection "create_thrivedev_dev_bronze_dev_silver"
[0m22:02:16.799043 [debug] [ThreadPool]: On create_thrivedev_dev_bronze_dev_gold: BEGIN
[0m22:02:16.799183 [debug] [ThreadPool]: On create_thrivedev_dev_bronze_dev_silver: BEGIN
[0m22:02:16.799311 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:02:16.799432 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:02:16.799573 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:02:16.799709 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:02:16.799902 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:02:16.800062 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:02:17.235066 [debug] [ThreadPool]: SQL status: SUCCESS in 0.435 seconds
[0m22:02:17.236420 [debug] [ThreadPool]: SQL status: SUCCESS in 0.437 seconds
[0m22:02:17.237391 [debug] [ThreadPool]: Using redshift connection "create_thrivedev_dev_bronze_dev_gold"
[0m22:02:17.237793 [debug] [ThreadPool]: Using redshift connection "create_thrivedev_dev_bronze_dev_silver"
[0m22:02:17.238227 [debug] [ThreadPool]: On create_thrivedev_dev_bronze_dev_gold: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "create_thrivedev_dev_bronze_dev_gold"} */
create schema if not exists "dev_bronze_dev_gold"
[0m22:02:17.239963 [debug] [ThreadPool]: On create_thrivedev_dev_bronze_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "create_thrivedev_dev_bronze_dev_silver"} */
create schema if not exists "dev_bronze_dev_silver"
[0m22:02:17.349018 [debug] [ThreadPool]: SQL status: SUCCESS in 0.108 seconds
[0m22:02:17.352600 [debug] [ThreadPool]: On create_thrivedev_dev_bronze_dev_gold: COMMIT
[0m22:02:17.353567 [debug] [ThreadPool]: Using redshift connection "create_thrivedev_dev_bronze_dev_gold"
[0m22:02:17.354014 [debug] [ThreadPool]: On create_thrivedev_dev_bronze_dev_gold: COMMIT
[0m22:02:17.397419 [debug] [ThreadPool]: SQL status: SUCCESS in 0.156 seconds
[0m22:02:17.400218 [debug] [ThreadPool]: On create_thrivedev_dev_bronze_dev_silver: COMMIT
[0m22:02:17.400972 [debug] [ThreadPool]: Using redshift connection "create_thrivedev_dev_bronze_dev_silver"
[0m22:02:17.401377 [debug] [ThreadPool]: On create_thrivedev_dev_bronze_dev_silver: COMMIT
[0m22:02:18.518616 [debug] [ThreadPool]: SQL status: SUCCESS in 1.116 seconds
[0m22:02:18.520415 [debug] [ThreadPool]: SQL status: SUCCESS in 1.166 seconds
[0m22:02:18.521618 [debug] [ThreadPool]: On create_thrivedev_dev_bronze_dev_silver: Close
[0m22:02:18.522147 [debug] [ThreadPool]: On create_thrivedev_dev_bronze_dev_gold: Close
[0m22:02:18.526015 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_thrivedev_dev_bronze_dev_gold, now list_thrivedev_dev_bronze_dev_gold)
[0m22:02:18.526926 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_thrivedev_dev_bronze_dev_silver, now list_thrivedev_dev_bronze_dev_silver)
[0m22:02:18.542348 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_bronze_dev_silver"
[0m22:02:18.542835 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_bronze_dev_gold"
[0m22:02:18.543161 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: BEGIN
[0m22:02:18.543414 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_gold: BEGIN
[0m22:02:18.543658 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:02:18.543865 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:02:18.544125 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:02:18.544349 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:02:18.544755 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:02:18.545040 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:02:18.980401 [debug] [ThreadPool]: SQL status: SUCCESS in 0.436 seconds
[0m22:02:18.982430 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_bronze_dev_silver"
[0m22:02:18.983031 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_bronze_dev_silver"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_bronze_dev_silver'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_bronze_dev_silver'
[0m22:02:18.984066 [debug] [ThreadPool]: SQL status: SUCCESS in 0.440 seconds
[0m22:02:18.984453 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_bronze_dev_gold"
[0m22:02:18.984649 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_gold: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_bronze_dev_gold"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_bronze_dev_gold'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_bronze_dev_gold'
[0m22:02:19.075747 [debug] [ThreadPool]: SQL status: SUCCESS in 0.092 seconds
[0m22:02:19.076976 [debug] [ThreadPool]: SQL status: SUCCESS in 0.092 seconds
[0m22:02:19.080631 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: ROLLBACK
[0m22:02:19.082387 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_gold: ROLLBACK
[0m22:02:19.147724 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: Close
[0m22:02:19.149067 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_gold: Close
[0m22:02:19.162541 [debug] [MainThread]: Using redshift connection "master"
[0m22:02:19.163000 [debug] [MainThread]: On master: BEGIN
[0m22:02:19.163318 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:02:19.163659 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:02:19.164113 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:02:19.610675 [debug] [MainThread]: SQL status: SUCCESS in 0.447 seconds
[0m22:02:19.612878 [debug] [MainThread]: Using redshift connection "master"
[0m22:02:19.613964 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m22:02:19.680502 [debug] [MainThread]: SQL status: SUCCESS in 0.066 seconds
[0m22:02:19.684585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a2fdb4a-e660-4300-a0b9-c5d56bd249da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105641750>]}
[0m22:02:19.686687 [debug] [MainThread]: On master: ROLLBACK
[0m22:02:19.745920 [debug] [MainThread]: Using redshift connection "master"
[0m22:02:19.747597 [debug] [MainThread]: On master: BEGIN
[0m22:02:19.774219 [debug] [MainThread]: SQL status: SUCCESS in 0.026 seconds
[0m22:02:19.775752 [debug] [MainThread]: On master: COMMIT
[0m22:02:19.776545 [debug] [MainThread]: Using redshift connection "master"
[0m22:02:19.777014 [debug] [MainThread]: On master: COMMIT
[0m22:02:19.837621 [debug] [MainThread]: SQL status: SUCCESS in 0.060 seconds
[0m22:02:19.839549 [debug] [MainThread]: On master: Close
[0m22:02:19.848006 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:02:19.848990 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:02:19.849433 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:02:19.850102 [info ] [Thread-1 (]: 1 of 7 START sql incremental model dev_bronze_dev_silver.stg_dim_conversation_part  [RUN]
[0m22:02:19.850793 [info ] [Thread-2 (]: 2 of 7 START sql incremental model dev_bronze_dev_silver.stg_dim_conversation_start  [RUN]
[0m22:02:19.851388 [info ] [Thread-3 (]: 3 of 7 START sql incremental model dev_bronze_dev_silver.stg_dim_user .......... [RUN]
[0m22:02:19.852000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_bronze_dev_gold, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_part)
[0m22:02:19.852434 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_bronze_dev_silver, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_start)
[0m22:02:19.852998 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.stg_dim_user'
[0m22:02:19.853416 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:02:19.853789 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:02:19.854137 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:02:19.858617 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:02:19.862255 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:02:19.864942 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:02:19.866353 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:02:19.866770 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:02:19.867114 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:02:19.909895 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:02:19.910497 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:02:19.912754 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:02:19.914066 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:02:19.914760 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:02:19.914948 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: BEGIN
[0m22:02:19.915606 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:02:19.915794 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: BEGIN
[0m22:02:19.915978 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:02:19.916164 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: BEGIN
[0m22:02:19.916330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:02:19.916514 [debug] [Thread-2 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:02:19.916671 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:02:19.916836 [debug] [Thread-1 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:02:19.917071 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:02:19.917236 [debug] [Thread-3 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:02:19.917424 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:02:19.917938 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:02:20.333222 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.416 seconds
[0m22:02:20.335951 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.419 seconds
[0m22:02:20.337120 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:02:20.337804 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:02:20.338344 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"} */

      
  
    

  create  table
    "thrivedev"."dev_bronze_dev_silver"."stg_dim_conversation_start"
    
    
    
  as (
    

select
    id, 
    source_type, 
    conv_dataset_email, 
    priority, 
    message, 
    created_at,
    getdate() as get_date_at
from
    dev_bronze.ext_conversation_start
  );
[0m22:02:20.338893 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"} */

      
  
    

  create  table
    "thrivedev"."dev_bronze_dev_silver"."stg_dim_conversation_part"
    
    
    
  as (
    

select
    id, 
    conversation_id, 
    conv_dataset_email, 
    part_type, 
    message, 
    created_at,
    getdate() as get_date_at
from
    dev_bronze.ext_conversation_part
  );
[0m22:02:20.390690 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.473 seconds
[0m22:02:20.392239 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:02:20.393336 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_user"} */

      
  
    

  create  table
    "thrivedev"."dev_bronze_dev_silver"."stg_dim_user"
    
    
    
  as (
    

select
    id,
    name,
    email,
    is_customer,
    getdate() as get_date_at
from
    dev_bronze.ext_users
  );
[0m22:02:39.725123 [debug] [Thread-2 (]: SQL status: SUCCESS in 19.390 seconds
[0m22:02:39.748817 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: COMMIT
[0m22:02:39.749487 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:02:39.749847 [debug] [Thread-1 (]: SQL status: SUCCESS in 19.416 seconds
[0m22:02:39.750237 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: COMMIT
[0m22:02:39.751852 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: COMMIT
[0m22:02:39.752498 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:02:39.753169 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: COMMIT
[0m22:02:39.789027 [debug] [Thread-3 (]: SQL status: SUCCESS in 19.400 seconds
[0m22:02:39.791309 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: COMMIT
[0m22:02:39.791849 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:02:39.792184 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: COMMIT
[0m22:02:39.876654 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.122 seconds
[0m22:02:39.881681 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: Close
[0m22:02:39.884573 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a2fdb4a-e660-4300-a0b9-c5d56bd249da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107055c90>]}
[0m22:02:39.885890 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model dev_bronze_dev_silver.stg_dim_conversation_part  [[32mSUCCESS[0m in 20.03s]
[0m22:02:39.886779 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:02:39.887691 [debug] [Thread-4 (]: Began running node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:02:39.888443 [info ] [Thread-4 (]: 4 of 7 START sql incremental model dev_bronze_dev_gold.dim_conversation_part ... [RUN]
[0m22:02:39.889074 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.dim_conversation_part'
[0m22:02:39.889471 [debug] [Thread-4 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:02:39.898209 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:02:39.899404 [debug] [Thread-4 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:02:39.903737 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:02:39.905644 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:02:39.906046 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: BEGIN
[0m22:02:39.906312 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:02:39.906574 [debug] [Thread-4 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:02:39.906999 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:02:39.934746 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.182 seconds
[0m22:02:39.935229 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.143 seconds
[0m22:02:39.936177 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: Close
[0m22:02:39.936735 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: Close
[0m22:02:39.937562 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a2fdb4a-e660-4300-a0b9-c5d56bd249da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fdab90>]}
[0m22:02:39.937920 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a2fdb4a-e660-4300-a0b9-c5d56bd249da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fdad50>]}
[0m22:02:39.938355 [info ] [Thread-2 (]: 2 of 7 OK created sql incremental model dev_bronze_dev_silver.stg_dim_conversation_start  [[32mSUCCESS[0m in 20.09s]
[0m22:02:39.938668 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model dev_bronze_dev_silver.stg_dim_user ..... [[32mSUCCESS[0m in 20.09s]
[0m22:02:39.938954 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:02:39.939167 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:02:39.939563 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:02:39.939831 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.dim_user
[0m22:02:39.940034 [info ] [Thread-1 (]: 5 of 7 START sql incremental model dev_bronze_dev_gold.dim_conversation_start .. [RUN]
[0m22:02:39.940211 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:02:39.940410 [info ] [Thread-3 (]: 6 of 7 START sql incremental model dev_bronze_dev_gold.dim_user ................ [RUN]
[0m22:02:39.940629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_conversation_part, now model.dbt_thrive1_redshift_dw.dim_conversation_start)
[0m22:02:39.940832 [info ] [Thread-2 (]: 7 of 7 START sql incremental model dev_bronze_dev_silver.stg_fact_consolidated_messages  [RUN]
[0m22:02:39.941014 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_user, now model.dbt_thrive1_redshift_dw.dim_user)
[0m22:02:39.941182 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:02:39.941339 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_conversation_start, now model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages)
[0m22:02:39.941500 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_user
[0m22:02:39.943908 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:02:39.944282 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:02:39.946650 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:02:39.949497 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:02:39.949887 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:02:39.952696 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:02:39.952984 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_user
[0m22:02:39.955808 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:02:39.956029 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:02:39.958445 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:02:39.959351 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:02:39.960033 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:02:39.960224 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: BEGIN
[0m22:02:39.960427 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_user: BEGIN
[0m22:02:39.960644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:02:39.962854 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:02:39.963020 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:02:39.963235 [debug] [Thread-1 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:02:39.963456 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: BEGIN
[0m22:02:39.963653 [debug] [Thread-3 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:02:39.963919 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:02:39.964106 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:02:39.964318 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:02:39.964882 [debug] [Thread-2 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:02:39.965773 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:02:40.334338 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.427 seconds
[0m22:02:40.337497 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:02:40.338530 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_part"} */

      
  
    

  create  table
    "thrivedev"."dev_bronze_dev_gold"."dim_conversation_part"
    
    
    
  as (
    

select
    id as part_id,
    conversation_id,
    conv_dataset_email,
    part_type,
    message,
    created_at,
    get_date_at
from
    "thrivedev"."dev_bronze_dev_silver"."stg_dim_conversation_part"



  );
[0m22:02:40.432040 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.467 seconds
[0m22:02:40.433794 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.471 seconds
[0m22:02:40.434794 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:02:40.435451 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:02:40.436256 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"} */

      
  
    

  create  table
    "thrivedev"."dev_bronze_dev_silver"."stg_fact_consolidated_messages"
    
    
    
  as (
    


WITH
  start_msgs AS (
    SELECT
      id           AS msg_id,
      conv_dataset_email AS email,
      id           AS conversation_id,
      message,
      'open'       AS message_type,
      created_at
    FROM 
        "thrivedev"."dev_bronze_dev_silver"."stg_dim_conversation_start"
  ),
  part_msgs AS (
    SELECT
      id           AS msg_id,
      conv_dataset_email AS email,
      conversation_id,
      message,
      part_type    AS message_type,
      created_at
    FROM 
        "thrivedev"."dev_bronze_dev_silver"."stg_dim_conversation_part"
  ),
  all_msgs AS (
    SELECT * FROM start_msgs
    UNION ALL
    SELECT * FROM part_msgs
  ),
  conv_customer AS (
    SELECT
      am.conversation_id,
      u.id AS user_id
    FROM all_msgs am
    INNER JOIN "thrivedev"."dev_bronze_dev_silver"."stg_dim_user" u
      ON am.email = u.email
    WHERE u.is_customer = 1
    GROUP BY am.conversation_id
  )
SELECT
  am.msg_id      AS id,
  cc.user_id     AS user_id,
  am.email       AS email,
  am.conversation_id,
  am.message,
  am.message_type,
  am.created_at
FROM all_msgs am
INNER JOIN conv_customer cc
  ON am.conversation_id = cc.conversation_id
ORDER BY
  am.conversation_id,
  am.created_at;
  );
[0m22:02:40.436974 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_user"} */

      
  
    

  create  table
    "thrivedev"."dev_bronze_dev_gold"."dim_user"
    
    
    
  as (
    

select
    id as user_id,
    name,
    email,
    is_customer,
    get_date_at
from
    "thrivedev"."dev_bronze_dev_silver"."stg_dim_user"


  );
[0m22:02:40.439615 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.479 seconds
[0m22:02:40.439983 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:02:40.440301 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_start"} */

      
  
    

  create  table
    "thrivedev"."dev_bronze_dev_gold"."dim_conversation_start"
    
    
    
  as (
    

select
    id, 
    source_type, 
    conv_dataset_email, 
    priority, 
    message, 
    created_at,
    get_date_at
from
    "thrivedev"."dev_bronze_dev_silver"."stg_dim_conversation_start"


  );
[0m22:02:40.477030 [debug] [Thread-2 (]: Redshift adapter: Redshift error: syntax error at or near ";" in context "am.created_at;", at line 67, column 16
[0m22:02:40.478889 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: ROLLBACK
[0m22:02:40.539328 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: Close
[0m22:02:40.550878 [debug] [Thread-2 (]: Database Error in model stg_fact_consolidated_messages (models/silver/fact/stg_fact_consolidated_messages.sql)
  syntax error at or near ";" in context "am.created_at;", at line 67, column 16
  compiled code at target/run/dbt_thrive1_redshift_dw/models/silver/fact/stg_fact_consolidated_messages.sql
[0m22:02:40.551951 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a2fdb4a-e660-4300-a0b9-c5d56bd249da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fc2590>]}
[0m22:02:40.553074 [error] [Thread-2 (]: 7 of 7 ERROR creating sql incremental model dev_bronze_dev_silver.stg_fact_consolidated_messages  [[31mERROR[0m in 0.61s]
[0m22:02:40.553815 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:02:40.554486 [debug] [Thread-7 (]: Marking all children of 'model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages' to be skipped because of status 'error'.  Reason: Database Error in model stg_fact_consolidated_messages (models/silver/fact/stg_fact_consolidated_messages.sql)
  syntax error at or near ";" in context "am.created_at;", at line 67, column 16
  compiled code at target/run/dbt_thrive1_redshift_dw/models/silver/fact/stg_fact_consolidated_messages.sql.
[0m22:02:46.273201 [debug] [Thread-3 (]: SQL status: SUCCESS in 5.836 seconds
[0m22:02:46.275110 [debug] [Thread-4 (]: SQL status: SUCCESS in 5.937 seconds
[0m22:02:46.279415 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_user: COMMIT
[0m22:02:46.282216 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: COMMIT
[0m22:02:46.283021 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:02:46.283598 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:02:46.283990 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_user: COMMIT
[0m22:02:46.284359 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: COMMIT
[0m22:02:46.442291 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.158 seconds
[0m22:02:46.443019 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_user: Close
[0m22:02:46.443432 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a2fdb4a-e660-4300-a0b9-c5d56bd249da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fd9390>]}
[0m22:02:46.443771 [info ] [Thread-3 (]: 6 of 7 OK created sql incremental model dev_bronze_dev_gold.dim_user ........... [[32mSUCCESS[0m in 6.50s]
[0m22:02:46.444038 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_user
[0m22:02:46.449777 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.165 seconds
[0m22:02:46.450207 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: Close
[0m22:02:46.450699 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a2fdb4a-e660-4300-a0b9-c5d56bd249da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a6ac50>]}
[0m22:02:46.451441 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model dev_bronze_dev_gold.dim_conversation_part  [[32mSUCCESS[0m in 6.56s]
[0m22:02:46.451971 [debug] [Thread-4 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:02:46.472757 [debug] [Thread-1 (]: SQL status: SUCCESS in 6.034 seconds
[0m22:02:46.474301 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: COMMIT
[0m22:02:46.474622 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:02:46.474784 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: COMMIT
[0m22:02:46.570331 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.095 seconds
[0m22:02:46.572277 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: Close
[0m22:02:46.573379 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a2fdb4a-e660-4300-a0b9-c5d56bd249da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fc3890>]}
[0m22:02:46.574303 [info ] [Thread-1 (]: 5 of 7 OK created sql incremental model dev_bronze_dev_gold.dim_conversation_start  [[32mSUCCESS[0m in 6.63s]
[0m22:02:46.574740 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:02:46.575760 [debug] [MainThread]: Using redshift connection "master"
[0m22:02:46.575969 [debug] [MainThread]: On master: BEGIN
[0m22:02:46.576108 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:02:46.576246 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:02:46.576461 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:02:47.303624 [debug] [MainThread]: SQL status: SUCCESS in 0.727 seconds
[0m22:02:47.305750 [debug] [MainThread]: On master: COMMIT
[0m22:02:47.307378 [debug] [MainThread]: Using redshift connection "master"
[0m22:02:47.308055 [debug] [MainThread]: On master: COMMIT
[0m22:02:47.366749 [debug] [MainThread]: SQL status: SUCCESS in 0.058 seconds
[0m22:02:47.368256 [debug] [MainThread]: On master: Close
[0m22:02:47.370172 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:02:47.371317 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_conversation_start' was properly closed.
[0m22:02:47.371711 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages' was properly closed.
[0m22:02:47.372038 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_user' was properly closed.
[0m22:02:47.372387 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_conversation_part' was properly closed.
[0m22:02:47.372916 [info ] [MainThread]: 
[0m22:02:47.373405 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 31.21 seconds (31.21s).
[0m22:02:47.375145 [debug] [MainThread]: Command end result
[0m22:02:47.405413 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m22:02:47.407060 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m22:02:47.411425 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/run_results.json
[0m22:02:47.411668 [info ] [MainThread]: 
[0m22:02:47.411907 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:02:47.412101 [info ] [MainThread]: 
[0m22:02:47.412351 [error] [MainThread]: [31mFailure in model stg_fact_consolidated_messages (models/silver/fact/stg_fact_consolidated_messages.sql)[0m
[0m22:02:47.412591 [error] [MainThread]:   Database Error in model stg_fact_consolidated_messages (models/silver/fact/stg_fact_consolidated_messages.sql)
  syntax error at or near ";" in context "am.created_at;", at line 67, column 16
  compiled code at target/run/dbt_thrive1_redshift_dw/models/silver/fact/stg_fact_consolidated_messages.sql
[0m22:02:47.412771 [info ] [MainThread]: 
[0m22:02:47.412985 [info ] [MainThread]:   compiled code at target/compiled/dbt_thrive1_redshift_dw/models/silver/fact/stg_fact_consolidated_messages.sql
[0m22:02:47.413157 [info ] [MainThread]: 
[0m22:02:47.413350 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m22:02:47.416121 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 31.669062, "process_in_blocks": "0", "process_kernel_time": 0.310497, "process_mem_max_rss": "142016512", "process_out_blocks": "0", "process_user_time": 2.026143}
[0m22:02:47.416418 [debug] [MainThread]: Command `dbt run` failed at 22:02:47.416359 after 31.67 seconds
[0m22:02:47.416674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103614cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103614c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11045c650>]}
[0m22:02:47.416899 [debug] [MainThread]: Flushing usage events
[0m22:02:47.670042 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:03:17.101410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066ab890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1152b7410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1152b7b50>]}


============================== 22:03:17.104341 | 65cf4370-c5b0-4a5f-9645-54528fb23f48 ==============================
[0m22:03:17.104341 [info ] [MainThread]: Running with dbt=1.10.0-b2
[0m22:03:17.104708 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/henk/.dbt', 'log_path': '/Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt compile', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:03:17.188398 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m22:03:17.188752 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m22:03:17.276938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65cf4370-c5b0-4a5f-9645-54528fb23f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f4fd90>]}
[0m22:03:17.300183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65cf4370-c5b0-4a5f-9645-54528fb23f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066c4950>]}
[0m22:03:17.300815 [info ] [MainThread]: Registered adapter: redshift=1.9.3
[0m22:03:17.363077 [debug] [MainThread]: checksum: 5a225a3ea19c91174578d2c3f7f3bd92801a2649697bdcbd194e936bd8925adb, vars: {}, profile: , target: , version: 1.10.0b2
[0m22:03:17.418205 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:03:17.418506 [debug] [MainThread]: Partial parsing: updated file: dbt_thrive1_redshift_dw://models/silver/fact/stg_fact_consolidated_messages.sql
[0m22:03:17.519023 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_thrive1_redshift_dw.silver.facts
- models.dbt_thrive1_redshift_dw.gold.facts
[0m22:03:17.521522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65cf4370-c5b0-4a5f-9645-54528fb23f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a1c590>]}
[0m22:03:17.578536 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m22:03:17.579683 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m22:03:17.585648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65cf4370-c5b0-4a5f-9645-54528fb23f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116b5ec50>]}
[0m22:03:17.585900 [info ] [MainThread]: Found 7 models, 504 macros
[0m22:03:17.586067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65cf4370-c5b0-4a5f-9645-54528fb23f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116b941d0>]}
[0m22:03:17.586902 [info ] [MainThread]: 
[0m22:03:17.587076 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:03:17.587205 [info ] [MainThread]: 
[0m22:03:17.587432 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m22:03:17.589334 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev_dev_bronze_dev_gold'
[0m22:03:17.589580 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev_dev_bronze_dev_silver'
[0m22:03:17.597438 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_bronze_dev_gold"
[0m22:03:17.599552 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_bronze_dev_silver"
[0m22:03:17.599732 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_gold: BEGIN
[0m22:03:17.599886 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: BEGIN
[0m22:03:17.600034 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:03:17.600170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:03:17.600332 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:03:17.600469 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:03:17.602311 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:03:17.602519 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:03:18.044988 [debug] [ThreadPool]: SQL status: SUCCESS in 0.444 seconds
[0m22:03:18.046636 [debug] [ThreadPool]: SQL status: SUCCESS in 0.447 seconds
[0m22:03:18.047832 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_bronze_dev_silver"
[0m22:03:18.048494 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_bronze_dev_gold"
[0m22:03:18.049075 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_bronze_dev_silver"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_bronze_dev_silver'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_bronze_dev_silver'
[0m22:03:18.049687 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_gold: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_bronze_dev_gold"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_bronze_dev_gold'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_bronze_dev_gold'
[0m22:03:18.119629 [debug] [ThreadPool]: SQL status: SUCCESS in 0.069 seconds
[0m22:03:18.133506 [debug] [ThreadPool]: SQL status: SUCCESS in 0.083 seconds
[0m22:03:18.166005 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: ROLLBACK
[0m22:03:18.166745 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_gold: ROLLBACK
[0m22:03:18.226025 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_gold: Close
[0m22:03:18.226247 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: Close
[0m22:03:18.232465 [debug] [MainThread]: Using redshift connection "master"
[0m22:03:18.232721 [debug] [MainThread]: On master: BEGIN
[0m22:03:18.232916 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:03:18.233125 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:03:18.233410 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:03:18.642931 [debug] [MainThread]: SQL status: SUCCESS in 0.409 seconds
[0m22:03:18.645294 [debug] [MainThread]: Using redshift connection "master"
[0m22:03:18.646382 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m22:03:18.757446 [debug] [MainThread]: SQL status: SUCCESS in 0.110 seconds
[0m22:03:18.761178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65cf4370-c5b0-4a5f-9645-54528fb23f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116ae1010>]}
[0m22:03:18.762185 [debug] [MainThread]: On master: ROLLBACK
[0m22:03:18.823406 [debug] [MainThread]: On master: Close
[0m22:03:18.831363 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:03:18.831883 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:03:18.832301 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:03:18.832843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_bronze_dev_gold, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_part)
[0m22:03:18.833269 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_bronze_dev_silver, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_start)
[0m22:03:18.833764 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.stg_dim_user'
[0m22:03:18.834157 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:03:18.834527 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:03:18.834863 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:03:18.839124 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:03:18.842291 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:03:18.845064 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:03:18.846404 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:03:18.847009 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:03:18.847315 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:03:18.847579 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:03:18.848053 [debug] [Thread-4 (]: Began running node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:03:18.848536 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:03:18.848996 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:03:18.849356 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.dim_conversation_part'
[0m22:03:18.849874 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:03:18.850197 [debug] [Thread-4 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:03:18.850420 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.dim_user
[0m22:03:18.850638 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:03:18.850887 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_user, now model.dbt_thrive1_redshift_dw.dim_conversation_start)
[0m22:03:18.857311 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:03:18.857574 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_conversation_start, now model.dbt_thrive1_redshift_dw.dim_user)
[0m22:03:18.857793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_conversation_part, now model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages)
[0m22:03:18.858008 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:03:18.858323 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_user
[0m22:03:18.858621 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:03:18.861157 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:03:18.861408 [debug] [Thread-4 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:03:18.863838 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:03:18.866345 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:03:18.866845 [debug] [Thread-4 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:03:18.867193 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:03:18.867657 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_user
[0m22:03:18.868044 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:03:18.868378 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_user
[0m22:03:18.868554 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:03:18.868991 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:03:18.869530 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:03:18.869693 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages' was properly closed.
[0m22:03:18.869844 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_user' was properly closed.
[0m22:03:18.869980 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_conversation_start' was properly closed.
[0m22:03:18.870114 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_conversation_part' was properly closed.
[0m22:03:18.870740 [debug] [MainThread]: Command end result
[0m22:03:18.884525 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m22:03:18.885397 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m22:03:18.888889 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/run_results.json
[0m22:03:18.891017 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.8267732, "process_in_blocks": "0", "process_kernel_time": 0.24786, "process_mem_max_rss": "142852096", "process_out_blocks": "0", "process_user_time": 1.19419}
[0m22:03:18.891229 [debug] [MainThread]: Command `dbt compile` succeeded at 22:03:18.891192 after 1.83 seconds
[0m22:03:18.891404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103710dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103710390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103710cd0>]}
[0m22:03:18.891581 [debug] [MainThread]: Flushing usage events
[0m22:03:19.111180 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:03:22.187995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105261750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105294c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052b6690>]}


============================== 22:03:22.190541 | 9f43d288-517e-4104-a7d2-3453298ed7ed ==============================
[0m22:03:22.190541 [info ] [MainThread]: Running with dbt=1.10.0-b2
[0m22:03:22.190862 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/henk/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:03:22.244286 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m22:03:22.244607 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m22:03:22.322090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f43d288-517e-4104-a7d2-3453298ed7ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105148e10>]}
[0m22:03:22.347365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f43d288-517e-4104-a7d2-3453298ed7ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a884d0>]}
[0m22:03:22.347942 [info ] [MainThread]: Registered adapter: redshift=1.9.3
[0m22:03:22.406391 [debug] [MainThread]: checksum: 5a225a3ea19c91174578d2c3f7f3bd92801a2649697bdcbd194e936bd8925adb, vars: {}, profile: , target: , version: 1.10.0b2
[0m22:03:22.449820 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:03:22.450068 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:03:22.452873 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_thrive1_redshift_dw.gold.facts
- models.dbt_thrive1_redshift_dw.silver.facts
[0m22:03:22.463346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f43d288-517e-4104-a7d2-3453298ed7ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e4f010>]}
[0m22:03:22.491175 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m22:03:22.492226 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m22:03:22.496481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f43d288-517e-4104-a7d2-3453298ed7ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10648fc10>]}
[0m22:03:22.496775 [info ] [MainThread]: Found 7 models, 504 macros
[0m22:03:22.496940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f43d288-517e-4104-a7d2-3453298ed7ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106473e90>]}
[0m22:03:22.498185 [info ] [MainThread]: 
[0m22:03:22.498406 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:03:22.498545 [info ] [MainThread]: 
[0m22:03:22.498812 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m22:03:22.501702 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev'
[0m22:03:22.501992 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev'
[0m22:03:22.510585 [debug] [ThreadPool]: Using redshift connection "list_thrivedev"
[0m22:03:22.511838 [debug] [ThreadPool]: Using redshift connection "list_thrivedev"
[0m22:03:22.512002 [debug] [ThreadPool]: On list_thrivedev: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev"} */

    select distinct nspname from pg_namespace
[0m22:03:22.512154 [debug] [ThreadPool]: On list_thrivedev: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev"} */

    select distinct nspname from pg_namespace
[0m22:03:22.512288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:03:22.512407 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:03:22.512560 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:03:22.512695 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:03:22.514452 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:03:22.514637 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:03:22.940452 [debug] [ThreadPool]: SQL status: SUCCESS in 0.427 seconds
[0m22:03:22.947047 [debug] [ThreadPool]: SQL status: SUCCESS in 0.435 seconds
[0m22:03:22.970504 [debug] [ThreadPool]: On list_thrivedev: Close
[0m22:03:22.971189 [debug] [ThreadPool]: On list_thrivedev: Close
[0m22:03:22.972458 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrivedev, now list_thrivedev_dev_bronze_dev_silver)
[0m22:03:22.972737 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrivedev, now list_thrivedev_dev_bronze_dev_gold)
[0m22:03:23.008747 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_bronze_dev_silver"
[0m22:03:23.010720 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_bronze_dev_gold"
[0m22:03:23.010897 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: BEGIN
[0m22:03:23.011032 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_gold: BEGIN
[0m22:03:23.011165 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:03:23.011288 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:03:23.011483 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:03:23.011669 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:03:23.011892 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:03:23.012068 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:03:23.453804 [debug] [ThreadPool]: SQL status: SUCCESS in 0.441 seconds
[0m22:03:23.455104 [debug] [ThreadPool]: SQL status: SUCCESS in 0.444 seconds
[0m22:03:23.455907 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_bronze_dev_silver"
[0m22:03:23.456494 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_bronze_dev_gold"
[0m22:03:23.456994 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_bronze_dev_silver"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_bronze_dev_silver'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_bronze_dev_silver'
[0m22:03:23.457572 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_gold: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_bronze_dev_gold"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_bronze_dev_gold'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_bronze_dev_gold'
[0m22:03:23.550310 [debug] [ThreadPool]: SQL status: SUCCESS in 0.092 seconds
[0m22:03:23.550733 [debug] [ThreadPool]: SQL status: SUCCESS in 0.093 seconds
[0m22:03:23.552023 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_gold: ROLLBACK
[0m22:03:23.552765 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: ROLLBACK
[0m22:03:23.620872 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_gold: Close
[0m22:03:23.621264 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: Close
[0m22:03:23.628903 [debug] [MainThread]: Using redshift connection "master"
[0m22:03:23.629201 [debug] [MainThread]: On master: BEGIN
[0m22:03:23.629406 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:03:23.629605 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:03:23.629873 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:03:24.034085 [debug] [MainThread]: SQL status: SUCCESS in 0.404 seconds
[0m22:03:24.035224 [debug] [MainThread]: Using redshift connection "master"
[0m22:03:24.035791 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m22:03:24.211045 [debug] [MainThread]: SQL status: SUCCESS in 0.174 seconds
[0m22:03:24.215721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f43d288-517e-4104-a7d2-3453298ed7ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106595510>]}
[0m22:03:24.217088 [debug] [MainThread]: On master: ROLLBACK
[0m22:03:24.489008 [debug] [MainThread]: Using redshift connection "master"
[0m22:03:24.490649 [debug] [MainThread]: On master: BEGIN
[0m22:03:24.538950 [debug] [MainThread]: SQL status: SUCCESS in 0.048 seconds
[0m22:03:24.540309 [debug] [MainThread]: On master: COMMIT
[0m22:03:24.541338 [debug] [MainThread]: Using redshift connection "master"
[0m22:03:24.542313 [debug] [MainThread]: On master: COMMIT
[0m22:03:24.639082 [debug] [MainThread]: SQL status: SUCCESS in 0.096 seconds
[0m22:03:24.640808 [debug] [MainThread]: On master: Close
[0m22:03:24.647259 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:03:24.647925 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:03:24.649164 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:03:24.648704 [info ] [Thread-1 (]: 1 of 7 START sql incremental model dev_bronze_dev_silver.stg_dim_conversation_part  [RUN]
[0m22:03:24.649851 [info ] [Thread-2 (]: 2 of 7 START sql incremental model dev_bronze_dev_silver.stg_dim_conversation_start  [RUN]
[0m22:03:24.650776 [info ] [Thread-3 (]: 3 of 7 START sql incremental model dev_bronze_dev_silver.stg_dim_user .......... [RUN]
[0m22:03:24.651416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_bronze_dev_silver, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_part)
[0m22:03:24.651856 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_bronze_dev_gold, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_start)
[0m22:03:24.652370 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.stg_dim_user'
[0m22:03:24.652770 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:03:24.653143 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:03:24.653486 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:03:24.658398 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:03:24.661971 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:03:24.664728 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:03:24.665740 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:03:24.671745 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:03:24.684799 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:03:24.713865 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:03:24.715074 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:03:24.715262 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"} */

    
  
    

  create temporary table
    "stg_dim_conversation_start__dbt_tmp220324693099"
    
    
    
  as (
    

select
    id, 
    source_type, 
    conv_dataset_email, 
    priority, 
    message, 
    created_at,
    getdate() as get_date_at
from
    dev_bronze.ext_conversation_start
  );
[0m22:03:24.716533 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:03:24.716738 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"} */

    
  
    

  create temporary table
    "stg_dim_conversation_part__dbt_tmp220324687927"
    
    
    
  as (
    

select
    id, 
    conversation_id, 
    conv_dataset_email, 
    part_type, 
    message, 
    created_at,
    getdate() as get_date_at
from
    dev_bronze.ext_conversation_part
  );
[0m22:03:24.716921 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:03:24.717083 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_user"} */

    
  
    

  create temporary table
    "stg_dim_user__dbt_tmp220324704927"
    
    
    
  as (
    

select
    id,
    name,
    email,
    is_customer,
    getdate() as get_date_at
from
    dev_bronze.ext_users
  );
[0m22:03:24.717241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:03:24.717414 [debug] [Thread-2 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:03:24.717555 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:03:24.717703 [debug] [Thread-1 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:03:24.717926 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:03:24.718089 [debug] [Thread-3 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:03:24.718270 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:03:24.719070 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:03:36.033285 [debug] [Thread-2 (]: SQL status: SUCCESS in 11.315 seconds
[0m22:03:36.048559 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:03:36.048953 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: BEGIN
[0m22:03:36.103925 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.054 seconds
[0m22:03:36.105113 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:03:36.106330 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_start__dbt_tmp220324693099'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_start__dbt_tmp220324693099'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'stg_dim_conversation_start__dbt_tmp220324693099'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:03:36.448897 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.341 seconds
[0m22:03:36.469204 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:03:36.470056 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_start'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_start'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_bronze_dev_silver'
        and tablename = 'stg_dim_conversation_start'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_bronze_dev_silver'
    
    order by ordinal_position
[0m22:03:36.760580 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.289 seconds
[0m22:03:36.779877 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:03:36.780527 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_start'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_start'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_bronze_dev_silver'
        and tablename = 'stg_dim_conversation_start'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_bronze_dev_silver'
    
    order by ordinal_position
[0m22:03:37.002539 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.221 seconds
[0m22:03:37.019124 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:03:37.021674 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:03:37.022020 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"} */

      
        
            
        delete from "thrivedev"."dev_bronze_dev_silver"."stg_dim_conversation_start"
    where (id) in (
        select distinct id
        from "stg_dim_conversation_start__dbt_tmp220324693099" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:03:37.136003 [debug] [Thread-3 (]: SQL status: SUCCESS in 12.418 seconds
[0m22:03:37.143606 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:03:37.143919 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: BEGIN
[0m22:03:37.214254 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.070 seconds
[0m22:03:37.215363 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:03:37.216580 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_user__dbt_tmp220324704927'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_user__dbt_tmp220324704927'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'stg_dim_user__dbt_tmp220324704927'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:03:37.663270 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.446 seconds
[0m22:03:37.672884 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:03:37.673413 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_user'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_user'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_bronze_dev_silver'
        and tablename = 'stg_dim_user'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_bronze_dev_silver'
    
    order by ordinal_position
[0m22:03:37.847269 [debug] [Thread-1 (]: SQL status: SUCCESS in 13.129 seconds
[0m22:03:37.865537 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:03:37.866070 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: BEGIN
[0m22:03:37.929240 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.062 seconds
[0m22:03:37.930719 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:03:37.931961 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_part__dbt_tmp220324687927'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_part__dbt_tmp220324687927'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'stg_dim_conversation_part__dbt_tmp220324687927'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:03:38.026807 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.352 seconds
[0m22:03:38.043189 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:03:38.043911 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_user'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_user'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_bronze_dev_silver'
        and tablename = 'stg_dim_user'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_bronze_dev_silver'
    
    order by ordinal_position
[0m22:03:38.487827 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.443 seconds
[0m22:03:38.489571 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.556 seconds
[0m22:03:38.494657 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:03:38.507380 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:03:38.508137 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_part'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_part'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_bronze_dev_silver'
        and tablename = 'stg_dim_conversation_part'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_bronze_dev_silver'
    
    order by ordinal_position
[0m22:03:38.511437 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:03:38.511776 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_user"} */

      
        
            
        delete from "thrivedev"."dev_bronze_dev_silver"."stg_dim_user"
    where (id) in (
        select distinct id
        from "stg_dim_user__dbt_tmp220324704927" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:03:38.819887 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.311 seconds
[0m22:03:38.828953 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:03:38.829366 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_part'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_part'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_bronze_dev_silver'
        and tablename = 'stg_dim_conversation_part'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_bronze_dev_silver'
    
    order by ordinal_position
[0m22:03:39.057593 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.227 seconds
[0m22:03:39.063550 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:03:39.066885 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:03:39.067439 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"} */

      
        
            
        delete from "thrivedev"."dev_bronze_dev_silver"."stg_dim_conversation_part"
    where (id) in (
        select distinct id
        from "stg_dim_conversation_part__dbt_tmp220324687927" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:03:43.557665 [debug] [Thread-3 (]: SQL status: SUCCESS in 5.045 seconds
[0m22:03:43.559347 [debug] [Thread-2 (]: SQL status: SUCCESS in 6.537 seconds
[0m22:03:43.560168 [debug] [Thread-1 (]: SQL status: SUCCESS in 4.492 seconds
[0m22:03:43.561005 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:03:43.561580 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:03:43.562095 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:03:43.562599 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: insert into "thrivedev"."dev_bronze_dev_silver"."stg_dim_user" ("id", "name", "email", "is_customer", "get_date_at")
        (
            select "id", "name", "email", "is_customer", "get_date_at"
            from "stg_dim_user__dbt_tmp220324704927"
        )
[0m22:03:43.563083 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: insert into "thrivedev"."dev_bronze_dev_silver"."stg_dim_conversation_start" ("id", "source_type", "conv_dataset_email", "priority", "message", "created_at", "get_date_at")
        (
            select "id", "source_type", "conv_dataset_email", "priority", "message", "created_at", "get_date_at"
            from "stg_dim_conversation_start__dbt_tmp220324693099"
        )
[0m22:03:43.563504 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: insert into "thrivedev"."dev_bronze_dev_silver"."stg_dim_conversation_part" ("id", "conversation_id", "conv_dataset_email", "part_type", "message", "created_at", "get_date_at")
        (
            select "id", "conversation_id", "conv_dataset_email", "part_type", "message", "created_at", "get_date_at"
            from "stg_dim_conversation_part__dbt_tmp220324687927"
        )
[0m22:03:48.384147 [debug] [Thread-3 (]: SQL status: SUCCESS in 4.820 seconds
[0m22:03:48.395534 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: COMMIT
[0m22:03:48.395927 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:03:48.396189 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: COMMIT
[0m22:03:48.519898 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.123 seconds
[0m22:03:48.524496 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: Close
[0m22:03:48.529854 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f43d288-517e-4104-a7d2-3453298ed7ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059ea890>]}
[0m22:03:48.530934 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model dev_bronze_dev_silver.stg_dim_user ..... [[32mSUCCESS[0m in 23.87s]
[0m22:03:48.531628 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:03:48.532755 [debug] [Thread-4 (]: Began running node model.dbt_thrive1_redshift_dw.dim_user
[0m22:03:48.533329 [info ] [Thread-4 (]: 4 of 7 START sql incremental model dev_bronze_dev_gold.dim_user ................ [RUN]
[0m22:03:48.533904 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.dim_user'
[0m22:03:48.534249 [debug] [Thread-4 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_user
[0m22:03:48.542806 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:03:48.544040 [debug] [Thread-4 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_user
[0m22:03:48.549308 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:03:48.549708 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_user"} */

    
  
    

  create temporary table
    "dim_user__dbt_tmp220348546649"
    
    
    
  as (
    

select
    id as user_id,
    name,
    email,
    is_customer,
    get_date_at
from
    "thrivedev"."dev_bronze_dev_silver"."stg_dim_user"


    where get_date_at > (select max(get_date_at) from "thrivedev"."dev_bronze_dev_gold"."dim_user")

  );
[0m22:03:48.549994 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:03:48.550260 [debug] [Thread-4 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:03:48.550834 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:03:49.159046 [debug] [Thread-1 (]: SQL status: SUCCESS in 5.594 seconds
[0m22:03:49.162812 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: COMMIT
[0m22:03:49.163662 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:03:49.164283 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: COMMIT
[0m22:03:49.302087 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.137 seconds
[0m22:03:49.304963 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: Close
[0m22:03:49.306276 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f43d288-517e-4104-a7d2-3453298ed7ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c4ed10>]}
[0m22:03:49.307315 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model dev_bronze_dev_silver.stg_dim_conversation_part  [[32mSUCCESS[0m in 24.65s]
[0m22:03:49.308121 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:03:49.308846 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:03:49.309416 [info ] [Thread-3 (]: 5 of 7 START sql incremental model dev_bronze_dev_gold.dim_conversation_part ... [RUN]
[0m22:03:49.309906 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_user, now model.dbt_thrive1_redshift_dw.dim_conversation_part)
[0m22:03:49.310311 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:03:49.316017 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:03:49.317173 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:03:49.322994 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:03:49.323514 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_part"} */

    
  
    

  create temporary table
    "dim_conversation_part__dbt_tmp220349319928"
    
    
    
  as (
    

select
    id as part_id,
    conversation_id,
    conv_dataset_email,
    part_type,
    message,
    created_at,
    get_date_at
from
    "thrivedev"."dev_bronze_dev_silver"."stg_dim_conversation_part"



    where get_date_at > (select max(get_date_at) from "thrivedev"."dev_bronze_dev_gold"."dim_conversation_part")

  );
[0m22:03:49.323865 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:03:49.324193 [debug] [Thread-3 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:03:49.324607 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:03:50.980793 [debug] [Thread-2 (]: SQL status: SUCCESS in 7.415 seconds
[0m22:03:50.986346 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: COMMIT
[0m22:03:50.987241 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:03:50.987667 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: COMMIT
[0m22:03:51.098216 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.110 seconds
[0m22:03:51.101679 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: Close
[0m22:03:51.104542 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f43d288-517e-4104-a7d2-3453298ed7ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dd3bd0>]}
[0m22:03:51.106168 [info ] [Thread-2 (]: 2 of 7 OK created sql incremental model dev_bronze_dev_silver.stg_dim_conversation_start  [[32mSUCCESS[0m in 26.45s]
[0m22:03:51.107301 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:03:51.108357 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:03:51.108883 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:03:51.109549 [info ] [Thread-1 (]: 6 of 7 START sql incremental model dev_bronze_dev_gold.dim_conversation_start .. [RUN]
[0m22:03:51.110109 [info ] [Thread-2 (]: 7 of 7 START sql incremental model dev_bronze_dev_silver.stg_fact_consolidated_messages  [RUN]
[0m22:03:51.110649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_conversation_part, now model.dbt_thrive1_redshift_dw.dim_conversation_start)
[0m22:03:51.111086 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_conversation_start, now model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages)
[0m22:03:51.111492 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:03:51.111863 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:03:51.117328 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:03:51.121448 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:03:51.122589 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:03:51.123081 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:03:51.130506 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:03:51.134568 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:03:51.135116 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_start"} */

    
  
    

  create temporary table
    "dim_conversation_start__dbt_tmp220351127598"
    
    
    
  as (
    

select
    id, 
    source_type, 
    conv_dataset_email, 
    priority, 
    message, 
    created_at,
    get_date_at
from
    "thrivedev"."dev_bronze_dev_silver"."stg_dim_conversation_start"


    where get_date_at > (select max(get_date_at) from "thrivedev"."dev_bronze_dev_gold"."dim_conversation_start")

  );
[0m22:03:51.135641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:03:51.135999 [debug] [Thread-1 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:03:51.136449 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:03:51.140060 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:03:51.140321 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: BEGIN
[0m22:03:51.140698 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:03:51.140974 [debug] [Thread-2 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:03:51.141285 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:03:51.662494 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.522 seconds
[0m22:03:51.663469 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:03:51.664175 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"} */

      
  
    

  create  table
    "thrivedev"."dev_bronze_dev_silver"."stg_fact_consolidated_messages"
    
    
    
  as (
    


WITH
  start_msgs AS (
    SELECT
      id           AS msg_id,
      conv_dataset_email AS email,
      id           AS conversation_id,
      message,
      'open'       AS message_type,
      created_at
    FROM 
        "thrivedev"."dev_bronze_dev_silver"."stg_dim_conversation_start"
  ),
  part_msgs AS (
    SELECT
      id           AS msg_id,
      conv_dataset_email AS email,
      conversation_id,
      message,
      part_type    AS message_type,
      created_at
    FROM 
        "thrivedev"."dev_bronze_dev_silver"."stg_dim_conversation_part"
  ),
  all_msgs AS (
    SELECT * FROM start_msgs
    UNION ALL
    SELECT * FROM part_msgs
  ),
  conv_customer AS (
    SELECT
      am.conversation_id,
      u.id AS user_id
    FROM all_msgs am
    INNER JOIN "thrivedev"."dev_bronze_dev_silver"."stg_dim_user" u
      ON am.email = u.email
    WHERE u.is_customer = 1
    GROUP BY am.conversation_id
  )
SELECT
  am.msg_id      AS id,
  cc.user_id     AS user_id,
  am.email       AS email,
  am.conversation_id,
  am.message,
  am.message_type,
  am.created_at
FROM all_msgs am
INNER JOIN conv_customer cc
  ON am.conversation_id = cc.conversation_id
ORDER BY
  am.conversation_id,
  am.created_at
  );
[0m22:03:51.710049 [debug] [Thread-2 (]: Redshift adapter: Redshift error: column "u.id" must appear in the GROUP BY clause or be used in an aggregate function
[0m22:03:51.712629 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: ROLLBACK
[0m22:03:51.782545 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: Close
[0m22:03:51.793072 [debug] [Thread-2 (]: Database Error in model stg_fact_consolidated_messages (models/silver/fact/stg_fact_consolidated_messages.sql)
  column "u.id" must appear in the GROUP BY clause or be used in an aggregate function
  compiled code at target/run/dbt_thrive1_redshift_dw/models/silver/fact/stg_fact_consolidated_messages.sql
[0m22:03:51.793884 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f43d288-517e-4104-a7d2-3453298ed7ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b28050>]}
[0m22:03:51.794689 [error] [Thread-2 (]: 7 of 7 ERROR creating sql incremental model dev_bronze_dev_silver.stg_fact_consolidated_messages  [[31mERROR[0m in 0.68s]
[0m22:03:51.795350 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:03:51.795915 [debug] [Thread-7 (]: Marking all children of 'model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages' to be skipped because of status 'error'.  Reason: Database Error in model stg_fact_consolidated_messages (models/silver/fact/stg_fact_consolidated_messages.sql)
  column "u.id" must appear in the GROUP BY clause or be used in an aggregate function
  compiled code at target/run/dbt_thrive1_redshift_dw/models/silver/fact/stg_fact_consolidated_messages.sql.
[0m22:03:57.477246 [debug] [Thread-4 (]: SQL status: SUCCESS in 8.927 seconds
[0m22:03:57.489481 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:03:57.490097 [debug] [Thread-3 (]: SQL status: SUCCESS in 8.166 seconds
[0m22:03:57.490529 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_user: BEGIN
[0m22:03:57.499412 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:03:57.499885 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: BEGIN
[0m22:03:57.556529 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.057 seconds
[0m22:03:57.556967 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.057 seconds
[0m22:03:57.557364 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:03:57.557679 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:03:57.558148 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_user__dbt_tmp220348546649'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_user__dbt_tmp220348546649'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'dim_user__dbt_tmp220348546649'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:03:57.558898 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_part__dbt_tmp220349319928'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_part__dbt_tmp220349319928'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'dim_conversation_part__dbt_tmp220349319928'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:03:58.248874 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.689 seconds
[0m22:03:58.249151 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.690 seconds
[0m22:03:58.256245 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:03:58.262296 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:03:58.262676 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_user'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_user'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_bronze_dev_gold'
        and tablename = 'dim_user'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_bronze_dev_gold'
    
    order by ordinal_position
[0m22:03:58.263058 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_part'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_part'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_bronze_dev_gold'
        and tablename = 'dim_conversation_part'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_bronze_dev_gold'
    
    order by ordinal_position
[0m22:03:58.691607 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.428 seconds
[0m22:03:58.691868 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.428 seconds
[0m22:03:58.697686 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:03:58.703160 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:03:58.703562 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_user'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_user'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_bronze_dev_gold'
        and tablename = 'dim_user'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_bronze_dev_gold'
    
    order by ordinal_position
[0m22:03:58.703951 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_part'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_part'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_bronze_dev_gold'
        and tablename = 'dim_conversation_part'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_bronze_dev_gold'
    
    order by ordinal_position
[0m22:03:58.980732 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.276 seconds
[0m22:03:58.982255 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:03:58.984503 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:03:58.984773 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_part"} */

      
        
            
        delete from "thrivedev"."dev_bronze_dev_gold"."dim_conversation_part"
    where (part_id) in (
        select distinct part_id
        from "dim_conversation_part__dbt_tmp220349319928" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:03:59.033249 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.329 seconds
[0m22:03:59.034669 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:03:59.037113 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:03:59.037338 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_user"} */

      
        
            
        delete from "thrivedev"."dev_bronze_dev_gold"."dim_user"
    where (id) in (
        select distinct id
        from "dim_user__dbt_tmp220348546649" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:03:59.068971 [debug] [Thread-4 (]: Redshift adapter: Redshift error: column "id" does not exist in dbt_internal_source
[0m22:03:59.069348 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_user: ROLLBACK
[0m22:03:59.094166 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.109 seconds
[0m22:03:59.094588 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:03:59.094804 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: insert into "thrivedev"."dev_bronze_dev_gold"."dim_conversation_part" ("part_id", "conversation_id", "conv_dataset_email", "part_type", "message", "created_at", "get_date_at")
        (
            select "part_id", "conversation_id", "conv_dataset_email", "part_type", "message", "created_at", "get_date_at"
            from "dim_conversation_part__dbt_tmp220349319928"
        )
[0m22:03:59.133109 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_user: Close
[0m22:03:59.135305 [debug] [Thread-4 (]: Database Error in model dim_user (models/gold/dimensions/dim_user.sql)
  column "id" does not exist in dbt_internal_source
  compiled code at target/run/dbt_thrive1_redshift_dw/models/gold/dimensions/dim_user.sql
[0m22:03:59.135719 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f43d288-517e-4104-a7d2-3453298ed7ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102984bd0>]}
[0m22:03:59.136116 [error] [Thread-4 (]: 4 of 7 ERROR creating sql incremental model dev_bronze_dev_gold.dim_user ....... [[31mERROR[0m in 10.60s]
[0m22:03:59.136502 [debug] [Thread-4 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_user
[0m22:03:59.136748 [debug] [Thread-7 (]: Marking all children of 'model.dbt_thrive1_redshift_dw.dim_user' to be skipped because of status 'error'.  Reason: Database Error in model dim_user (models/gold/dimensions/dim_user.sql)
  column "id" does not exist in dbt_internal_source
  compiled code at target/run/dbt_thrive1_redshift_dw/models/gold/dimensions/dim_user.sql.
[0m22:03:59.270419 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.175 seconds
[0m22:03:59.270709 [debug] [Thread-1 (]: SQL status: SUCCESS in 8.135 seconds
[0m22:03:59.271733 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: COMMIT
[0m22:03:59.277326 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:03:59.277723 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:03:59.277982 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: BEGIN
[0m22:03:59.278161 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: COMMIT
[0m22:03:59.331524 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.053 seconds
[0m22:03:59.331853 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:03:59.332133 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_start__dbt_tmp220351127598'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_start__dbt_tmp220351127598'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'dim_conversation_start__dbt_tmp220351127598'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:03:59.381996 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.103 seconds
[0m22:03:59.382641 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: Close
[0m22:03:59.383130 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f43d288-517e-4104-a7d2-3453298ed7ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dad450>]}
[0m22:03:59.383510 [info ] [Thread-3 (]: 5 of 7 OK created sql incremental model dev_bronze_dev_gold.dim_conversation_part  [[32mSUCCESS[0m in 10.07s]
[0m22:03:59.383804 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:03:59.563560 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.231 seconds
[0m22:03:59.569826 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:03:59.570208 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_start'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_start'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_bronze_dev_gold'
        and tablename = 'dim_conversation_start'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_bronze_dev_gold'
    
    order by ordinal_position
[0m22:03:59.746063 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.175 seconds
[0m22:03:59.753114 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:03:59.753487 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_start'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_start'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_bronze_dev_gold'
        and tablename = 'dim_conversation_start'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_bronze_dev_gold'
    
    order by ordinal_position
[0m22:03:59.949774 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.196 seconds
[0m22:03:59.953512 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:03:59.957389 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:03:59.957862 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_start"} */

      
        
            
        delete from "thrivedev"."dev_bronze_dev_gold"."dim_conversation_start"
    where (id) in (
        select distinct id
        from "dim_conversation_start__dbt_tmp220351127598" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:04:00.096379 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.138 seconds
[0m22:04:00.097428 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:04:00.098022 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: insert into "thrivedev"."dev_bronze_dev_gold"."dim_conversation_start" ("id", "source_type", "conv_dataset_email", "priority", "message", "created_at", "get_date_at")
        (
            select "id", "source_type", "conv_dataset_email", "priority", "message", "created_at", "get_date_at"
            from "dim_conversation_start__dbt_tmp220351127598"
        )
[0m22:04:00.211686 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.113 seconds
[0m22:04:00.212807 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: COMMIT
[0m22:04:00.213067 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:04:00.213239 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: COMMIT
[0m22:04:00.313192 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.100 seconds
[0m22:04:00.313928 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: Close
[0m22:04:00.314474 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f43d288-517e-4104-a7d2-3453298ed7ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106af0450>]}
[0m22:04:00.314909 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model dev_bronze_dev_gold.dim_conversation_start  [[32mSUCCESS[0m in 9.20s]
[0m22:04:00.315264 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:04:00.316254 [debug] [MainThread]: Using redshift connection "master"
[0m22:04:00.316453 [debug] [MainThread]: On master: BEGIN
[0m22:04:00.316631 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:04:00.316839 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:04:00.317120 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:04:00.715661 [debug] [MainThread]: SQL status: SUCCESS in 0.399 seconds
[0m22:04:00.716007 [debug] [MainThread]: On master: COMMIT
[0m22:04:00.716254 [debug] [MainThread]: Using redshift connection "master"
[0m22:04:00.716419 [debug] [MainThread]: On master: COMMIT
[0m22:04:00.776332 [debug] [MainThread]: SQL status: SUCCESS in 0.060 seconds
[0m22:04:00.776694 [debug] [MainThread]: On master: Close
[0m22:04:00.777061 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:04:00.777220 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_conversation_start' was properly closed.
[0m22:04:00.777358 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages' was properly closed.
[0m22:04:00.777490 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_conversation_part' was properly closed.
[0m22:04:00.777614 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_user' was properly closed.
[0m22:04:00.777812 [info ] [MainThread]: 
[0m22:04:00.777995 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 38.28 seconds (38.28s).
[0m22:04:00.778669 [debug] [MainThread]: Command end result
[0m22:04:00.793637 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m22:04:00.795632 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m22:04:00.799504 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/run_results.json
[0m22:04:00.799721 [info ] [MainThread]: 
[0m22:04:00.799923 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m22:04:00.800069 [info ] [MainThread]: 
[0m22:04:00.800264 [error] [MainThread]: [31mFailure in model stg_fact_consolidated_messages (models/silver/fact/stg_fact_consolidated_messages.sql)[0m
[0m22:04:00.800443 [error] [MainThread]:   Database Error in model stg_fact_consolidated_messages (models/silver/fact/stg_fact_consolidated_messages.sql)
  column "u.id" must appear in the GROUP BY clause or be used in an aggregate function
  compiled code at target/run/dbt_thrive1_redshift_dw/models/silver/fact/stg_fact_consolidated_messages.sql
[0m22:04:00.800575 [info ] [MainThread]: 
[0m22:04:00.800732 [info ] [MainThread]:   compiled code at target/compiled/dbt_thrive1_redshift_dw/models/silver/fact/stg_fact_consolidated_messages.sql
[0m22:04:00.800858 [info ] [MainThread]: 
[0m22:04:00.801009 [error] [MainThread]: [31mFailure in model dim_user (models/gold/dimensions/dim_user.sql)[0m
[0m22:04:00.801165 [error] [MainThread]:   Database Error in model dim_user (models/gold/dimensions/dim_user.sql)
  column "id" does not exist in dbt_internal_source
  compiled code at target/run/dbt_thrive1_redshift_dw/models/gold/dimensions/dim_user.sql
[0m22:04:00.801308 [info ] [MainThread]: 
[0m22:04:00.801458 [info ] [MainThread]:   compiled code at target/compiled/dbt_thrive1_redshift_dw/models/gold/dimensions/dim_user.sql
[0m22:04:00.801586 [info ] [MainThread]: 
[0m22:04:00.801738 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=7
[0m22:04:00.804367 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 38.64992, "process_in_blocks": "0", "process_kernel_time": 0.259127, "process_mem_max_rss": "143572992", "process_out_blocks": "0", "process_user_time": 1.98045}
[0m22:04:00.804576 [debug] [MainThread]: Command `dbt run` failed at 22:04:00.804535 after 38.65 seconds
[0m22:04:00.804790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052c6010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10524e610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052af010>]}
[0m22:04:00.804965 [debug] [MainThread]: Flushing usage events
[0m22:04:01.023632 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:08:08.495080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a6a810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d5c150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a5d3d0>]}


============================== 22:08:08.498189 | d8c9f891-2612-4038-bcc2-1edb24f7fa42 ==============================
[0m22:08:08.498189 [info ] [MainThread]: Running with dbt=1.10.0-b2
[0m22:08:08.498562 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/logs', 'profiles_dir': '/Users/henk/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:08:08.585068 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m22:08:08.585568 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m22:08:08.676161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8c9f891-2612-4038-bcc2-1edb24f7fa42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105222d50>]}
[0m22:08:08.700081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8c9f891-2612-4038-bcc2-1edb24f7fa42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047c4e50>]}
[0m22:08:08.700777 [info ] [MainThread]: Registered adapter: redshift=1.9.3
[0m22:08:08.762823 [debug] [MainThread]: checksum: 5a225a3ea19c91174578d2c3f7f3bd92801a2649697bdcbd194e936bd8925adb, vars: {}, profile: , target: , version: 1.10.0b2
[0m22:08:08.823729 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m22:08:08.824118 [debug] [MainThread]: Partial parsing: updated file: dbt_thrive1_redshift_dw://models/silver/fact/stg_fact_consolidated_messages.sql
[0m22:08:08.824311 [debug] [MainThread]: Partial parsing: updated file: dbt_thrive1_redshift_dw://models/gold/dimensions/dim_user.sql
[0m22:08:08.927113 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_thrive1_redshift_dw.gold.facts
- models.dbt_thrive1_redshift_dw.silver.facts
[0m22:08:08.929575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8c9f891-2612-4038-bcc2-1edb24f7fa42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11465be10>]}
[0m22:08:08.987656 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m22:08:08.988832 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m22:08:08.995062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8c9f891-2612-4038-bcc2-1edb24f7fa42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c9f4d0>]}
[0m22:08:08.995321 [info ] [MainThread]: Found 7 models, 504 macros
[0m22:08:08.995489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8c9f891-2612-4038-bcc2-1edb24f7fa42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105000610>]}
[0m22:08:08.996325 [info ] [MainThread]: 
[0m22:08:08.996491 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:08:08.996617 [info ] [MainThread]: 
[0m22:08:08.996833 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m22:08:08.998630 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev_dev_bronze_dev_gold'
[0m22:08:08.998890 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev_dev_bronze_dev_silver'
[0m22:08:09.006763 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_bronze_dev_gold"
[0m22:08:09.008975 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_bronze_dev_silver"
[0m22:08:09.009226 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_gold: BEGIN
[0m22:08:09.009431 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: BEGIN
[0m22:08:09.009585 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:08:09.009721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:08:09.009885 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:08:09.010030 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:08:09.011966 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:08:09.012179 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:08:09.459563 [debug] [ThreadPool]: SQL status: SUCCESS in 0.449 seconds
[0m22:08:09.461037 [debug] [ThreadPool]: SQL status: SUCCESS in 0.451 seconds
[0m22:08:09.462001 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_bronze_dev_gold"
[0m22:08:09.462667 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_bronze_dev_silver"
[0m22:08:09.463588 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_gold: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_bronze_dev_gold"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_bronze_dev_gold'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_bronze_dev_gold'
[0m22:08:09.464399 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_bronze_dev_silver"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_bronze_dev_silver'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_bronze_dev_silver'
[0m22:08:09.558780 [debug] [ThreadPool]: SQL status: SUCCESS in 0.094 seconds
[0m22:08:09.559328 [debug] [ThreadPool]: SQL status: SUCCESS in 0.094 seconds
[0m22:08:09.593303 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_gold: ROLLBACK
[0m22:08:09.594079 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: ROLLBACK
[0m22:08:09.668141 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_gold: Close
[0m22:08:09.668402 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: Close
[0m22:08:09.676103 [debug] [MainThread]: Using redshift connection "master"
[0m22:08:09.676407 [debug] [MainThread]: On master: BEGIN
[0m22:08:09.676611 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:08:09.676822 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:08:09.677116 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:08:10.061900 [debug] [MainThread]: SQL status: SUCCESS in 0.385 seconds
[0m22:08:10.064078 [debug] [MainThread]: Using redshift connection "master"
[0m22:08:10.065297 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m22:08:10.183883 [debug] [MainThread]: SQL status: SUCCESS in 0.117 seconds
[0m22:08:10.188414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8c9f891-2612-4038-bcc2-1edb24f7fa42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c06590>]}
[0m22:08:10.189512 [debug] [MainThread]: On master: ROLLBACK
[0m22:08:10.235616 [debug] [MainThread]: On master: Close
[0m22:08:10.244117 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:08:10.244733 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:08:10.245243 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:08:10.245773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_bronze_dev_gold, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_part)
[0m22:08:10.246218 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_bronze_dev_silver, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_start)
[0m22:08:10.246776 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.stg_dim_user'
[0m22:08:10.247185 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:08:10.247577 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:08:10.247944 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:08:10.252418 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:08:10.255534 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:08:10.258351 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:08:10.259551 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:08:10.259833 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:08:10.260114 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:08:10.260627 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:08:10.261102 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:08:10.261546 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:08:10.262012 [debug] [Thread-4 (]: Began running node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:08:10.262405 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:08:10.262856 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.dim_user
[0m22:08:10.263129 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:08:10.263588 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.dim_conversation_start'
[0m22:08:10.263889 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_conversation_start, now model.dbt_thrive1_redshift_dw.dim_conversation_part)
[0m22:08:10.264202 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_user, now model.dbt_thrive1_redshift_dw.dim_user)
[0m22:08:10.264495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_conversation_part, now model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages)
[0m22:08:10.264772 [debug] [Thread-4 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:08:10.265024 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:08:10.265252 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_user
[0m22:08:10.265483 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:08:10.269750 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:08:10.272461 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:08:10.274887 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:08:10.277392 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:08:10.277963 [debug] [Thread-4 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:08:10.278374 [debug] [Thread-4 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:08:10.278619 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_user
[0m22:08:10.278916 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:08:10.279306 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_user
[0m22:08:10.279510 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:08:10.279895 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:08:10.280324 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:08:10.281033 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:08:10.281210 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages' was properly closed.
[0m22:08:10.281357 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_conversation_part' was properly closed.
[0m22:08:10.281495 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_user' was properly closed.
[0m22:08:10.281631 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_conversation_start' was properly closed.
[0m22:08:10.282271 [debug] [MainThread]: Command end result
[0m22:08:10.296820 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m22:08:10.297657 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m22:08:10.301600 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/run_results.json
[0m22:08:10.303918 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.8437568, "process_in_blocks": "0", "process_kernel_time": 0.24562, "process_mem_max_rss": "143212544", "process_out_blocks": "0", "process_user_time": 1.198207}
[0m22:08:10.304136 [debug] [MainThread]: Command `dbt compile` succeeded at 22:08:10.304094 after 1.84 seconds
[0m22:08:10.304321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029c5d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a60390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a60dd0>]}
[0m22:08:10.304509 [debug] [MainThread]: Flushing usage events
[0m22:08:10.530775 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:08:14.881591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e6a7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eb7ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eb7c50>]}


============================== 22:08:14.883789 | 59c5f4e0-d7d6-4942-92d9-aa116e4edda5 ==============================
[0m22:08:14.883789 [info ] [MainThread]: Running with dbt=1.10.0-b2
[0m22:08:14.884140 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/logs', 'profiles_dir': '/Users/henk/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:08:14.936844 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m22:08:14.937153 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m22:08:15.009306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59c5f4e0-d7d6-4942-92d9-aa116e4edda5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eaec10>]}
[0m22:08:15.032553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59c5f4e0-d7d6-4942-92d9-aa116e4edda5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ccc150>]}
[0m22:08:15.033844 [info ] [MainThread]: Registered adapter: redshift=1.9.3
[0m22:08:15.092519 [debug] [MainThread]: checksum: 5a225a3ea19c91174578d2c3f7f3bd92801a2649697bdcbd194e936bd8925adb, vars: {}, profile: , target: , version: 1.10.0b2
[0m22:08:15.143462 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:08:15.143677 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:08:15.146358 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_thrive1_redshift_dw.gold.facts
- models.dbt_thrive1_redshift_dw.silver.facts
[0m22:08:15.156595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59c5f4e0-d7d6-4942-92d9-aa116e4edda5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107684f10>]}
[0m22:08:15.184509 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m22:08:15.185678 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m22:08:15.192578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59c5f4e0-d7d6-4942-92d9-aa116e4edda5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107456f90>]}
[0m22:08:15.192875 [info ] [MainThread]: Found 7 models, 504 macros
[0m22:08:15.193037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59c5f4e0-d7d6-4942-92d9-aa116e4edda5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107420190>]}
[0m22:08:15.194014 [info ] [MainThread]: 
[0m22:08:15.194185 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:08:15.194312 [info ] [MainThread]: 
[0m22:08:15.194552 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m22:08:15.197079 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev'
[0m22:08:15.197405 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev'
[0m22:08:15.207144 [debug] [ThreadPool]: Using redshift connection "list_thrivedev"
[0m22:08:15.208728 [debug] [ThreadPool]: Using redshift connection "list_thrivedev"
[0m22:08:15.208942 [debug] [ThreadPool]: On list_thrivedev: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev"} */

    select distinct nspname from pg_namespace
[0m22:08:15.209092 [debug] [ThreadPool]: On list_thrivedev: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev"} */

    select distinct nspname from pg_namespace
[0m22:08:15.209241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:08:15.209448 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:08:15.209685 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:08:15.209831 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:08:15.211886 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:08:15.212148 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:08:15.639637 [debug] [ThreadPool]: SQL status: SUCCESS in 0.430 seconds
[0m22:08:15.641324 [debug] [ThreadPool]: SQL status: SUCCESS in 0.432 seconds
[0m22:08:15.679470 [debug] [ThreadPool]: On list_thrivedev: Close
[0m22:08:15.680370 [debug] [ThreadPool]: On list_thrivedev: Close
[0m22:08:15.681698 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrivedev, now list_thrivedev_dev_bronze_dev_silver)
[0m22:08:15.682042 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrivedev, now list_thrivedev_dev_bronze_dev_gold)
[0m22:08:15.717570 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_bronze_dev_silver"
[0m22:08:15.719366 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_bronze_dev_gold"
[0m22:08:15.719529 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: BEGIN
[0m22:08:15.719666 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_gold: BEGIN
[0m22:08:15.719796 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:08:15.719915 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:08:15.720056 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:08:15.720193 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:08:15.720380 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:08:15.720542 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:08:16.116125 [debug] [ThreadPool]: SQL status: SUCCESS in 0.396 seconds
[0m22:08:16.118176 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_bronze_dev_gold"
[0m22:08:16.119170 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_gold: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_bronze_dev_gold"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_bronze_dev_gold'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_bronze_dev_gold'
[0m22:08:16.128061 [debug] [ThreadPool]: SQL status: SUCCESS in 0.408 seconds
[0m22:08:16.129148 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_bronze_dev_silver"
[0m22:08:16.130029 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_bronze_dev_silver"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_bronze_dev_silver'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_bronze_dev_silver'
[0m22:08:16.199219 [debug] [ThreadPool]: SQL status: SUCCESS in 0.079 seconds
[0m22:08:16.200845 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_gold: ROLLBACK
[0m22:08:16.205762 [debug] [ThreadPool]: SQL status: SUCCESS in 0.075 seconds
[0m22:08:16.206672 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: ROLLBACK
[0m22:08:16.261540 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: Close
[0m22:08:16.261852 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_gold: Close
[0m22:08:16.267107 [debug] [MainThread]: Using redshift connection "master"
[0m22:08:16.267273 [debug] [MainThread]: On master: BEGIN
[0m22:08:16.267396 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:08:16.267527 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:08:16.267715 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:08:16.796488 [debug] [MainThread]: SQL status: SUCCESS in 0.529 seconds
[0m22:08:16.798206 [debug] [MainThread]: Using redshift connection "master"
[0m22:08:16.799206 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m22:08:16.914898 [debug] [MainThread]: SQL status: SUCCESS in 0.115 seconds
[0m22:08:16.915728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59c5f4e0-d7d6-4942-92d9-aa116e4edda5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077dfe10>]}
[0m22:08:16.916039 [debug] [MainThread]: On master: ROLLBACK
[0m22:08:16.976299 [debug] [MainThread]: Using redshift connection "master"
[0m22:08:16.976571 [debug] [MainThread]: On master: BEGIN
[0m22:08:17.007101 [debug] [MainThread]: SQL status: SUCCESS in 0.030 seconds
[0m22:08:17.007344 [debug] [MainThread]: On master: COMMIT
[0m22:08:17.007613 [debug] [MainThread]: Using redshift connection "master"
[0m22:08:17.007826 [debug] [MainThread]: On master: COMMIT
[0m22:08:17.062858 [debug] [MainThread]: SQL status: SUCCESS in 0.055 seconds
[0m22:08:17.063283 [debug] [MainThread]: On master: Close
[0m22:08:17.067195 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:08:17.067737 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:08:17.068812 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:08:17.068458 [info ] [Thread-1 (]: 1 of 7 START sql incremental model dev_bronze_dev_silver.stg_dim_conversation_part  [RUN]
[0m22:08:17.069469 [info ] [Thread-2 (]: 2 of 7 START sql incremental model dev_bronze_dev_silver.stg_dim_conversation_start  [RUN]
[0m22:08:17.069984 [info ] [Thread-3 (]: 3 of 7 START sql incremental model dev_bronze_dev_silver.stg_dim_user .......... [RUN]
[0m22:08:17.070586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_bronze_dev_silver, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_part)
[0m22:08:17.071118 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_bronze_dev_gold, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_start)
[0m22:08:17.071660 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.stg_dim_user'
[0m22:08:17.072080 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:08:17.072444 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:08:17.072787 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:08:17.077369 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:08:17.080837 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:08:17.083519 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:08:17.084685 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:08:17.085071 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:08:17.085373 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:08:17.136399 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:08:17.137394 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:08:17.139901 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:08:17.140111 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"} */

    
  
    

  create temporary table
    "stg_dim_conversation_start__dbt_tmp220817106052"
    
    
    
  as (
    

select
    id, 
    source_type, 
    conv_dataset_email, 
    priority, 
    message, 
    created_at,
    getdate() as get_date_at
from
    dev_bronze.ext_conversation_start
  );
[0m22:08:17.140299 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_user"} */

    
  
    

  create temporary table
    "stg_dim_user__dbt_tmp220817114241"
    
    
    
  as (
    

select
    id,
    name,
    email,
    is_customer,
    getdate() as get_date_at
from
    dev_bronze.ext_users
  );
[0m22:08:17.140476 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"} */

    
  
    

  create temporary table
    "stg_dim_conversation_part__dbt_tmp220817138610"
    
    
    
  as (
    

select
    id, 
    conversation_id, 
    conv_dataset_email, 
    part_type, 
    message, 
    created_at,
    getdate() as get_date_at
from
    dev_bronze.ext_conversation_part
  );
[0m22:08:17.140653 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:08:17.140797 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:08:17.140937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:17.141105 [debug] [Thread-2 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:08:17.141253 [debug] [Thread-3 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:08:17.141406 [debug] [Thread-1 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:08:17.141630 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:08:17.141819 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:08:17.141999 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:08:18.556249 [debug] [Thread-3 (]: SQL status: SUCCESS in 1.414 seconds
[0m22:08:18.575396 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:08:18.575850 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: BEGIN
[0m22:08:18.591881 [debug] [Thread-2 (]: SQL status: SUCCESS in 1.451 seconds
[0m22:08:18.602820 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:08:18.603118 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: BEGIN
[0m22:08:18.605002 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.464 seconds
[0m22:08:18.613209 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:08:18.613509 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: BEGIN
[0m22:08:18.642472 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.066 seconds
[0m22:08:18.642832 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:08:18.643313 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_user__dbt_tmp220817114241'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_user__dbt_tmp220817114241'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'stg_dim_user__dbt_tmp220817114241'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:08:18.674878 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.061 seconds
[0m22:08:18.675218 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.072 seconds
[0m22:08:18.675516 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:08:18.675827 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:08:18.676335 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_part__dbt_tmp220817138610'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_part__dbt_tmp220817138610'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'stg_dim_conversation_part__dbt_tmp220817138610'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:08:18.677040 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_start__dbt_tmp220817106052'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_start__dbt_tmp220817106052'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'stg_dim_conversation_start__dbt_tmp220817106052'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:08:19.174172 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.530 seconds
[0m22:08:19.175559 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.498 seconds
[0m22:08:19.176589 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.499 seconds
[0m22:08:19.193978 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:08:19.203514 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:08:19.212725 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:08:19.213094 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_user'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_user'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_bronze_dev_silver'
        and tablename = 'stg_dim_user'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_bronze_dev_silver'
    
    order by ordinal_position
[0m22:08:19.213610 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_start'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_start'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_bronze_dev_silver'
        and tablename = 'stg_dim_conversation_start'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_bronze_dev_silver'
    
    order by ordinal_position
[0m22:08:19.214119 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_part'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_part'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_bronze_dev_silver'
        and tablename = 'stg_dim_conversation_part'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_bronze_dev_silver'
    
    order by ordinal_position
[0m22:08:19.601588 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.386 seconds
[0m22:08:19.602905 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.388 seconds
[0m22:08:19.622374 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.408 seconds
[0m22:08:19.623354 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:08:19.632387 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:08:19.640345 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:08:19.640710 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_user'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_user'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_bronze_dev_silver'
        and tablename = 'stg_dim_user'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_bronze_dev_silver'
    
    order by ordinal_position
[0m22:08:19.641221 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_part'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_part'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_bronze_dev_silver'
        and tablename = 'stg_dim_conversation_part'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_bronze_dev_silver'
    
    order by ordinal_position
[0m22:08:19.641721 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_start'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_start'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_bronze_dev_silver'
        and tablename = 'stg_dim_conversation_start'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_bronze_dev_silver'
    
    order by ordinal_position
[0m22:08:20.030962 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.388 seconds
[0m22:08:20.032408 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.390 seconds
[0m22:08:20.053831 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:08:20.054282 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.412 seconds
[0m22:08:20.054799 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:08:20.056588 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:08:20.059992 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:08:20.060380 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_user"} */

      
        
            
        delete from "thrivedev"."dev_bronze_dev_silver"."stg_dim_user"
    where (id) in (
        select distinct id
        from "stg_dim_user__dbt_tmp220817114241" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:08:20.061821 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:08:20.063077 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:08:20.063392 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"} */

      
        
            
        delete from "thrivedev"."dev_bronze_dev_silver"."stg_dim_conversation_part"
    where (id) in (
        select distinct id
        from "stg_dim_conversation_part__dbt_tmp220817138610" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:08:20.063711 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"} */

      
        
            
        delete from "thrivedev"."dev_bronze_dev_silver"."stg_dim_conversation_start"
    where (id) in (
        select distinct id
        from "stg_dim_conversation_start__dbt_tmp220817106052" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:08:24.980832 [debug] [Thread-2 (]: SQL status: SUCCESS in 4.916 seconds
[0m22:08:24.982465 [debug] [Thread-1 (]: SQL status: SUCCESS in 4.918 seconds
[0m22:08:24.984083 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:08:24.984941 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:08:24.985637 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: insert into "thrivedev"."dev_bronze_dev_silver"."stg_dim_conversation_start" ("id", "source_type", "conv_dataset_email", "priority", "message", "created_at", "get_date_at")
        (
            select "id", "source_type", "conv_dataset_email", "priority", "message", "created_at", "get_date_at"
            from "stg_dim_conversation_start__dbt_tmp220817106052"
        )
[0m22:08:24.986719 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: insert into "thrivedev"."dev_bronze_dev_silver"."stg_dim_conversation_part" ("id", "conversation_id", "conv_dataset_email", "part_type", "message", "created_at", "get_date_at")
        (
            select "id", "conversation_id", "conv_dataset_email", "part_type", "message", "created_at", "get_date_at"
            from "stg_dim_conversation_part__dbt_tmp220817138610"
        )
[0m22:08:25.174796 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.187 seconds
[0m22:08:25.183510 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: COMMIT
[0m22:08:25.183820 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.196 seconds
[0m22:08:25.184157 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:08:25.185065 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: COMMIT
[0m22:08:25.185263 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: COMMIT
[0m22:08:25.185470 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:08:25.185735 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: COMMIT
[0m22:08:25.327824 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.142 seconds
[0m22:08:25.328102 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.142 seconds
[0m22:08:25.329330 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: Close
[0m22:08:25.329773 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: Close
[0m22:08:25.332307 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59c5f4e0-d7d6-4942-92d9-aa116e4edda5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c5fc50>]}
[0m22:08:25.332518 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59c5f4e0-d7d6-4942-92d9-aa116e4edda5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c9eb50>]}
[0m22:08:25.332895 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model dev_bronze_dev_silver.stg_dim_conversation_part  [[32mSUCCESS[0m in 8.26s]
[0m22:08:25.333279 [info ] [Thread-2 (]: 2 of 7 OK created sql incremental model dev_bronze_dev_silver.stg_dim_conversation_start  [[32mSUCCESS[0m in 8.26s]
[0m22:08:25.333669 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:08:25.333950 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:08:25.334416 [debug] [Thread-4 (]: Began running node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:08:25.334711 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:08:25.335000 [info ] [Thread-4 (]: 4 of 7 START sql incremental model dev_bronze_dev_gold.dim_conversation_part ... [RUN]
[0m22:08:25.335274 [info ] [Thread-2 (]: 5 of 7 START sql incremental model dev_bronze_dev_gold.dim_conversation_start .. [RUN]
[0m22:08:25.335575 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.dim_conversation_part'
[0m22:08:25.335771 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_conversation_start, now model.dbt_thrive1_redshift_dw.dim_conversation_start)
[0m22:08:25.335959 [debug] [Thread-4 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:08:25.336130 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:08:25.340245 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:08:25.342348 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:08:25.342852 [debug] [Thread-4 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:08:25.345510 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:08:25.345750 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:08:25.346027 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_part"} */

    
  
    

  create temporary table
    "dim_conversation_part__dbt_tmp220825344056"
    
    
    
  as (
    

select
    id as part_id,
    conversation_id,
    conv_dataset_email,
    part_type,
    message,
    created_at,
    get_date_at
from
    "thrivedev"."dev_bronze_dev_silver"."stg_dim_conversation_part"



    where get_date_at > (select max(get_date_at) from "thrivedev"."dev_bronze_dev_gold"."dim_conversation_part")

  );
[0m22:08:25.348652 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:08:25.348843 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:08:25.349125 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_start"} */

    
  
    

  create temporary table
    "dim_conversation_start__dbt_tmp220825347371"
    
    
    
  as (
    

select
    id, 
    source_type, 
    conv_dataset_email, 
    priority, 
    message, 
    created_at,
    get_date_at
from
    "thrivedev"."dev_bronze_dev_silver"."stg_dim_conversation_start"


    where get_date_at > (select max(get_date_at) from "thrivedev"."dev_bronze_dev_gold"."dim_conversation_start")

  );
[0m22:08:25.349386 [debug] [Thread-4 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:08:25.349554 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:08:25.350019 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:08:25.350330 [debug] [Thread-2 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:08:25.351375 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:08:26.018675 [debug] [Thread-3 (]: SQL status: SUCCESS in 5.958 seconds
[0m22:08:26.019575 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:08:26.019970 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: insert into "thrivedev"."dev_bronze_dev_silver"."stg_dim_user" ("id", "name", "email", "is_customer", "get_date_at")
        (
            select "id", "name", "email", "is_customer", "get_date_at"
            from "stg_dim_user__dbt_tmp220817114241"
        )
[0m22:08:26.149781 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.800 seconds
[0m22:08:26.165624 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.145 seconds
[0m22:08:26.168208 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:08:26.168614 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.820 seconds
[0m22:08:26.170248 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: COMMIT
[0m22:08:26.170645 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: BEGIN
[0m22:08:26.181382 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:08:26.181722 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:08:26.182106 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: BEGIN
[0m22:08:26.182427 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: COMMIT
[0m22:08:26.237353 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.055 seconds
[0m22:08:26.237754 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:08:26.238325 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_start__dbt_tmp220825347371'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_start__dbt_tmp220825347371'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'dim_conversation_start__dbt_tmp220825347371'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:08:26.238857 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.056 seconds
[0m22:08:26.239236 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:08:26.239783 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_part__dbt_tmp220825344056'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_part__dbt_tmp220825344056'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'dim_conversation_part__dbt_tmp220825344056'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:08:26.278128 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.095 seconds
[0m22:08:26.279048 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: Close
[0m22:08:26.279801 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59c5f4e0-d7d6-4942-92d9-aa116e4edda5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ce0d90>]}
[0m22:08:26.280543 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model dev_bronze_dev_silver.stg_dim_user ..... [[32mSUCCESS[0m in 9.21s]
[0m22:08:26.281133 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:08:26.281766 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.dim_user
[0m22:08:26.282203 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:08:26.282709 [info ] [Thread-1 (]: 6 of 7 START sql incremental model dev_bronze_dev_gold.dim_user ................ [RUN]
[0m22:08:26.283239 [info ] [Thread-3 (]: 7 of 7 START sql incremental model dev_bronze_dev_silver.stg_fact_consolidated_messages  [RUN]
[0m22:08:26.283757 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_conversation_part, now model.dbt_thrive1_redshift_dw.dim_user)
[0m22:08:26.284270 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_user, now model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages)
[0m22:08:26.284683 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_user
[0m22:08:26.285090 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:08:26.289319 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:08:26.293231 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:08:26.294122 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_user
[0m22:08:26.294494 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:08:26.299345 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:08:26.302609 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:08:26.302935 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_user"} */

    
  
    

  create temporary table
    "dim_user__dbt_tmp220826296781"
    
    
    
  as (
    

select
    id as user_id,
    name,
    email,
    is_customer,
    get_date_at
from
    "thrivedev"."dev_bronze_dev_silver"."stg_dim_user"


    where get_date_at > (select max(get_date_at) from "thrivedev"."dev_bronze_dev_gold"."dim_user")

  );
[0m22:08:26.303423 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:26.303854 [debug] [Thread-1 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:08:26.304241 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:08:26.307748 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:08:26.308089 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: BEGIN
[0m22:08:26.308559 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:08:26.308826 [debug] [Thread-3 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:08:26.309148 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:08:26.574198 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.334 seconds
[0m22:08:26.590940 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:08:26.591598 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_part'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_part'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_bronze_dev_gold'
        and tablename = 'dim_conversation_part'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_bronze_dev_gold'
    
    order by ordinal_position
[0m22:08:26.593429 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.354 seconds
[0m22:08:26.602993 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:08:26.603500 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_start'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_start'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_bronze_dev_gold'
        and tablename = 'dim_conversation_start'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_bronze_dev_gold'
    
    order by ordinal_position
[0m22:08:26.776748 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.468 seconds
[0m22:08:26.778571 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:08:26.780216 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"} */

      
  
    

  create  table
    "thrivedev"."dev_bronze_dev_silver"."stg_fact_consolidated_messages"
    
    
    
  as (
    


WITH
  start_msgs AS (
    SELECT
      id           AS msg_id,
      conv_dataset_email AS email,
      id           AS conversation_id,
      message,
      'open'       AS message_type,
      created_at
    FROM 
        "thrivedev"."dev_bronze_dev_silver"."stg_dim_conversation_start"
  ),
  part_msgs AS (
    SELECT
      id           AS msg_id,
      conv_dataset_email AS email,
      conversation_id,
      message,
      part_type    AS message_type,
      created_at
    FROM 
        "thrivedev"."dev_bronze_dev_silver"."stg_dim_conversation_part"
  ),
  all_msgs AS (
    SELECT * FROM start_msgs
    UNION ALL
    SELECT * FROM part_msgs
  ),
  conv_customer AS (
    SELECT
      am.conversation_id,
      u.id AS user_id
    FROM all_msgs am
    INNER JOIN "thrivedev"."dev_bronze_dev_silver"."stg_dim_user" u
      ON am.email = u.email
    WHERE u.is_customer = 1
    GROUP BY user_id, am.conversation_id
  )
SELECT
  am.msg_id      AS id,
  cc.user_id     AS user_id,
  am.email       AS email,
  am.conversation_id,
  am.message,
  am.message_type,
  am.created_at
FROM all_msgs am
INNER JOIN conv_customer cc
  ON am.conversation_id = cc.conversation_id
ORDER BY
  am.conversation_id,
  am.created_at
  );
[0m22:08:26.958516 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.655 seconds
[0m22:08:26.967398 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:08:26.967685 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_user: BEGIN
[0m22:08:26.995287 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.391 seconds
[0m22:08:27.004066 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:08:27.004615 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_start'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_start'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_bronze_dev_gold'
        and tablename = 'dim_conversation_start'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_bronze_dev_gold'
    
    order by ordinal_position
[0m22:08:27.024451 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.432 seconds
[0m22:08:27.033953 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:08:27.034257 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.066 seconds
[0m22:08:27.034661 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_part'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_part'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_bronze_dev_gold'
        and tablename = 'dim_conversation_part'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_bronze_dev_gold'
    
    order by ordinal_position
[0m22:08:27.035043 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:08:27.035486 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_user__dbt_tmp220826296781'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_user__dbt_tmp220826296781'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'dim_user__dbt_tmp220826296781'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:08:27.343502 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.337 seconds
[0m22:08:27.351085 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:08:27.355412 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:08:27.355877 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_start"} */

      
        
            
        delete from "thrivedev"."dev_bronze_dev_gold"."dim_conversation_start"
    where (id) in (
        select distinct id
        from "dim_conversation_start__dbt_tmp220825347371" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:08:27.406810 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.371 seconds
[0m22:08:27.412862 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:08:27.415968 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:08:27.416467 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_part"} */

      
        
            
        delete from "thrivedev"."dev_bronze_dev_gold"."dim_conversation_part"
    where (part_id) in (
        select distinct part_id
        from "dim_conversation_part__dbt_tmp220825344056" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:08:27.440477 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.405 seconds
[0m22:08:27.454073 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:08:27.454888 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_user'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_user'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_bronze_dev_gold'
        and tablename = 'dim_user'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_bronze_dev_gold'
    
    order by ordinal_position
[0m22:08:27.477881 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.121 seconds
[0m22:08:27.478368 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:08:27.478787 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: insert into "thrivedev"."dev_bronze_dev_gold"."dim_conversation_start" ("id", "source_type", "conv_dataset_email", "priority", "message", "created_at", "get_date_at")
        (
            select "id", "source_type", "conv_dataset_email", "priority", "message", "created_at", "get_date_at"
            from "dim_conversation_start__dbt_tmp220825347371"
        )
[0m22:08:27.536682 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.119 seconds
[0m22:08:27.538620 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:08:27.539990 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: insert into "thrivedev"."dev_bronze_dev_gold"."dim_conversation_part" ("part_id", "conversation_id", "conv_dataset_email", "part_type", "message", "created_at", "get_date_at")
        (
            select "part_id", "conversation_id", "conv_dataset_email", "part_type", "message", "created_at", "get_date_at"
            from "dim_conversation_part__dbt_tmp220825344056"
        )
[0m22:08:27.619751 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.140 seconds
[0m22:08:27.621417 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: COMMIT
[0m22:08:27.621796 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:08:27.622027 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: COMMIT
[0m22:08:27.764054 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.141 seconds
[0m22:08:27.767263 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: Close
[0m22:08:27.768403 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.228 seconds
[0m22:08:27.771438 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: COMMIT
[0m22:08:27.772386 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59c5f4e0-d7d6-4942-92d9-aa116e4edda5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ced4d0>]}
[0m22:08:27.772948 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:08:27.773795 [info ] [Thread-2 (]: 5 of 7 OK created sql incremental model dev_bronze_dev_gold.dim_conversation_start  [[32mSUCCESS[0m in 2.44s]
[0m22:08:27.774340 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: COMMIT
[0m22:08:27.774980 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:08:27.929635 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.154 seconds
[0m22:08:27.932263 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: Close
[0m22:08:27.933537 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59c5f4e0-d7d6-4942-92d9-aa116e4edda5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111893410>]}
[0m22:08:27.934551 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model dev_bronze_dev_gold.dim_conversation_part  [[32mSUCCESS[0m in 2.60s]
[0m22:08:27.935323 [debug] [Thread-4 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:08:27.938736 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.483 seconds
[0m22:08:27.952695 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:08:27.953576 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_user'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_user'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_bronze_dev_gold'
        and tablename = 'dim_user'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_bronze_dev_gold'
    
    order by ordinal_position
[0m22:08:28.193190 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.237 seconds
[0m22:08:28.199868 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:08:28.202996 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:08:28.203476 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_user"} */

      
        
            
        delete from "thrivedev"."dev_bronze_dev_gold"."dim_user"
    where (user_id) in (
        select distinct user_id
        from "dim_user__dbt_tmp220826296781" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:08:28.321005 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.116 seconds
[0m22:08:28.322757 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:08:28.323376 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_user: insert into "thrivedev"."dev_bronze_dev_gold"."dim_user" ("user_id", "name", "email", "is_customer", "get_date_at")
        (
            select "user_id", "name", "email", "is_customer", "get_date_at"
            from "dim_user__dbt_tmp220826296781"
        )
[0m22:08:28.430574 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.105 seconds
[0m22:08:28.435764 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_user: COMMIT
[0m22:08:28.437016 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:08:28.437430 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_user: COMMIT
[0m22:08:28.538164 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.100 seconds
[0m22:08:28.542341 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_user: Close
[0m22:08:28.544279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59c5f4e0-d7d6-4942-92d9-aa116e4edda5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ce0e90>]}
[0m22:08:28.545434 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model dev_bronze_dev_gold.dim_user ........... [[32mSUCCESS[0m in 2.26s]
[0m22:08:28.546244 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_user
[0m22:08:48.866690 [debug] [Thread-3 (]: SQL status: SUCCESS in 22.085 seconds
[0m22:08:48.877205 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: COMMIT
[0m22:08:48.877952 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:08:48.878367 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: COMMIT
[0m22:08:48.955237 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.076 seconds
[0m22:08:48.958116 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: Close
[0m22:08:48.959774 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59c5f4e0-d7d6-4942-92d9-aa116e4edda5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111899090>]}
[0m22:08:48.960741 [info ] [Thread-3 (]: 7 of 7 OK created sql incremental model dev_bronze_dev_silver.stg_fact_consolidated_messages  [[32mSUCCESS[0m in 22.68s]
[0m22:08:48.961521 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:08:48.963803 [debug] [MainThread]: Using redshift connection "master"
[0m22:08:48.964322 [debug] [MainThread]: On master: BEGIN
[0m22:08:48.964641 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:08:48.964986 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:08:48.965444 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:08:49.371088 [debug] [MainThread]: SQL status: SUCCESS in 0.406 seconds
[0m22:08:49.371495 [debug] [MainThread]: On master: COMMIT
[0m22:08:49.371774 [debug] [MainThread]: Using redshift connection "master"
[0m22:08:49.371970 [debug] [MainThread]: On master: COMMIT
[0m22:08:49.432081 [debug] [MainThread]: SQL status: SUCCESS in 0.060 seconds
[0m22:08:49.432502 [debug] [MainThread]: On master: Close
[0m22:08:49.433014 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:08:49.433243 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_user' was properly closed.
[0m22:08:49.433454 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_conversation_start' was properly closed.
[0m22:08:49.433656 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages' was properly closed.
[0m22:08:49.433841 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_conversation_part' was properly closed.
[0m22:08:49.434139 [info ] [MainThread]: 
[0m22:08:49.434406 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 34.24 seconds (34.24s).
[0m22:08:49.435422 [debug] [MainThread]: Command end result
[0m22:08:49.457871 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m22:08:49.459285 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m22:08:49.463778 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/run_results.json
[0m22:08:49.464008 [info ] [MainThread]: 
[0m22:08:49.464254 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:08:49.464444 [info ] [MainThread]: 
[0m22:08:49.464645 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m22:08:49.468330 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 34.61878, "process_in_blocks": "0", "process_kernel_time": 0.252567, "process_mem_max_rss": "149897216", "process_out_blocks": "0", "process_user_time": 1.967279}
[0m22:08:49.468615 [debug] [MainThread]: Command `dbt run` succeeded at 22:08:49.468556 after 34.62 seconds
[0m22:08:49.468843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eb7f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eb6510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107219350>]}
[0m22:08:49.469063 [debug] [MainThread]: Flushing usage events
[0m22:08:49.746947 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:13:19.325316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bea650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c10b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c36710>]}


============================== 22:13:19.328300 | 96a181e6-3b9a-4fd6-85ad-9504c85bf777 ==============================
[0m22:13:19.328300 [info ] [MainThread]: Running with dbt=1.10.0-b2
[0m22:13:19.328673 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/henk/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:13:19.417739 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m22:13:19.418085 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m22:13:19.508230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96a181e6-3b9a-4fd6-85ad-9504c85bf777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bcec90>]}
[0m22:13:19.532956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96a181e6-3b9a-4fd6-85ad-9504c85bf777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10240d390>]}
[0m22:13:19.533683 [info ] [MainThread]: Registered adapter: redshift=1.9.3
[0m22:13:19.595998 [debug] [MainThread]: checksum: 5a225a3ea19c91174578d2c3f7f3bd92801a2649697bdcbd194e936bd8925adb, vars: {}, profile: , target: , version: 1.10.0b2
[0m22:13:19.652589 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:13:19.652854 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:13:19.655633 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_thrive1_redshift_dw.silver.facts
- models.dbt_thrive1_redshift_dw.gold.facts
[0m22:13:19.665775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96a181e6-3b9a-4fd6-85ad-9504c85bf777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ed4ed0>]}
[0m22:13:19.694077 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m22:13:19.695474 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m22:13:19.701883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96a181e6-3b9a-4fd6-85ad-9504c85bf777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f2a8d0>]}
[0m22:13:19.702154 [info ] [MainThread]: Found 7 models, 504 macros
[0m22:13:19.702321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96a181e6-3b9a-4fd6-85ad-9504c85bf777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ef5890>]}
[0m22:13:19.703287 [info ] [MainThread]: 
[0m22:13:19.703458 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:13:19.703584 [info ] [MainThread]: 
[0m22:13:19.703846 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m22:13:19.705745 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev'
[0m22:13:19.705997 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev'
[0m22:13:19.714525 [debug] [ThreadPool]: Using redshift connection "list_thrivedev"
[0m22:13:19.715903 [debug] [ThreadPool]: Using redshift connection "list_thrivedev"
[0m22:13:19.716126 [debug] [ThreadPool]: On list_thrivedev: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev"} */

    select distinct nspname from pg_namespace
[0m22:13:19.716367 [debug] [ThreadPool]: On list_thrivedev: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev"} */

    select distinct nspname from pg_namespace
[0m22:13:19.716529 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:13:19.716668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:13:19.716837 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:13:19.716993 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:13:19.718977 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:13:19.719185 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:13:20.143304 [debug] [ThreadPool]: SQL status: SUCCESS in 0.427 seconds
[0m22:13:20.143758 [debug] [ThreadPool]: SQL status: SUCCESS in 0.427 seconds
[0m22:13:20.176094 [debug] [ThreadPool]: On list_thrivedev: Close
[0m22:13:20.176797 [debug] [ThreadPool]: On list_thrivedev: Close
[0m22:13:20.177415 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrivedev, now create_thrivedev_dev_bronze_dev_silver)
[0m22:13:20.177617 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrivedev, now create_thrivedev_dev_bronze_dev_gold)
[0m22:13:20.178420 [debug] [ThreadPool]: Creating schema "database: "thrivedev"
schema: "dev_bronze_dev_silver"
"
[0m22:13:20.178654 [debug] [ThreadPool]: Creating schema "database: "thrivedev"
schema: "dev_bronze_dev_gold"
"
[0m22:13:20.214420 [debug] [ThreadPool]: Using redshift connection "create_thrivedev_dev_bronze_dev_silver"
[0m22:13:20.215894 [debug] [ThreadPool]: Using redshift connection "create_thrivedev_dev_bronze_dev_gold"
[0m22:13:20.216118 [debug] [ThreadPool]: On create_thrivedev_dev_bronze_dev_silver: BEGIN
[0m22:13:20.216336 [debug] [ThreadPool]: On create_thrivedev_dev_bronze_dev_gold: BEGIN
[0m22:13:20.216524 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:13:20.216692 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:13:20.216869 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:13:20.217013 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:13:20.217212 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:13:20.217376 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:13:20.752867 [debug] [ThreadPool]: SQL status: SUCCESS in 0.536 seconds
[0m22:13:20.753442 [debug] [ThreadPool]: SQL status: SUCCESS in 0.537 seconds
[0m22:13:20.753921 [debug] [ThreadPool]: Using redshift connection "create_thrivedev_dev_bronze_dev_silver"
[0m22:13:20.754224 [debug] [ThreadPool]: Using redshift connection "create_thrivedev_dev_bronze_dev_gold"
[0m22:13:20.754523 [debug] [ThreadPool]: On create_thrivedev_dev_bronze_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "create_thrivedev_dev_bronze_dev_silver"} */
create schema if not exists "dev_bronze_dev_silver"
[0m22:13:20.754808 [debug] [ThreadPool]: On create_thrivedev_dev_bronze_dev_gold: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "create_thrivedev_dev_bronze_dev_gold"} */
create schema if not exists "dev_bronze_dev_gold"
[0m22:13:20.951301 [debug] [ThreadPool]: SQL status: SUCCESS in 0.196 seconds
[0m22:13:20.952591 [debug] [ThreadPool]: SQL status: SUCCESS in 0.197 seconds
[0m22:13:20.955989 [debug] [ThreadPool]: On create_thrivedev_dev_bronze_dev_silver: COMMIT
[0m22:13:20.957405 [debug] [ThreadPool]: On create_thrivedev_dev_bronze_dev_gold: COMMIT
[0m22:13:20.958100 [debug] [ThreadPool]: Using redshift connection "create_thrivedev_dev_bronze_dev_silver"
[0m22:13:20.958596 [debug] [ThreadPool]: Using redshift connection "create_thrivedev_dev_bronze_dev_gold"
[0m22:13:20.958974 [debug] [ThreadPool]: On create_thrivedev_dev_bronze_dev_silver: COMMIT
[0m22:13:20.959338 [debug] [ThreadPool]: On create_thrivedev_dev_bronze_dev_gold: COMMIT
[0m22:13:21.042938 [debug] [ThreadPool]: SQL status: SUCCESS in 0.083 seconds
[0m22:13:21.043347 [debug] [ThreadPool]: On create_thrivedev_dev_bronze_dev_silver: Close
[0m22:13:21.066053 [debug] [ThreadPool]: SQL status: SUCCESS in 0.106 seconds
[0m22:13:21.066462 [debug] [ThreadPool]: On create_thrivedev_dev_bronze_dev_gold: Close
[0m22:13:21.067691 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_thrivedev_dev_bronze_dev_gold, now list_thrivedev_dev_bronze_dev_silver)
[0m22:13:21.068049 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_thrivedev_dev_bronze_dev_silver, now list_thrivedev_dev_bronze_dev_gold)
[0m22:13:21.074304 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_bronze_dev_silver"
[0m22:13:21.076547 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_bronze_dev_gold"
[0m22:13:21.076753 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: BEGIN
[0m22:13:21.076924 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_gold: BEGIN
[0m22:13:21.077078 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:13:21.077229 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:13:21.077400 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:13:21.077563 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:13:21.077802 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:13:21.078005 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:13:21.503692 [debug] [ThreadPool]: SQL status: SUCCESS in 0.426 seconds
[0m22:13:21.505976 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_bronze_dev_silver"
[0m22:13:21.506984 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_bronze_dev_silver"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_bronze_dev_silver'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_bronze_dev_silver'
[0m22:13:21.598642 [debug] [ThreadPool]: SQL status: SUCCESS in 0.091 seconds
[0m22:13:21.603513 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: ROLLBACK
[0m22:13:21.679408 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: Close
[0m22:13:21.864418 [debug] [ThreadPool]: SQL status: SUCCESS in 0.787 seconds
[0m22:13:21.866614 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_bronze_dev_gold"
[0m22:13:21.867584 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_gold: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_bronze_dev_gold"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_bronze_dev_gold'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_bronze_dev_gold'
[0m22:13:21.951803 [debug] [ThreadPool]: SQL status: SUCCESS in 0.083 seconds
[0m22:13:21.957216 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_gold: ROLLBACK
[0m22:13:22.042805 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_gold: Close
[0m22:13:22.054084 [debug] [MainThread]: Using redshift connection "master"
[0m22:13:22.054513 [debug] [MainThread]: On master: BEGIN
[0m22:13:22.054833 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:13:22.055150 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:13:22.055583 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:13:22.438769 [debug] [MainThread]: SQL status: SUCCESS in 0.383 seconds
[0m22:13:22.440948 [debug] [MainThread]: Using redshift connection "master"
[0m22:13:22.442026 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m22:13:22.517334 [debug] [MainThread]: SQL status: SUCCESS in 0.074 seconds
[0m22:13:22.521439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96a181e6-3b9a-4fd6-85ad-9504c85bf777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10536dfd0>]}
[0m22:13:22.522274 [debug] [MainThread]: On master: ROLLBACK
[0m22:13:22.583065 [debug] [MainThread]: Using redshift connection "master"
[0m22:13:22.584840 [debug] [MainThread]: On master: BEGIN
[0m22:13:22.619025 [debug] [MainThread]: SQL status: SUCCESS in 0.033 seconds
[0m22:13:22.620408 [debug] [MainThread]: On master: COMMIT
[0m22:13:22.621087 [debug] [MainThread]: Using redshift connection "master"
[0m22:13:22.621534 [debug] [MainThread]: On master: COMMIT
[0m22:13:22.674663 [debug] [MainThread]: SQL status: SUCCESS in 0.053 seconds
[0m22:13:22.675095 [debug] [MainThread]: On master: Close
[0m22:13:22.678831 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:13:22.679375 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:13:22.679701 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:13:22.680100 [info ] [Thread-1 (]: 1 of 7 START sql incremental model dev_bronze_dev_silver.stg_dim_conversation_part  [RUN]
[0m22:13:22.680516 [info ] [Thread-2 (]: 2 of 7 START sql incremental model dev_bronze_dev_silver.stg_dim_conversation_start  [RUN]
[0m22:13:22.680889 [info ] [Thread-3 (]: 3 of 7 START sql incremental model dev_bronze_dev_silver.stg_dim_user .......... [RUN]
[0m22:13:22.681305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_bronze_dev_silver, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_part)
[0m22:13:22.681675 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_bronze_dev_gold, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_start)
[0m22:13:22.682064 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.stg_dim_user'
[0m22:13:22.682365 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:13:22.682661 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:13:22.682917 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:13:22.685695 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:13:22.688316 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:13:22.690970 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:13:22.691965 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:13:22.692338 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:13:22.698914 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:13:22.734248 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:13:22.735260 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:13:22.736189 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:13:22.737554 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:13:22.738128 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:13:22.738710 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:13:22.738879 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: BEGIN
[0m22:13:22.739057 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: BEGIN
[0m22:13:22.739215 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: BEGIN
[0m22:13:22.739375 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:13:22.739535 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:13:22.739681 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:13:22.739853 [debug] [Thread-1 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:13:22.740017 [debug] [Thread-3 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:13:22.740178 [debug] [Thread-2 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:13:22.740404 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:13:22.740600 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:13:22.740791 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:13:23.201944 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.462 seconds
[0m22:13:23.204354 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:13:23.205202 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"} */

      
  
    

  create  table
    "thrivedev"."dev_bronze_dev_silver"."stg_dim_conversation_part"
    
    
    
  as (
    

select
    id, 
    conversation_id, 
    conv_dataset_email, 
    part_type, 
    message, 
    created_at,
    getdate() as get_date_at
from
    dev_bronze.ext_conversation_part
  );
[0m22:13:23.236296 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.496 seconds
[0m22:13:23.237353 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.497 seconds
[0m22:13:23.237900 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:13:23.238421 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:13:23.238937 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_user"} */

      
  
    

  create  table
    "thrivedev"."dev_bronze_dev_silver"."stg_dim_user"
    
    
    
  as (
    

select
    id,
    name,
    email,
    is_customer,
    getdate() as get_date_at
from
    dev_bronze.ext_users
  );
[0m22:13:23.239470 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"} */

      
  
    

  create  table
    "thrivedev"."dev_bronze_dev_silver"."stg_dim_conversation_start"
    
    
    
  as (
    

select
    id, 
    source_type, 
    conv_dataset_email, 
    priority, 
    message, 
    created_at,
    getdate() as get_date_at
from
    dev_bronze.ext_conversation_start
  );
[0m22:13:24.230003 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.989 seconds
[0m22:13:24.231781 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.991 seconds
[0m22:13:24.232271 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.026 seconds
[0m22:13:24.254370 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: COMMIT
[0m22:13:24.255931 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: COMMIT
[0m22:13:24.257209 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: COMMIT
[0m22:13:24.257692 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:13:24.258031 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:13:24.258346 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:13:24.258616 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: COMMIT
[0m22:13:24.258880 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: COMMIT
[0m22:13:24.259135 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: COMMIT
[0m22:13:24.409462 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.150 seconds
[0m22:13:24.414974 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: Close
[0m22:13:24.418312 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96a181e6-3b9a-4fd6-85ad-9504c85bf777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067f9290>]}
[0m22:13:24.419426 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model dev_bronze_dev_silver.stg_dim_user ..... [[32mSUCCESS[0m in 1.73s]
[0m22:13:24.420169 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:13:24.420881 [debug] [Thread-4 (]: Began running node model.dbt_thrive1_redshift_dw.dim_user
[0m22:13:24.421369 [info ] [Thread-4 (]: 4 of 7 START sql incremental model dev_bronze_dev_gold.dim_user ................ [RUN]
[0m22:13:24.421945 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.dim_user'
[0m22:13:24.422315 [debug] [Thread-4 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_user
[0m22:13:24.430592 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:13:24.431474 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.172 seconds
[0m22:13:24.431889 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.172 seconds
[0m22:13:24.432840 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: Close
[0m22:13:24.433919 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: Close
[0m22:13:24.434310 [debug] [Thread-4 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_user
[0m22:13:24.440258 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:13:24.441072 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96a181e6-3b9a-4fd6-85ad-9504c85bf777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fdd790>]}
[0m22:13:24.441445 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96a181e6-3b9a-4fd6-85ad-9504c85bf777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f60ad0>]}
[0m22:13:24.442034 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model dev_bronze_dev_silver.stg_dim_conversation_part  [[32mSUCCESS[0m in 1.76s]
[0m22:13:24.442404 [info ] [Thread-2 (]: 2 of 7 OK created sql incremental model dev_bronze_dev_silver.stg_dim_conversation_start  [[32mSUCCESS[0m in 1.76s]
[0m22:13:24.443098 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:13:24.444110 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:13:24.444478 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:13:24.444972 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:13:24.445224 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_user: BEGIN
[0m22:13:24.445976 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:13:24.445735 [info ] [Thread-3 (]: 5 of 7 START sql incremental model dev_bronze_dev_gold.dim_conversation_part ... [RUN]
[0m22:13:24.446288 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:13:24.446528 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:13:24.446848 [info ] [Thread-1 (]: 6 of 7 START sql incremental model dev_bronze_dev_gold.dim_conversation_start .. [RUN]
[0m22:13:24.447159 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_user, now model.dbt_thrive1_redshift_dw.dim_conversation_part)
[0m22:13:24.447456 [info ] [Thread-2 (]: 7 of 7 START sql incremental model dev_bronze_dev_silver.stg_fact_consolidated_messages  [RUN]
[0m22:13:24.447760 [debug] [Thread-4 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:13:24.448129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_conversation_part, now model.dbt_thrive1_redshift_dw.dim_conversation_start)
[0m22:13:24.448463 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:13:24.448740 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_conversation_start, now model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages)
[0m22:13:24.449095 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:13:24.449444 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:13:24.452256 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:13:24.452557 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:13:24.456310 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:13:24.459152 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:13:24.459736 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:13:24.460165 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:13:24.463381 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:13:24.466815 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:13:24.467138 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:13:24.467997 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:13:24.470369 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:13:24.470668 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: BEGIN
[0m22:13:24.471364 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:13:24.472421 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:13:24.472713 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: BEGIN
[0m22:13:24.472987 [debug] [Thread-3 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:13:24.475238 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:13:24.475487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:13:24.475786 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:13:24.476579 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: BEGIN
[0m22:13:24.477450 [debug] [Thread-1 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:13:24.478312 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:13:24.478614 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:13:24.478919 [debug] [Thread-2 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:13:24.479807 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:13:24.997654 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.550 seconds
[0m22:13:24.999313 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.527 seconds
[0m22:13:25.000657 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:13:25.001353 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:13:25.001922 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_user"} */

      
  
    

  create  table
    "thrivedev"."dev_bronze_dev_gold"."dim_user"
    
    
    
  as (
    

select
    id as user_id,
    name,
    email,
    is_customer,
    get_date_at
from
    "thrivedev"."dev_bronze_dev_silver"."stg_dim_user"


  );
[0m22:13:25.002505 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_part"} */

      
  
    

  create  table
    "thrivedev"."dev_bronze_dev_gold"."dim_conversation_part"
    
    
    
  as (
    

select
    id as part_id,
    conversation_id,
    conv_dataset_email,
    part_type,
    message,
    created_at,
    get_date_at
from
    "thrivedev"."dev_bronze_dev_silver"."stg_dim_conversation_part"



  );
[0m22:13:25.039564 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.561 seconds
[0m22:13:25.041130 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.565 seconds
[0m22:13:25.042502 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:13:25.043226 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:13:25.044020 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"} */

      
  
    

  create  table
    "thrivedev"."dev_bronze_dev_silver"."stg_fact_consolidated_messages"
    
    
    
  as (
    


WITH
  start_msgs AS (
    SELECT
      id           AS msg_id,
      conv_dataset_email AS email,
      id           AS conversation_id,
      message,
      'open'       AS message_type,
      created_at
    FROM 
        "thrivedev"."dev_bronze_dev_silver"."stg_dim_conversation_start"
  ),
  part_msgs AS (
    SELECT
      id           AS msg_id,
      conv_dataset_email AS email,
      conversation_id,
      message,
      part_type    AS message_type,
      created_at
    FROM 
        "thrivedev"."dev_bronze_dev_silver"."stg_dim_conversation_part"
  ),
  all_msgs AS (
    SELECT * FROM start_msgs
    UNION ALL
    SELECT * FROM part_msgs
  ),
  conv_customer AS (
    SELECT
      am.conversation_id,
      u.id AS user_id
    FROM all_msgs am
    INNER JOIN "thrivedev"."dev_bronze_dev_silver"."stg_dim_user" u
      ON am.email = u.email
    WHERE u.is_customer = 1
    GROUP BY user_id, am.conversation_id
  )
SELECT
  am.msg_id      AS id,
  cc.user_id     AS user_id,
  am.email       AS email,
  am.conversation_id,
  am.message,
  am.message_type,
  am.created_at
FROM all_msgs am
INNER JOIN conv_customer cc
  ON am.conversation_id = cc.conversation_id
ORDER BY
  am.conversation_id,
  am.created_at
  );
[0m22:13:25.045018 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_start"} */

      
  
    

  create  table
    "thrivedev"."dev_bronze_dev_gold"."dim_conversation_start"
    
    
    
  as (
    

select
    id, 
    source_type, 
    conv_dataset_email, 
    priority, 
    message, 
    created_at,
    get_date_at
from
    "thrivedev"."dev_bronze_dev_silver"."stg_dim_conversation_start"


  );
[0m22:13:25.212669 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.209 seconds
[0m22:13:25.218548 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_user: COMMIT
[0m22:13:25.219169 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:13:25.219481 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_user: COMMIT
[0m22:13:25.397136 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.351 seconds
[0m22:13:25.402346 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: COMMIT
[0m22:13:25.403035 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:13:25.403441 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: COMMIT
[0m22:13:25.403809 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.184 seconds
[0m22:13:25.404857 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_user: Close
[0m22:13:25.405765 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96a181e6-3b9a-4fd6-85ad-9504c85bf777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070e35d0>]}
[0m22:13:25.406543 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model dev_bronze_dev_gold.dim_user ........... [[32mSUCCESS[0m in 0.98s]
[0m22:13:25.407160 [debug] [Thread-4 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_user
[0m22:13:25.454313 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.450 seconds
[0m22:13:25.458653 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: COMMIT
[0m22:13:25.459529 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:13:25.460047 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: COMMIT
[0m22:13:25.498016 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.093 seconds
[0m22:13:25.502137 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: Close
[0m22:13:25.503240 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96a181e6-3b9a-4fd6-85ad-9504c85bf777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f4bb90>]}
[0m22:13:25.504199 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model dev_bronze_dev_gold.dim_conversation_start  [[32mSUCCESS[0m in 1.05s]
[0m22:13:25.504920 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:13:25.590896 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.129 seconds
[0m22:13:25.594276 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: Close
[0m22:13:25.596043 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96a181e6-3b9a-4fd6-85ad-9504c85bf777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fdee10>]}
[0m22:13:25.597238 [info ] [Thread-3 (]: 5 of 7 OK created sql incremental model dev_bronze_dev_gold.dim_conversation_part  [[32mSUCCESS[0m in 1.15s]
[0m22:13:25.598004 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:13:32.348418 [debug] [Thread-2 (]: SQL status: SUCCESS in 7.302 seconds
[0m22:13:32.352620 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: COMMIT
[0m22:13:32.353175 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:13:32.353480 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: COMMIT
[0m22:13:32.444444 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.090 seconds
[0m22:13:32.447729 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: Close
[0m22:13:32.449466 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96a181e6-3b9a-4fd6-85ad-9504c85bf777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071b4bd0>]}
[0m22:13:32.450432 [info ] [Thread-2 (]: 7 of 7 OK created sql incremental model dev_bronze_dev_silver.stg_fact_consolidated_messages  [[32mSUCCESS[0m in 8.00s]
[0m22:13:32.451103 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:13:32.452807 [debug] [MainThread]: Using redshift connection "master"
[0m22:13:32.453166 [debug] [MainThread]: On master: BEGIN
[0m22:13:32.453460 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:13:32.453790 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:13:32.454261 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:13:32.865061 [debug] [MainThread]: SQL status: SUCCESS in 0.411 seconds
[0m22:13:32.867055 [debug] [MainThread]: On master: COMMIT
[0m22:13:32.868379 [debug] [MainThread]: Using redshift connection "master"
[0m22:13:32.869179 [debug] [MainThread]: On master: COMMIT
[0m22:13:32.921896 [debug] [MainThread]: SQL status: SUCCESS in 0.052 seconds
[0m22:13:32.923290 [debug] [MainThread]: On master: Close
[0m22:13:32.926574 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:13:32.927379 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_conversation_start' was properly closed.
[0m22:13:32.927857 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages' was properly closed.
[0m22:13:32.928317 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_conversation_part' was properly closed.
[0m22:13:32.928738 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_user' was properly closed.
[0m22:13:32.929695 [info ] [MainThread]: 
[0m22:13:32.930421 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 13.23 seconds (13.23s).
[0m22:13:32.932248 [debug] [MainThread]: Command end result
[0m22:13:32.963655 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m22:13:32.965096 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m22:13:32.969168 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/run_results.json
[0m22:13:32.969392 [info ] [MainThread]: 
[0m22:13:32.969641 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:13:32.969828 [info ] [MainThread]: 
[0m22:13:32.970026 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m22:13:32.972690 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.682797, "process_in_blocks": "0", "process_kernel_time": 0.296554, "process_mem_max_rss": "148537344", "process_out_blocks": "0", "process_user_time": 2.046471}
[0m22:13:32.972977 [debug] [MainThread]: Command `dbt run` succeeded at 22:13:32.972924 after 13.68 seconds
[0m22:13:32.973211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100c74dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100c74390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100c74cd0>]}
[0m22:13:32.973421 [debug] [MainThread]: Flushing usage events
[0m22:13:33.226145 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:18:28.299415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ebc090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eaff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105117d90>]}


============================== 22:18:28.302431 | 0adb3d51-447f-44aa-98da-dd862c44b431 ==============================
[0m22:18:28.302431 [info ] [MainThread]: Running with dbt=1.10.0-b2
[0m22:18:28.302768 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/henk/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:18:28.396113 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m22:18:28.396465 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m22:18:28.485289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0adb3d51-447f-44aa-98da-dd862c44b431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10510ddd0>]}
[0m22:18:28.508179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0adb3d51-447f-44aa-98da-dd862c44b431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028ec990>]}
[0m22:18:28.508805 [info ] [MainThread]: Registered adapter: redshift=1.9.3
[0m22:18:28.568863 [debug] [MainThread]: checksum: 5a225a3ea19c91174578d2c3f7f3bd92801a2649697bdcbd194e936bd8925adb, vars: {}, profile: , target: , version: 1.10.0b2
[0m22:18:28.624378 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m22:18:28.624670 [debug] [MainThread]: Partial parsing: added file: dbt_thrive1_redshift_dw://models/silver/facts/stg_fact_consolidated_messages.sql
[0m22:18:28.624821 [debug] [MainThread]: Partial parsing: deleted file: dbt_thrive1_redshift_dw://models/silver/fact/stg_fact_consolidated_messages.sql
[0m22:18:28.722752 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_thrive1_redshift_dw.gold.facts
[0m22:18:28.725185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0adb3d51-447f-44aa-98da-dd862c44b431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c212d0>]}
[0m22:18:28.783935 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m22:18:28.785217 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m22:18:28.791080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0adb3d51-447f-44aa-98da-dd862c44b431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107015890>]}
[0m22:18:28.791332 [info ] [MainThread]: Found 7 models, 504 macros
[0m22:18:28.791495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0adb3d51-447f-44aa-98da-dd862c44b431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ea1dd0>]}
[0m22:18:28.792307 [info ] [MainThread]: 
[0m22:18:28.792471 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:18:28.792600 [info ] [MainThread]: 
[0m22:18:28.792825 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m22:18:28.794635 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev_dev_bronze_dev_silver'
[0m22:18:28.794911 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev_dev_bronze_dev_gold'
[0m22:18:28.803032 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_bronze_dev_silver"
[0m22:18:28.805378 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_bronze_dev_gold"
[0m22:18:28.805684 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: BEGIN
[0m22:18:28.805867 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_gold: BEGIN
[0m22:18:28.806040 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:18:28.806175 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:18:28.806338 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:18:28.806480 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:18:28.808423 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:18:28.808627 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:18:29.288821 [debug] [ThreadPool]: SQL status: SUCCESS in 0.482 seconds
[0m22:18:29.291484 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_bronze_dev_gold"
[0m22:18:29.292537 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_gold: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_bronze_dev_gold"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_bronze_dev_gold'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_bronze_dev_gold'
[0m22:18:29.321838 [debug] [ThreadPool]: SQL status: SUCCESS in 0.516 seconds
[0m22:18:29.323286 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_bronze_dev_silver"
[0m22:18:29.324396 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_bronze_dev_silver"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_bronze_dev_silver'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_bronze_dev_silver'
[0m22:18:29.378044 [debug] [ThreadPool]: SQL status: SUCCESS in 0.085 seconds
[0m22:18:29.416488 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_gold: ROLLBACK
[0m22:18:29.417150 [debug] [ThreadPool]: SQL status: SUCCESS in 0.092 seconds
[0m22:18:29.417913 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: ROLLBACK
[0m22:18:29.481474 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_gold: Close
[0m22:18:29.481751 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: Close
[0m22:18:29.489145 [debug] [MainThread]: Using redshift connection "master"
[0m22:18:29.489416 [debug] [MainThread]: On master: BEGIN
[0m22:18:29.489613 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:18:29.489822 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:18:29.490128 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:18:29.983164 [debug] [MainThread]: SQL status: SUCCESS in 0.493 seconds
[0m22:18:29.983915 [debug] [MainThread]: Using redshift connection "master"
[0m22:18:29.984304 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m22:18:30.103415 [debug] [MainThread]: SQL status: SUCCESS in 0.118 seconds
[0m22:18:30.106478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0adb3d51-447f-44aa-98da-dd862c44b431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10709bc50>]}
[0m22:18:30.107248 [debug] [MainThread]: On master: ROLLBACK
[0m22:18:30.162030 [debug] [MainThread]: On master: Close
[0m22:18:30.171461 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:18:30.172131 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:18:30.172850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_bronze_dev_silver, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_part)
[0m22:18:30.173330 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:18:30.173780 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_bronze_dev_gold, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_start)
[0m22:18:30.174196 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:18:30.174732 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.stg_dim_user'
[0m22:18:30.175142 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:18:30.179875 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:18:30.180257 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:18:30.183453 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:18:30.186490 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:18:30.187110 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:18:30.187420 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:18:30.187684 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:18:30.188244 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:18:30.188729 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:18:30.189189 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:18:30.189737 [debug] [Thread-4 (]: Began running node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:18:30.190069 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:18:30.190497 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.dim_user
[0m22:18:30.190744 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:18:30.191227 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.dim_conversation_part'
[0m22:18:30.191522 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_conversation_start, now model.dbt_thrive1_redshift_dw.dim_conversation_start)
[0m22:18:30.191834 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_user, now model.dbt_thrive1_redshift_dw.dim_user)
[0m22:18:30.192120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_conversation_part, now model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages)
[0m22:18:30.192397 [debug] [Thread-4 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:18:30.192668 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:18:30.192923 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_user
[0m22:18:30.193149 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:18:30.199652 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:18:30.202263 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:18:30.204671 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:18:30.207199 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:18:30.208009 [debug] [Thread-4 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:18:30.208251 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_user
[0m22:18:30.208515 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:18:30.208887 [debug] [Thread-4 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:18:30.209113 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:18:30.209474 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_user
[0m22:18:30.209835 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:18:30.210266 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:18:30.210940 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:18:30.211104 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages' was properly closed.
[0m22:18:30.211247 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_conversation_start' was properly closed.
[0m22:18:30.211380 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_user' was properly closed.
[0m22:18:30.211513 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_conversation_part' was properly closed.
[0m22:18:30.212141 [debug] [MainThread]: Command end result
[0m22:18:30.225872 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m22:18:30.226676 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m22:18:30.230456 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/run_results.json
[0m22:18:30.232676 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.9676198, "process_in_blocks": "0", "process_kernel_time": 0.238745, "process_mem_max_rss": "143704064", "process_out_blocks": "0", "process_user_time": 1.187898}
[0m22:18:30.232896 [debug] [MainThread]: Command `dbt compile` succeeded at 22:18:30.232854 after 1.97 seconds
[0m22:18:30.233083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10512db50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100f75d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eaf950>]}
[0m22:18:30.233271 [debug] [MainThread]: Flushing usage events
[0m22:18:30.880194 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:18:35.426951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109866950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098b3550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098b3a10>]}


============================== 22:18:35.430425 | d8ca926b-4314-4631-b7b8-2e59f14fa11c ==============================
[0m22:18:35.430425 [info ] [MainThread]: Running with dbt=1.10.0-b2
[0m22:18:35.430899 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/henk/.dbt', 'log_path': '/Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:18:35.520266 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m22:18:35.520577 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m22:18:35.596304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8ca926b-4314-4631-b7b8-2e59f14fa11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3fb210>]}
[0m22:18:35.620465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8ca926b-4314-4631-b7b8-2e59f14fa11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107088a90>]}
[0m22:18:35.621161 [info ] [MainThread]: Registered adapter: redshift=1.9.3
[0m22:18:35.683170 [debug] [MainThread]: checksum: 5a225a3ea19c91174578d2c3f7f3bd92801a2649697bdcbd194e936bd8925adb, vars: {}, profile: , target: , version: 1.10.0b2
[0m22:18:35.735370 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:18:35.735579 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:18:35.738251 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_thrive1_redshift_dw.gold.facts
[0m22:18:35.748187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8ca926b-4314-4631-b7b8-2e59f14fa11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa1ef90>]}
[0m22:18:35.776148 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m22:18:35.777214 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m22:18:35.783330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8ca926b-4314-4631-b7b8-2e59f14fa11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aab2ed0>]}
[0m22:18:35.783622 [info ] [MainThread]: Found 7 models, 504 macros
[0m22:18:35.783791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8ca926b-4314-4631-b7b8-2e59f14fa11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa71610>]}
[0m22:18:35.784763 [info ] [MainThread]: 
[0m22:18:35.784933 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:18:35.785057 [info ] [MainThread]: 
[0m22:18:35.785306 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m22:18:35.787227 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev'
[0m22:18:35.787483 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev'
[0m22:18:35.795962 [debug] [ThreadPool]: Using redshift connection "list_thrivedev"
[0m22:18:35.797290 [debug] [ThreadPool]: Using redshift connection "list_thrivedev"
[0m22:18:35.797495 [debug] [ThreadPool]: On list_thrivedev: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev"} */

    select distinct nspname from pg_namespace
[0m22:18:35.797673 [debug] [ThreadPool]: On list_thrivedev: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev"} */

    select distinct nspname from pg_namespace
[0m22:18:35.797819 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:18:35.797948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:18:35.798110 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:18:35.798258 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:18:35.800387 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:18:35.800660 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:18:36.223086 [debug] [ThreadPool]: SQL status: SUCCESS in 0.425 seconds
[0m22:18:36.224650 [debug] [ThreadPool]: SQL status: SUCCESS in 0.427 seconds
[0m22:18:36.267263 [debug] [ThreadPool]: On list_thrivedev: Close
[0m22:18:36.268033 [debug] [ThreadPool]: On list_thrivedev: Close
[0m22:18:36.269183 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrivedev, now list_thrivedev_dev_bronze_dev_silver)
[0m22:18:36.269481 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrivedev, now list_thrivedev_dev_bronze_dev_gold)
[0m22:18:36.304022 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_bronze_dev_silver"
[0m22:18:36.305763 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_bronze_dev_gold"
[0m22:18:36.305918 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: BEGIN
[0m22:18:36.306047 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_gold: BEGIN
[0m22:18:36.306167 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:18:36.306285 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:18:36.306422 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:18:36.306550 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:18:36.306738 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:18:36.306896 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:18:36.732159 [debug] [ThreadPool]: SQL status: SUCCESS in 0.426 seconds
[0m22:18:36.732807 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_bronze_dev_gold"
[0m22:18:36.733120 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_gold: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_bronze_dev_gold"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_bronze_dev_gold'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_bronze_dev_gold'
[0m22:18:36.733511 [debug] [ThreadPool]: SQL status: SUCCESS in 0.427 seconds
[0m22:18:36.733765 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_bronze_dev_silver"
[0m22:18:36.734017 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_bronze_dev_silver"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_bronze_dev_silver'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_bronze_dev_silver'
[0m22:18:36.843520 [debug] [ThreadPool]: SQL status: SUCCESS in 0.110 seconds
[0m22:18:36.844610 [debug] [ThreadPool]: SQL status: SUCCESS in 0.110 seconds
[0m22:18:36.847369 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_gold: ROLLBACK
[0m22:18:36.849165 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: ROLLBACK
[0m22:18:36.918813 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_gold: Close
[0m22:18:36.919126 [debug] [ThreadPool]: On list_thrivedev_dev_bronze_dev_silver: Close
[0m22:18:36.928555 [debug] [MainThread]: Using redshift connection "master"
[0m22:18:36.928896 [debug] [MainThread]: On master: BEGIN
[0m22:18:36.929122 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:18:36.929359 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:18:36.929682 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:18:37.360245 [debug] [MainThread]: SQL status: SUCCESS in 0.431 seconds
[0m22:18:37.360905 [debug] [MainThread]: Using redshift connection "master"
[0m22:18:37.361289 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m22:18:37.472344 [debug] [MainThread]: SQL status: SUCCESS in 0.111 seconds
[0m22:18:37.474038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8ca926b-4314-4631-b7b8-2e59f14fa11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a405e90>]}
[0m22:18:37.474710 [debug] [MainThread]: On master: ROLLBACK
[0m22:18:37.539909 [debug] [MainThread]: Using redshift connection "master"
[0m22:18:37.540205 [debug] [MainThread]: On master: BEGIN
[0m22:18:37.564150 [debug] [MainThread]: SQL status: SUCCESS in 0.024 seconds
[0m22:18:37.564531 [debug] [MainThread]: On master: COMMIT
[0m22:18:37.564782 [debug] [MainThread]: Using redshift connection "master"
[0m22:18:37.564953 [debug] [MainThread]: On master: COMMIT
[0m22:18:37.643291 [debug] [MainThread]: SQL status: SUCCESS in 0.078 seconds
[0m22:18:37.645212 [debug] [MainThread]: On master: Close
[0m22:18:37.650758 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:18:37.651183 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:18:37.651511 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:18:37.651995 [info ] [Thread-1 (]: 1 of 7 START sql incremental model dev_bronze_dev_silver.stg_dim_conversation_part  [RUN]
[0m22:18:37.652421 [info ] [Thread-2 (]: 2 of 7 START sql incremental model dev_bronze_dev_silver.stg_dim_conversation_start  [RUN]
[0m22:18:37.652814 [info ] [Thread-3 (]: 3 of 7 START sql incremental model dev_bronze_dev_silver.stg_dim_user .......... [RUN]
[0m22:18:37.653281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_bronze_dev_silver, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_part)
[0m22:18:37.653727 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_bronze_dev_gold, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_start)
[0m22:18:37.654226 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.stg_dim_user'
[0m22:18:37.654596 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:18:37.654931 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:18:37.655253 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:18:37.659389 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:18:37.662831 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:18:37.666346 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:18:37.667361 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:18:37.667749 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:18:37.692491 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:18:37.720024 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:18:37.722095 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:18:37.724916 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:18:37.725196 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"} */

    
  
    

  create temporary table
    "stg_dim_conversation_part__dbt_tmp221837690016"
    
    
    
  as (
    

select
    id, 
    conversation_id, 
    conv_dataset_email, 
    part_type, 
    message, 
    created_at,
    getdate() as get_date_at
from
    dev_bronze.ext_conversation_part
  );
[0m22:18:37.725396 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"} */

    
  
    

  create temporary table
    "stg_dim_conversation_start__dbt_tmp221837706695"
    
    
    
  as (
    

select
    id, 
    source_type, 
    conv_dataset_email, 
    priority, 
    message, 
    created_at,
    getdate() as get_date_at
from
    dev_bronze.ext_conversation_start
  );
[0m22:18:37.725580 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_user"} */

    
  
    

  create temporary table
    "stg_dim_user__dbt_tmp221837723510"
    
    
    
  as (
    

select
    id,
    name,
    email,
    is_customer,
    getdate() as get_date_at
from
    dev_bronze.ext_users
  );
[0m22:18:37.725749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:18:37.725899 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:18:37.726046 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:18:37.726224 [debug] [Thread-1 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:18:37.726388 [debug] [Thread-2 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:18:37.726543 [debug] [Thread-3 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:18:37.726773 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:18:37.726970 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:18:37.727164 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:18:39.165808 [debug] [Thread-3 (]: SQL status: SUCCESS in 1.439 seconds
[0m22:18:39.188132 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:18:39.188654 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: BEGIN
[0m22:18:39.192845 [debug] [Thread-2 (]: SQL status: SUCCESS in 1.467 seconds
[0m22:18:39.203361 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:18:39.203667 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: BEGIN
[0m22:18:39.248408 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.059 seconds
[0m22:18:39.249134 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:18:39.249668 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_user__dbt_tmp221837723510'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_user__dbt_tmp221837723510'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'stg_dim_user__dbt_tmp221837723510'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:18:39.261311 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.057 seconds
[0m22:18:39.261924 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:18:39.262738 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_start__dbt_tmp221837706695'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_start__dbt_tmp221837706695'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'stg_dim_conversation_start__dbt_tmp221837706695'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:18:39.350231 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.624 seconds
[0m22:18:39.399649 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:18:39.401121 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: BEGIN
[0m22:18:39.464797 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.063 seconds
[0m22:18:39.465199 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:18:39.465495 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_part__dbt_tmp221837690016'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_part__dbt_tmp221837690016'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'stg_dim_conversation_part__dbt_tmp221837690016'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:18:39.633747 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.370 seconds
[0m22:18:39.643875 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:18:39.644279 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_start'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_start'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_bronze_dev_silver'
        and tablename = 'stg_dim_conversation_start'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_bronze_dev_silver'
    
    order by ordinal_position
[0m22:18:39.771499 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.520 seconds
[0m22:18:39.782122 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:18:39.782578 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_user'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_user'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_bronze_dev_silver'
        and tablename = 'stg_dim_user'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_bronze_dev_silver'
    
    order by ordinal_position
[0m22:18:39.902767 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.436 seconds
[0m22:18:39.917482 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:18:39.918109 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_part'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_part'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_bronze_dev_silver'
        and tablename = 'stg_dim_conversation_part'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_bronze_dev_silver'
    
    order by ordinal_position
[0m22:18:39.954024 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.309 seconds
[0m22:18:39.970999 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:18:39.971927 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_start'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_start'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_bronze_dev_silver'
        and tablename = 'stg_dim_conversation_start'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_bronze_dev_silver'
    
    order by ordinal_position
[0m22:18:40.193406 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.410 seconds
[0m22:18:40.202579 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:18:40.202981 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_user'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_user'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_bronze_dev_silver'
        and tablename = 'stg_dim_user'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_bronze_dev_silver'
    
    order by ordinal_position
[0m22:18:40.233962 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.261 seconds
[0m22:18:40.254181 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:18:40.258475 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:18:40.259080 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"} */

      
        
            
        delete from "thrivedev"."dev_bronze_dev_silver"."stg_dim_conversation_start"
    where (id) in (
        select distinct id
        from "stg_dim_conversation_start__dbt_tmp221837706695" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:18:40.286389 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.368 seconds
[0m22:18:40.297773 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:18:40.298387 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_part'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_part'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_bronze_dev_silver'
        and tablename = 'stg_dim_conversation_part'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_bronze_dev_silver'
    
    order by ordinal_position
[0m22:18:40.365530 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.162 seconds
[0m22:18:40.367315 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:18:40.369836 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:18:40.370089 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_user"} */

      
        
            
        delete from "thrivedev"."dev_bronze_dev_silver"."stg_dim_user"
    where (id) in (
        select distinct id
        from "stg_dim_user__dbt_tmp221837723510" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:18:40.412030 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.152 seconds
[0m22:18:40.413035 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:18:40.413759 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: insert into "thrivedev"."dev_bronze_dev_silver"."stg_dim_conversation_start" ("id", "source_type", "conv_dataset_email", "priority", "message", "created_at", "get_date_at")
        (
            select "id", "source_type", "conv_dataset_email", "priority", "message", "created_at", "get_date_at"
            from "stg_dim_conversation_start__dbt_tmp221837706695"
        )
[0m22:18:40.501062 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.130 seconds
[0m22:18:40.502621 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:18:40.503360 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: insert into "thrivedev"."dev_bronze_dev_silver"."stg_dim_user" ("id", "name", "email", "is_customer", "get_date_at")
        (
            select "id", "name", "email", "is_customer", "get_date_at"
            from "stg_dim_user__dbt_tmp221837723510"
        )
[0m22:18:40.534053 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.119 seconds
[0m22:18:40.544692 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: COMMIT
[0m22:18:40.545116 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:18:40.545299 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: COMMIT
[0m22:18:40.555960 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.257 seconds
[0m22:18:40.557323 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:18:40.558583 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:18:40.558795 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"} */

      
        
            
        delete from "thrivedev"."dev_bronze_dev_silver"."stg_dim_conversation_part"
    where (id) in (
        select distinct id
        from "stg_dim_conversation_part__dbt_tmp221837690016" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:18:40.650885 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.147 seconds
[0m22:18:40.652415 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: COMMIT
[0m22:18:40.652818 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:18:40.653108 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: COMMIT
[0m22:18:40.653638 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.108 seconds
[0m22:18:40.655456 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: Close
[0m22:18:40.658031 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8ca926b-4314-4631-b7b8-2e59f14fa11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0ffc90>]}
[0m22:18:40.658594 [info ] [Thread-2 (]: 2 of 7 OK created sql incremental model dev_bronze_dev_silver.stg_dim_conversation_start  [[32mSUCCESS[0m in 3.00s]
[0m22:18:40.659002 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:18:40.659528 [debug] [Thread-4 (]: Began running node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:18:40.659847 [info ] [Thread-4 (]: 4 of 7 START sql incremental model dev_bronze_dev_gold.dim_conversation_start .. [RUN]
[0m22:18:40.660212 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.dim_conversation_start'
[0m22:18:40.660450 [debug] [Thread-4 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:18:40.666376 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:18:40.667147 [debug] [Thread-4 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:18:40.671425 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:18:40.671748 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_start"} */

    
  
    

  create temporary table
    "dim_conversation_start__dbt_tmp221840669206"
    
    
    
  as (
    

select
    id, 
    source_type, 
    conv_dataset_email, 
    priority, 
    message, 
    created_at,
    get_date_at
from
    "thrivedev"."dev_bronze_dev_silver"."stg_dim_conversation_start"


    where get_date_at > (select max(get_date_at) from "thrivedev"."dev_bronze_dev_gold"."dim_conversation_start")

  );
[0m22:18:40.671999 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:18:40.672244 [debug] [Thread-4 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:18:40.672582 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:18:40.676872 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.118 seconds
[0m22:18:40.677264 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:18:40.677667 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: insert into "thrivedev"."dev_bronze_dev_silver"."stg_dim_conversation_part" ("id", "conversation_id", "conv_dataset_email", "part_type", "message", "created_at", "get_date_at")
        (
            select "id", "conversation_id", "conv_dataset_email", "part_type", "message", "created_at", "get_date_at"
            from "stg_dim_conversation_part__dbt_tmp221837690016"
        )
[0m22:18:40.768548 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.115 seconds
[0m22:18:40.769222 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: Close
[0m22:18:40.769713 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8ca926b-4314-4631-b7b8-2e59f14fa11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b063190>]}
[0m22:18:40.770141 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model dev_bronze_dev_silver.stg_dim_user ..... [[32mSUCCESS[0m in 3.12s]
[0m22:18:40.770693 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:18:40.771152 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.dim_user
[0m22:18:40.771528 [info ] [Thread-2 (]: 5 of 7 START sql incremental model dev_bronze_dev_gold.dim_user ................ [RUN]
[0m22:18:40.771830 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_conversation_start, now model.dbt_thrive1_redshift_dw.dim_user)
[0m22:18:40.772047 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_user
[0m22:18:40.774716 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:18:40.775206 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_user
[0m22:18:40.778705 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:18:40.779003 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_user"} */

    
  
    

  create temporary table
    "dim_user__dbt_tmp221840776639"
    
    
    
  as (
    

select
    id as user_id,
    name,
    email,
    is_customer,
    get_date_at
from
    "thrivedev"."dev_bronze_dev_silver"."stg_dim_user"


    where get_date_at > (select max(get_date_at) from "thrivedev"."dev_bronze_dev_gold"."dim_user")

  );
[0m22:18:40.779230 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:18:40.779431 [debug] [Thread-2 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:18:40.779710 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:18:40.798976 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.121 seconds
[0m22:18:40.800171 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: COMMIT
[0m22:18:40.800465 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:18:40.800678 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: COMMIT
[0m22:18:40.905033 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.104 seconds
[0m22:18:40.905773 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: Close
[0m22:18:40.906421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8ca926b-4314-4631-b7b8-2e59f14fa11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fe6950>]}
[0m22:18:40.906862 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model dev_bronze_dev_silver.stg_dim_conversation_part  [[32mSUCCESS[0m in 3.25s]
[0m22:18:40.907244 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:18:40.907686 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:18:40.907966 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:18:40.908312 [info ] [Thread-3 (]: 6 of 7 START sql incremental model dev_bronze_dev_gold.dim_conversation_part ... [RUN]
[0m22:18:40.908654 [info ] [Thread-1 (]: 7 of 7 START sql incremental model dev_bronze_dev_silver.stg_fact_consolidated_messages  [RUN]
[0m22:18:40.908979 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_user, now model.dbt_thrive1_redshift_dw.dim_conversation_part)
[0m22:18:40.909241 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_conversation_part, now model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages)
[0m22:18:40.909495 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:18:40.909715 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:18:40.912645 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:18:40.915704 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:18:40.916289 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:18:40.920567 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:18:40.920855 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:18:40.921195 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_part"} */

    
  
    

  create temporary table
    "dim_conversation_part__dbt_tmp221840917814"
    
    
    
  as (
    

select
    id as part_id,
    conversation_id,
    conv_dataset_email,
    part_type,
    message,
    created_at,
    get_date_at
from
    "thrivedev"."dev_bronze_dev_silver"."stg_dim_conversation_part"



    where get_date_at > (select max(get_date_at) from "thrivedev"."dev_bronze_dev_gold"."dim_conversation_part")

  );
[0m22:18:40.926091 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:18:40.926315 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:18:40.926566 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"} */

    
  
    

  create temporary table
    "stg_fact_consolidated_messages__dbt_tmp221840922805"
    
    
    
  as (
    


WITH
  start_msgs AS (
    SELECT
      id           AS msg_id,
      conv_dataset_email AS email,
      id           AS conversation_id,
      message,
      'open'       AS message_type,
      created_at
    FROM 
        "thrivedev"."dev_bronze_dev_silver"."stg_dim_conversation_start"
  ),
  part_msgs AS (
    SELECT
      id           AS msg_id,
      conv_dataset_email AS email,
      conversation_id,
      message,
      part_type    AS message_type,
      created_at
    FROM 
        "thrivedev"."dev_bronze_dev_silver"."stg_dim_conversation_part"
  ),
  all_msgs AS (
    SELECT * FROM start_msgs
    UNION ALL
    SELECT * FROM part_msgs
  ),
  conv_customer AS (
    SELECT
      am.conversation_id,
      u.id AS user_id
    FROM all_msgs am
    INNER JOIN "thrivedev"."dev_bronze_dev_silver"."stg_dim_user" u
      ON am.email = u.email
    WHERE u.is_customer = 1
    GROUP BY user_id, am.conversation_id
  )
SELECT
  am.msg_id      AS id,
  cc.user_id     AS user_id,
  am.email       AS email,
  am.conversation_id,
  am.message,
  am.message_type,
  am.created_at
FROM all_msgs am
INNER JOIN conv_customer cc
  ON am.conversation_id = cc.conversation_id
ORDER BY
  am.conversation_id,
  am.created_at
  );
[0m22:18:40.926818 [debug] [Thread-3 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:18:40.927080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:18:40.927333 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:18:40.927524 [debug] [Thread-1 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:18:40.928390 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:18:41.201624 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.529 seconds
[0m22:18:41.207995 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:18:41.208190 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: BEGIN
[0m22:18:41.262747 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.054 seconds
[0m22:18:41.264079 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:18:41.264891 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_start__dbt_tmp221840669206'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_start__dbt_tmp221840669206'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'dim_conversation_start__dbt_tmp221840669206'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:18:41.359135 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.572 seconds
[0m22:18:41.369018 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:18:41.369374 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_user: BEGIN
[0m22:18:41.429961 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.060 seconds
[0m22:18:41.431401 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:18:41.432694 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_user__dbt_tmp221840776639'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_user__dbt_tmp221840776639'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'dim_user__dbt_tmp221840776639'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:18:41.634644 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.708 seconds
[0m22:18:41.642412 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:18:41.642762 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: BEGIN
[0m22:18:41.691396 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.426 seconds
[0m22:18:41.700494 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:18:41.700974 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.058 seconds
[0m22:18:41.701579 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_start'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_start'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_bronze_dev_gold'
        and tablename = 'dim_conversation_start'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_bronze_dev_gold'
    
    order by ordinal_position
[0m22:18:41.702017 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:18:41.702579 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_part__dbt_tmp221840917814'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_part__dbt_tmp221840917814'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'dim_conversation_part__dbt_tmp221840917814'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:18:41.847686 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.413 seconds
[0m22:18:41.864434 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:18:41.865125 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_user'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_user'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_bronze_dev_gold'
        and tablename = 'dim_user'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_bronze_dev_gold'
    
    order by ordinal_position
[0m22:18:42.347020 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.644 seconds
[0m22:18:42.360576 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:18:42.361338 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_start'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_start'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_bronze_dev_gold'
        and tablename = 'dim_conversation_start'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_bronze_dev_gold'
    
    order by ordinal_position
[0m22:18:42.391573 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.688 seconds
[0m22:18:42.392099 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.526 seconds
[0m22:18:42.406172 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:18:42.416180 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:18:42.416690 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_part'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_part'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_bronze_dev_gold'
        and tablename = 'dim_conversation_part'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_bronze_dev_gold'
    
    order by ordinal_position
[0m22:18:42.417259 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_user'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_user'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_bronze_dev_gold'
        and tablename = 'dim_user'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_bronze_dev_gold'
    
    order by ordinal_position
[0m22:18:42.710232 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.347 seconds
[0m22:18:42.716789 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:18:42.721716 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:18:42.722236 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_start"} */

      
        
            
        delete from "thrivedev"."dev_bronze_dev_gold"."dim_conversation_start"
    where (id) in (
        select distinct id
        from "dim_conversation_start__dbt_tmp221840669206" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:18:42.793196 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.375 seconds
[0m22:18:42.795298 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:18:42.796809 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:18:42.797077 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_user"} */

      
        
            
        delete from "thrivedev"."dev_bronze_dev_gold"."dim_user"
    where (user_id) in (
        select distinct user_id
        from "dim_user__dbt_tmp221840776639" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:18:42.891922 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.169 seconds
[0m22:18:42.892829 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:18:42.893358 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: insert into "thrivedev"."dev_bronze_dev_gold"."dim_conversation_start" ("id", "source_type", "conv_dataset_email", "priority", "message", "created_at", "get_date_at")
        (
            select "id", "source_type", "conv_dataset_email", "priority", "message", "created_at", "get_date_at"
            from "dim_conversation_start__dbt_tmp221840669206"
        )
[0m22:18:42.897927 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.480 seconds
[0m22:18:42.911397 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:18:42.912125 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_part'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_part'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_bronze_dev_gold'
        and tablename = 'dim_conversation_part'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_bronze_dev_gold'
    
    order by ordinal_position
[0m22:18:42.930055 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.133 seconds
[0m22:18:42.930489 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:18:42.930835 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_user: insert into "thrivedev"."dev_bronze_dev_gold"."dim_user" ("user_id", "name", "email", "is_customer", "get_date_at")
        (
            select "user_id", "name", "email", "is_customer", "get_date_at"
            from "dim_user__dbt_tmp221840776639"
        )
[0m22:18:43.069181 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.175 seconds
[0m22:18:43.074533 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: COMMIT
[0m22:18:43.075493 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:18:43.075992 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: COMMIT
[0m22:18:43.211210 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.279 seconds
[0m22:18:43.215303 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_user: COMMIT
[0m22:18:43.216182 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.140 seconds
[0m22:18:43.216933 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:18:43.218184 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: Close
[0m22:18:43.218698 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_user: COMMIT
[0m22:18:43.219963 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8ca926b-4314-4631-b7b8-2e59f14fa11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f587d0>]}
[0m22:18:43.220965 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model dev_bronze_dev_gold.dim_conversation_start  [[32mSUCCESS[0m in 2.56s]
[0m22:18:43.221636 [debug] [Thread-4 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:18:43.224046 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.311 seconds
[0m22:18:43.226597 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:18:43.230503 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:18:43.230947 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_part"} */

      
        
            
        delete from "thrivedev"."dev_bronze_dev_gold"."dim_conversation_part"
    where (part_id) in (
        select distinct part_id
        from "dim_conversation_part__dbt_tmp221840917814" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:18:43.356579 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.137 seconds
[0m22:18:43.358303 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_user: Close
[0m22:18:43.359573 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8ca926b-4314-4631-b7b8-2e59f14fa11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0fc990>]}
[0m22:18:43.360170 [info ] [Thread-2 (]: 5 of 7 OK created sql incremental model dev_bronze_dev_gold.dim_user ........... [[32mSUCCESS[0m in 2.59s]
[0m22:18:43.360530 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_user
[0m22:18:43.415977 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.184 seconds
[0m22:18:43.417985 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:18:43.418630 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: insert into "thrivedev"."dev_bronze_dev_gold"."dim_conversation_part" ("part_id", "conversation_id", "conv_dataset_email", "part_type", "message", "created_at", "get_date_at")
        (
            select "part_id", "conversation_id", "conv_dataset_email", "part_type", "message", "created_at", "get_date_at"
            from "dim_conversation_part__dbt_tmp221840917814"
        )
[0m22:18:43.541673 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.122 seconds
[0m22:18:43.545806 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: COMMIT
[0m22:18:43.546435 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:18:43.546678 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: COMMIT
[0m22:18:43.677887 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.130 seconds
[0m22:18:43.680564 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: Close
[0m22:18:43.682595 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8ca926b-4314-4631-b7b8-2e59f14fa11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b217210>]}
[0m22:18:43.683843 [info ] [Thread-3 (]: 6 of 7 OK created sql incremental model dev_bronze_dev_gold.dim_conversation_part  [[32mSUCCESS[0m in 2.77s]
[0m22:18:43.684653 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:18:53.073753 [debug] [Thread-1 (]: SQL status: SUCCESS in 12.146 seconds
[0m22:18:53.088539 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:18:53.088971 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: BEGIN
[0m22:18:53.143833 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.054 seconds
[0m22:18:53.144438 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:18:53.145270 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_fact_consolidated_messages__dbt_tmp221840922805'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_fact_consolidated_messages__dbt_tmp221840922805'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'stg_fact_consolidated_messages__dbt_tmp221840922805'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:18:53.356682 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.210 seconds
[0m22:18:53.372195 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:18:53.372714 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_fact_consolidated_messages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_fact_consolidated_messages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_bronze_dev_silver'
        and tablename = 'stg_fact_consolidated_messages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_bronze_dev_silver'
    
    order by ordinal_position
[0m22:18:53.546097 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.173 seconds
[0m22:18:53.556679 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:18:53.557213 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_fact_consolidated_messages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_fact_consolidated_messages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_bronze_dev_silver'
        and tablename = 'stg_fact_consolidated_messages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_bronze_dev_silver'
    
    order by ordinal_position
[0m22:18:53.703012 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.145 seconds
[0m22:18:53.705167 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:18:53.707240 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:18:53.707582 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"} */

      
        
            
        delete from "thrivedev"."dev_bronze_dev_silver"."stg_fact_consolidated_messages"
    where (id) in (
        select distinct id
        from "stg_fact_consolidated_messages__dbt_tmp221840922805" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:18:53.808151 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.100 seconds
[0m22:18:53.808918 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:18:53.809367 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: insert into "thrivedev"."dev_bronze_dev_silver"."stg_fact_consolidated_messages" ("id", "user_id", "email", "conversation_id", "message", "message_type", "created_at")
        (
            select "id", "user_id", "email", "conversation_id", "message", "message_type", "created_at"
            from "stg_fact_consolidated_messages__dbt_tmp221840922805"
        )
[0m22:18:59.495859 [debug] [Thread-1 (]: SQL status: SUCCESS in 5.685 seconds
[0m22:18:59.499773 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: COMMIT
[0m22:18:59.500893 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:18:59.501528 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: COMMIT
[0m22:18:59.591831 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.090 seconds
[0m22:18:59.593414 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: Close
[0m22:18:59.595695 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8ca926b-4314-4631-b7b8-2e59f14fa11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0c9dd0>]}
[0m22:18:59.597039 [info ] [Thread-1 (]: 7 of 7 OK created sql incremental model dev_bronze_dev_silver.stg_fact_consolidated_messages  [[32mSUCCESS[0m in 18.69s]
[0m22:18:59.597940 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:18:59.600122 [debug] [MainThread]: Using redshift connection "master"
[0m22:18:59.600517 [debug] [MainThread]: On master: BEGIN
[0m22:18:59.600814 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:18:59.601247 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:18:59.601926 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:19:00.009812 [debug] [MainThread]: SQL status: SUCCESS in 0.409 seconds
[0m22:19:00.012007 [debug] [MainThread]: On master: COMMIT
[0m22:19:00.012726 [debug] [MainThread]: Using redshift connection "master"
[0m22:19:00.012938 [debug] [MainThread]: On master: COMMIT
[0m22:19:00.071193 [debug] [MainThread]: SQL status: SUCCESS in 0.058 seconds
[0m22:19:00.072254 [debug] [MainThread]: On master: Close
[0m22:19:00.075362 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:19:00.075917 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages' was properly closed.
[0m22:19:00.076194 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_user' was properly closed.
[0m22:19:00.076435 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_conversation_part' was properly closed.
[0m22:19:00.076674 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_conversation_start' was properly closed.
[0m22:19:00.077095 [info ] [MainThread]: 
[0m22:19:00.077462 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 24.29 seconds (24.29s).
[0m22:19:00.078957 [debug] [MainThread]: Command end result
[0m22:19:00.106066 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m22:19:00.107791 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m22:19:00.112247 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/run_results.json
[0m22:19:00.112478 [info ] [MainThread]: 
[0m22:19:00.112723 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:19:00.112917 [info ] [MainThread]: 
[0m22:19:00.113128 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m22:19:00.115792 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 24.728523, "process_in_blocks": "0", "process_kernel_time": 0.295225, "process_mem_max_rss": "143933440", "process_out_blocks": "0", "process_user_time": 2.078405}
[0m22:19:00.116072 [debug] [MainThread]: Command `dbt run` succeeded at 22:19:00.116010 after 24.73 seconds
[0m22:19:00.116295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098b3d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098b3e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057bc390>]}
[0m22:19:00.116510 [debug] [MainThread]: Flushing usage events
[0m22:19:00.365647 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:26:50.122924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114461cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144b77d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144b7b10>]}


============================== 22:26:50.126463 | 93aee9a3-1a06-465b-97ed-680b818b8f00 ==============================
[0m22:26:50.126463 [info ] [MainThread]: Running with dbt=1.10.0-b2
[0m22:26:50.126833 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/henk/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:26:50.216618 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m22:26:50.216973 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m22:26:50.308997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93aee9a3-1a06-465b-97ed-680b818b8f00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147fbbd0>]}
[0m22:26:50.332845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93aee9a3-1a06-465b-97ed-680b818b8f00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106828510>]}
[0m22:26:50.333686 [info ] [MainThread]: Registered adapter: redshift=1.9.3
[0m22:26:50.393044 [debug] [MainThread]: checksum: 5a225a3ea19c91174578d2c3f7f3bd92801a2649697bdcbd194e936bd8925adb, vars: {}, profile: , target: , version: 1.10.0b2
[0m22:26:50.448770 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:26:50.449078 [debug] [MainThread]: Partial parsing: added file: dbt_thrive1_redshift_dw://macros/generate_schema_name.sql
[0m22:26:50.450388 [info ] [MainThread]: Unable to do partial parsing because change detected to override macro. Starting full parse.
[0m22:26:50.916434 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_thrive1_redshift_dw.gold.facts
[0m22:26:50.919029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93aee9a3-1a06-465b-97ed-680b818b8f00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1158f9bd0>]}
[0m22:26:50.946211 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m22:26:50.950429 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m22:26:50.956741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93aee9a3-1a06-465b-97ed-680b818b8f00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115d253d0>]}
[0m22:26:50.957021 [info ] [MainThread]: Found 7 models, 505 macros
[0m22:26:50.957194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93aee9a3-1a06-465b-97ed-680b818b8f00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1175e5290>]}
[0m22:26:50.958123 [info ] [MainThread]: 
[0m22:26:50.958299 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:26:50.958428 [info ] [MainThread]: 
[0m22:26:50.958651 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m22:26:50.960541 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev_dev_gold'
[0m22:26:50.960870 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev_dev_silver'
[0m22:26:50.968699 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_gold"
[0m22:26:50.970456 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_silver"
[0m22:26:50.970636 [debug] [ThreadPool]: On list_thrivedev_dev_gold: BEGIN
[0m22:26:50.970767 [debug] [ThreadPool]: On list_thrivedev_dev_silver: BEGIN
[0m22:26:50.970893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:26:50.971012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:26:50.971166 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:26:50.971303 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:26:50.973095 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:26:50.973287 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:26:51.414456 [debug] [ThreadPool]: SQL status: SUCCESS in 0.443 seconds
[0m22:26:51.414830 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_silver"
[0m22:26:51.415067 [debug] [ThreadPool]: On list_thrivedev_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_silver"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_silver'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_silver'
[0m22:26:51.424715 [debug] [ThreadPool]: SQL status: SUCCESS in 0.454 seconds
[0m22:26:51.424927 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_gold"
[0m22:26:51.425155 [debug] [ThreadPool]: On list_thrivedev_dev_gold: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_gold"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_gold'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_gold'
[0m22:26:51.507833 [debug] [ThreadPool]: SQL status: SUCCESS in 0.082 seconds
[0m22:26:51.508234 [debug] [ThreadPool]: SQL status: SUCCESS in 0.093 seconds
[0m22:26:51.545405 [debug] [ThreadPool]: On list_thrivedev_dev_gold: ROLLBACK
[0m22:26:51.546081 [debug] [ThreadPool]: On list_thrivedev_dev_silver: ROLLBACK
[0m22:26:51.614555 [debug] [ThreadPool]: On list_thrivedev_dev_silver: Close
[0m22:26:51.614794 [debug] [ThreadPool]: On list_thrivedev_dev_gold: Close
[0m22:26:51.619319 [debug] [MainThread]: Using redshift connection "master"
[0m22:26:51.619497 [debug] [MainThread]: On master: BEGIN
[0m22:26:51.619620 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:26:51.619755 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:26:51.619951 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:26:51.950145 [debug] [MainThread]: SQL status: SUCCESS in 0.330 seconds
[0m22:26:51.950890 [debug] [MainThread]: Using redshift connection "master"
[0m22:26:51.951259 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m22:26:52.029843 [debug] [MainThread]: SQL status: SUCCESS in 0.078 seconds
[0m22:26:52.034601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93aee9a3-1a06-465b-97ed-680b818b8f00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115992e10>]}
[0m22:26:52.035995 [debug] [MainThread]: On master: ROLLBACK
[0m22:26:52.089603 [debug] [MainThread]: On master: Close
[0m22:26:52.097304 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:26:52.097570 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:26:52.097829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_gold, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_part)
[0m22:26:52.097998 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:26:52.098176 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_silver, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_start)
[0m22:26:52.098353 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:26:52.098577 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.stg_dim_user'
[0m22:26:52.098750 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:26:52.100860 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:26:52.101041 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:26:52.102565 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:26:52.104307 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:26:52.104595 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:26:52.105036 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:26:52.105234 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:26:52.105498 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:26:52.105829 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:26:52.106020 [debug] [Thread-4 (]: Began running node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:26:52.106330 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:26:52.106642 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.dim_conversation_part'
[0m22:26:52.106884 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:26:52.107124 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.dim_user
[0m22:26:52.107266 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:26:52.107404 [debug] [Thread-4 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:26:52.107584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_conversation_part, now model.dbt_thrive1_redshift_dw.dim_conversation_start)
[0m22:26:52.107754 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_conversation_start, now model.dbt_thrive1_redshift_dw.dim_user)
[0m22:26:52.107918 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_user, now model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages)
[0m22:26:52.109606 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:26:52.109787 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:26:52.109945 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_user
[0m22:26:52.110094 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:26:52.111802 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:26:52.113420 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:26:52.115238 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:26:52.115721 [debug] [Thread-4 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:26:52.116041 [debug] [Thread-4 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:26:52.116311 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:26:52.116629 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_user
[0m22:26:52.116798 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:26:52.117133 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:26:52.117410 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_user
[0m22:26:52.117672 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:26:52.118234 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:26:52.118371 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_conversation_start' was properly closed.
[0m22:26:52.118491 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_user' was properly closed.
[0m22:26:52.118601 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages' was properly closed.
[0m22:26:52.118707 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_conversation_part' was properly closed.
[0m22:26:52.119202 [debug] [MainThread]: Command end result
[0m22:26:52.130953 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m22:26:52.131709 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m22:26:52.135238 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/run_results.json
[0m22:26:52.137357 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.0538707, "process_in_blocks": "0", "process_kernel_time": 0.248115, "process_mem_max_rss": "144064512", "process_out_blocks": "0", "process_user_time": 1.526371}
[0m22:26:52.137581 [debug] [MainThread]: Command `dbt compile` succeeded at 22:26:52.137540 after 2.05 seconds
[0m22:26:52.137759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104db1d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113618c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e4c3d0>]}
[0m22:26:52.137932 [debug] [MainThread]: Flushing usage events
[0m22:26:52.347290 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:27:02.583707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b6a550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bb7350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bb77d0>]}


============================== 22:27:02.586360 | 9578dde2-38c0-489b-ae07-c40a5dd134ba ==============================
[0m22:27:02.586360 [info ] [MainThread]: Running with dbt=1.10.0-b2
[0m22:27:02.586766 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/henk/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:27:02.666579 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m22:27:02.666895 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m22:27:02.751405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9578dde2-38c0-489b-ae07-c40a5dd134ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115879ed0>]}
[0m22:27:02.775378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9578dde2-38c0-489b-ae07-c40a5dd134ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ac4f50>]}
[0m22:27:02.776798 [info ] [MainThread]: Registered adapter: redshift=1.9.3
[0m22:27:02.837348 [debug] [MainThread]: checksum: 5a225a3ea19c91174578d2c3f7f3bd92801a2649697bdcbd194e936bd8925adb, vars: {}, profile: , target: , version: 1.10.0b2
[0m22:27:02.889860 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:27:02.890070 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:27:02.892645 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_thrive1_redshift_dw.gold.facts
[0m22:27:02.902783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9578dde2-38c0-489b-ae07-c40a5dd134ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1158daad0>]}
[0m22:27:02.931424 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m22:27:02.932626 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m22:27:02.938842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9578dde2-38c0-489b-ae07-c40a5dd134ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a9b910>]}
[0m22:27:02.939120 [info ] [MainThread]: Found 7 models, 505 macros
[0m22:27:02.939280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9578dde2-38c0-489b-ae07-c40a5dd134ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115915290>]}
[0m22:27:02.940278 [info ] [MainThread]: 
[0m22:27:02.940447 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:27:02.940578 [info ] [MainThread]: 
[0m22:27:02.940828 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m22:27:02.942735 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev'
[0m22:27:02.942990 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev'
[0m22:27:02.951229 [debug] [ThreadPool]: Using redshift connection "list_thrivedev"
[0m22:27:02.952585 [debug] [ThreadPool]: Using redshift connection "list_thrivedev"
[0m22:27:02.952785 [debug] [ThreadPool]: On list_thrivedev: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev"} */

    select distinct nspname from pg_namespace
[0m22:27:02.952946 [debug] [ThreadPool]: On list_thrivedev: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev"} */

    select distinct nspname from pg_namespace
[0m22:27:02.953100 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:27:02.953223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:27:02.953383 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:27:02.953515 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:27:02.955437 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:27:02.955627 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:27:03.338173 [debug] [ThreadPool]: SQL status: SUCCESS in 0.385 seconds
[0m22:27:03.384477 [debug] [ThreadPool]: On list_thrivedev: Close
[0m22:27:03.416978 [debug] [ThreadPool]: SQL status: SUCCESS in 0.464 seconds
[0m22:27:03.417828 [debug] [ThreadPool]: On list_thrivedev: Close
[0m22:27:03.418414 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrivedev, now create_thrivedev_dev_gold)
[0m22:27:03.418716 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrivedev, now create_thrivedev_dev_silver)
[0m22:27:03.419243 [debug] [ThreadPool]: Creating schema "database: "thrivedev"
schema: "dev_gold"
"
[0m22:27:03.419515 [debug] [ThreadPool]: Creating schema "database: "thrivedev"
schema: "dev_silver"
"
[0m22:27:03.457263 [debug] [ThreadPool]: Using redshift connection "create_thrivedev_dev_gold"
[0m22:27:03.459066 [debug] [ThreadPool]: Using redshift connection "create_thrivedev_dev_silver"
[0m22:27:03.459316 [debug] [ThreadPool]: On create_thrivedev_dev_gold: BEGIN
[0m22:27:03.459527 [debug] [ThreadPool]: On create_thrivedev_dev_silver: BEGIN
[0m22:27:03.459685 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:27:03.459826 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:27:03.459981 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:27:03.460138 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:27:03.460354 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:27:03.460542 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:27:03.888717 [debug] [ThreadPool]: SQL status: SUCCESS in 0.429 seconds
[0m22:27:03.889168 [debug] [ThreadPool]: Using redshift connection "create_thrivedev_dev_silver"
[0m22:27:03.889396 [debug] [ThreadPool]: On create_thrivedev_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "create_thrivedev_dev_silver"} */
create schema if not exists "dev_silver"
[0m22:27:03.891976 [debug] [ThreadPool]: SQL status: SUCCESS in 0.432 seconds
[0m22:27:03.892201 [debug] [ThreadPool]: Using redshift connection "create_thrivedev_dev_gold"
[0m22:27:03.892432 [debug] [ThreadPool]: On create_thrivedev_dev_gold: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "create_thrivedev_dev_gold"} */
create schema if not exists "dev_gold"
[0m22:27:04.030338 [debug] [ThreadPool]: SQL status: SUCCESS in 0.141 seconds
[0m22:27:04.034215 [debug] [ThreadPool]: On create_thrivedev_dev_silver: COMMIT
[0m22:27:04.036468 [debug] [ThreadPool]: Using redshift connection "create_thrivedev_dev_silver"
[0m22:27:04.037142 [debug] [ThreadPool]: On create_thrivedev_dev_silver: COMMIT
[0m22:27:04.121516 [debug] [ThreadPool]: SQL status: SUCCESS in 0.084 seconds
[0m22:27:04.121860 [debug] [ThreadPool]: On create_thrivedev_dev_silver: Close
[0m22:27:04.267569 [debug] [ThreadPool]: SQL status: SUCCESS in 0.374 seconds
[0m22:27:04.270470 [debug] [ThreadPool]: On create_thrivedev_dev_gold: COMMIT
[0m22:27:04.271139 [debug] [ThreadPool]: Using redshift connection "create_thrivedev_dev_gold"
[0m22:27:04.271541 [debug] [ThreadPool]: On create_thrivedev_dev_gold: COMMIT
[0m22:27:04.358306 [debug] [ThreadPool]: SQL status: SUCCESS in 0.086 seconds
[0m22:27:04.360005 [debug] [ThreadPool]: On create_thrivedev_dev_gold: Close
[0m22:27:04.364712 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_thrivedev_dev_gold, now list_thrivedev_dev_gold)
[0m22:27:04.365497 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_thrivedev_dev_silver, now list_thrivedev_dev_silver)
[0m22:27:04.378308 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_gold"
[0m22:27:04.381768 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_silver"
[0m22:27:04.382068 [debug] [ThreadPool]: On list_thrivedev_dev_gold: BEGIN
[0m22:27:04.382348 [debug] [ThreadPool]: On list_thrivedev_dev_silver: BEGIN
[0m22:27:04.382684 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:27:04.382926 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:27:04.383203 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:27:04.383449 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:27:04.383837 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:27:04.384120 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:27:04.822502 [debug] [ThreadPool]: SQL status: SUCCESS in 0.439 seconds
[0m22:27:04.824221 [debug] [ThreadPool]: SQL status: SUCCESS in 0.441 seconds
[0m22:27:04.825425 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_silver"
[0m22:27:04.826178 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_gold"
[0m22:27:04.826693 [debug] [ThreadPool]: On list_thrivedev_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_silver"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_silver'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_silver'
[0m22:27:04.827185 [debug] [ThreadPool]: On list_thrivedev_dev_gold: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_gold"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_gold'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_gold'
[0m22:27:04.930878 [debug] [ThreadPool]: SQL status: SUCCESS in 0.103 seconds
[0m22:27:04.932202 [debug] [ThreadPool]: SQL status: SUCCESS in 0.105 seconds
[0m22:27:04.935455 [debug] [ThreadPool]: On list_thrivedev_dev_gold: ROLLBACK
[0m22:27:04.937163 [debug] [ThreadPool]: On list_thrivedev_dev_silver: ROLLBACK
[0m22:27:04.993825 [debug] [ThreadPool]: On list_thrivedev_dev_gold: Close
[0m22:27:04.996914 [debug] [ThreadPool]: On list_thrivedev_dev_silver: Close
[0m22:27:05.010122 [debug] [MainThread]: Using redshift connection "master"
[0m22:27:05.010599 [debug] [MainThread]: On master: BEGIN
[0m22:27:05.010921 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:27:05.011257 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:27:05.011721 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:27:05.434923 [debug] [MainThread]: SQL status: SUCCESS in 0.423 seconds
[0m22:27:05.437054 [debug] [MainThread]: Using redshift connection "master"
[0m22:27:05.438161 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m22:27:05.513381 [debug] [MainThread]: SQL status: SUCCESS in 0.074 seconds
[0m22:27:05.517748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9578dde2-38c0-489b-ae07-c40a5dd134ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115abfc90>]}
[0m22:27:05.518720 [debug] [MainThread]: On master: ROLLBACK
[0m22:27:05.578128 [debug] [MainThread]: Using redshift connection "master"
[0m22:27:05.579328 [debug] [MainThread]: On master: BEGIN
[0m22:27:05.607295 [debug] [MainThread]: SQL status: SUCCESS in 0.027 seconds
[0m22:27:05.608614 [debug] [MainThread]: On master: COMMIT
[0m22:27:05.609943 [debug] [MainThread]: Using redshift connection "master"
[0m22:27:05.610849 [debug] [MainThread]: On master: COMMIT
[0m22:27:05.676253 [debug] [MainThread]: SQL status: SUCCESS in 0.065 seconds
[0m22:27:05.677897 [debug] [MainThread]: On master: Close
[0m22:27:05.684947 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:27:05.685979 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:27:05.686522 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:27:05.687154 [info ] [Thread-1 (]: 1 of 7 START sql incremental model dev_silver.stg_dim_conversation_part ........ [RUN]
[0m22:27:05.687765 [info ] [Thread-2 (]: 2 of 7 START sql incremental model dev_silver.stg_dim_conversation_start ....... [RUN]
[0m22:27:05.688306 [info ] [Thread-3 (]: 3 of 7 START sql incremental model dev_silver.stg_dim_user ..................... [RUN]
[0m22:27:05.688872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_gold, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_part)
[0m22:27:05.689288 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_silver, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_start)
[0m22:27:05.689870 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.stg_dim_user'
[0m22:27:05.690280 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:27:05.690654 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:27:05.690996 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:27:05.695474 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:27:05.698987 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:27:05.701709 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:27:05.702771 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:27:05.715660 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:27:05.728557 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:27:05.750162 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:27:05.750609 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:27:05.752756 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:27:05.754209 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:27:05.754796 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:27:05.755464 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:27:05.755650 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: BEGIN
[0m22:27:05.755819 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: BEGIN
[0m22:27:05.755987 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: BEGIN
[0m22:27:05.756148 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:27:05.756300 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:27:05.756452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:27:05.756627 [debug] [Thread-2 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:27:05.756790 [debug] [Thread-3 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:27:05.756950 [debug] [Thread-1 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:27:05.757180 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:27:05.757381 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:27:05.757575 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:27:06.210732 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.454 seconds
[0m22:27:06.211684 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:27:06.212186 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"} */

      
  
    

  create  table
    "thrivedev"."dev_silver"."stg_dim_conversation_start"
    
    
    
  as (
    

select
    id, 
    source_type, 
    conv_dataset_email, 
    priority, 
    message, 
    created_at,
    getdate() as get_date_at
from
    dev_bronze.ext_conversation_start
  );
[0m22:27:06.213036 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.457 seconds
[0m22:27:06.213544 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.457 seconds
[0m22:27:06.214047 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:27:06.214470 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:27:06.214861 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_user"} */

      
  
    

  create  table
    "thrivedev"."dev_silver"."stg_dim_user"
    
    
    
  as (
    

select
    id,
    name,
    email,
    is_customer,
    getdate() as get_date_at
from
    dev_bronze.ext_users
  );
[0m22:27:06.215221 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"} */

      
  
    

  create  table
    "thrivedev"."dev_silver"."stg_dim_conversation_part"
    
    
    
  as (
    

select
    id, 
    conversation_id, 
    conv_dataset_email, 
    part_type, 
    message, 
    created_at,
    getdate() as get_date_at
from
    dev_bronze.ext_conversation_part
  );
[0m22:27:07.153453 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.937 seconds
[0m22:27:07.155215 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.942 seconds
[0m22:27:07.156049 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.940 seconds
[0m22:27:07.180021 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: COMMIT
[0m22:27:07.180567 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: COMMIT
[0m22:27:07.181612 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: COMMIT
[0m22:27:07.182095 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:27:07.182394 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:27:07.182669 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:27:07.182915 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: COMMIT
[0m22:27:07.183154 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: COMMIT
[0m22:27:07.183376 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: COMMIT
[0m22:27:07.313238 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.129 seconds
[0m22:27:07.318751 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: Close
[0m22:27:07.319061 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.135 seconds
[0m22:27:07.320597 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: Close
[0m22:27:07.322394 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9578dde2-38c0-489b-ae07-c40a5dd134ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116583b90>]}
[0m22:27:07.322783 [info ] [Thread-2 (]: 2 of 7 OK created sql incremental model dev_silver.stg_dim_conversation_start .. [[32mSUCCESS[0m in 1.63s]
[0m22:27:07.322971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9578dde2-38c0-489b-ae07-c40a5dd134ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d0b410>]}
[0m22:27:07.323215 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:27:07.323464 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model dev_silver.stg_dim_conversation_part ... [[32mSUCCESS[0m in 1.63s]
[0m22:27:07.323842 [debug] [Thread-4 (]: Began running node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:27:07.324107 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:27:07.324337 [info ] [Thread-4 (]: 4 of 7 START sql incremental model dev_gold.dim_conversation_start ............. [RUN]
[0m22:27:07.324681 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.dim_conversation_start'
[0m22:27:07.324846 [debug] [Thread-4 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:27:07.328920 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:27:07.329222 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:27:07.329601 [info ] [Thread-2 (]: 5 of 7 START sql incremental model dev_gold.dim_conversation_part .............. [RUN]
[0m22:27:07.329914 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_conversation_start, now model.dbt_thrive1_redshift_dw.dim_conversation_part)
[0m22:27:07.330171 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:27:07.333439 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:27:07.333876 [debug] [Thread-4 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:27:07.340381 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:27:07.340913 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:27:07.344154 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:27:07.345359 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:27:07.345753 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: BEGIN
[0m22:27:07.346706 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:27:07.346977 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:27:07.347235 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: BEGIN
[0m22:27:07.347522 [debug] [Thread-4 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:27:07.347759 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:27:07.348114 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:27:07.348388 [debug] [Thread-2 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:27:07.349166 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:27:07.357554 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.174 seconds
[0m22:27:07.359299 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: Close
[0m22:27:07.360006 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9578dde2-38c0-489b-ae07-c40a5dd134ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115abec10>]}
[0m22:27:07.360580 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model dev_silver.stg_dim_user ................ [[32mSUCCESS[0m in 1.67s]
[0m22:27:07.361112 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:27:07.361906 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.dim_user
[0m22:27:07.362123 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:27:07.362383 [info ] [Thread-1 (]: 6 of 7 START sql incremental model dev_gold.dim_user ........................... [RUN]
[0m22:27:07.362794 [info ] [Thread-3 (]: 7 of 7 START sql incremental model dev_silver.stg_fact_consolidated_messages ... [RUN]
[0m22:27:07.363156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_conversation_part, now model.dbt_thrive1_redshift_dw.dim_user)
[0m22:27:07.363438 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_user, now model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages)
[0m22:27:07.363653 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_user
[0m22:27:07.363932 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:27:07.366654 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:27:07.369471 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:27:07.369948 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_user
[0m22:27:07.372278 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:27:07.372597 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:27:07.375278 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:27:07.376885 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:27:07.377417 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_user: BEGIN
[0m22:27:07.377714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:27:07.378224 [debug] [Thread-1 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:27:07.382012 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:27:07.382462 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:27:07.382740 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: BEGIN
[0m22:27:07.383302 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:27:07.383570 [debug] [Thread-3 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:27:07.384020 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:27:08.086863 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.739 seconds
[0m22:27:08.090016 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:27:08.090823 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_start"} */

      
  
    

  create  table
    "thrivedev"."dev_gold"."dim_conversation_start"
    
    
    
  as (
    

select
    id, 
    source_type, 
    conv_dataset_email, 
    priority, 
    message, 
    created_at,
    get_date_at
from
    "thrivedev"."dev_silver"."stg_dim_conversation_start"


  );
[0m22:27:08.121115 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.737 seconds
[0m22:27:08.123814 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:27:08.125002 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.747 seconds
[0m22:27:08.125891 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"} */

      
  
    

  create  table
    "thrivedev"."dev_silver"."stg_fact_consolidated_messages"
    
    
    
  as (
    


WITH
  start_msgs AS (
    SELECT
      id           AS msg_id,
      conv_dataset_email AS email,
      id           AS conversation_id,
      message,
      'open'       AS message_type,
      created_at
    FROM 
        "thrivedev"."dev_silver"."stg_dim_conversation_start"
  ),
  part_msgs AS (
    SELECT
      id           AS msg_id,
      conv_dataset_email AS email,
      conversation_id,
      message,
      part_type    AS message_type,
      created_at
    FROM 
        "thrivedev"."dev_silver"."stg_dim_conversation_part"
  ),
  all_msgs AS (
    SELECT * FROM start_msgs
    UNION ALL
    SELECT * FROM part_msgs
  ),
  conv_customer AS (
    SELECT
      am.conversation_id,
      u.id AS user_id
    FROM all_msgs am
    INNER JOIN "thrivedev"."dev_silver"."stg_dim_user" u
      ON am.email = u.email
    WHERE u.is_customer = 1
    GROUP BY user_id, am.conversation_id
  )
SELECT
  am.msg_id      AS id,
  cc.user_id     AS user_id,
  am.email       AS email,
  am.conversation_id,
  am.message,
  am.message_type,
  am.created_at
FROM all_msgs am
INNER JOIN conv_customer cc
  ON am.conversation_id = cc.conversation_id
ORDER BY
  am.conversation_id,
  am.created_at
  );
[0m22:27:08.126603 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:27:08.127333 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_user"} */

      
  
    

  create  table
    "thrivedev"."dev_gold"."dim_user"
    
    
    
  as (
    

select
    id as user_id,
    name,
    email,
    is_customer,
    get_date_at
from
    "thrivedev"."dev_silver"."stg_dim_user"


  );
[0m22:27:08.154694 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.806 seconds
[0m22:27:08.156679 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:27:08.157483 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_part"} */

      
  
    

  create  table
    "thrivedev"."dev_gold"."dim_conversation_part"
    
    
    
  as (
    

select
    id as part_id,
    conversation_id,
    conv_dataset_email,
    part_type,
    message,
    created_at,
    get_date_at
from
    "thrivedev"."dev_silver"."stg_dim_conversation_part"



  );
[0m22:27:08.332808 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.240 seconds
[0m22:27:08.339268 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: COMMIT
[0m22:27:08.340402 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:27:08.340999 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.213 seconds
[0m22:27:08.341518 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: COMMIT
[0m22:27:08.343292 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_user: COMMIT
[0m22:27:08.344002 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:27:08.344444 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_user: COMMIT
[0m22:27:08.488543 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.142 seconds
[0m22:27:08.490060 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: Close
[0m22:27:08.490977 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9578dde2-38c0-489b-ae07-c40a5dd134ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1165a8750>]}
[0m22:27:08.491764 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model dev_gold.dim_conversation_start ........ [[32mSUCCESS[0m in 1.17s]
[0m22:27:08.492372 [debug] [Thread-4 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:27:08.496049 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.151 seconds
[0m22:27:08.497011 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_user: Close
[0m22:27:08.497815 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9578dde2-38c0-489b-ae07-c40a5dd134ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114df3610>]}
[0m22:27:08.498600 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model dev_gold.dim_user ...................... [[32mSUCCESS[0m in 1.13s]
[0m22:27:08.499387 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_user
[0m22:27:08.575441 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.448 seconds
[0m22:27:08.577443 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: COMMIT
[0m22:27:08.578067 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:27:08.578453 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: COMMIT
[0m22:27:08.585584 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.428 seconds
[0m22:27:08.586887 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: COMMIT
[0m22:27:08.587334 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:27:08.587687 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: COMMIT
[0m22:27:08.696630 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.117 seconds
[0m22:27:08.699168 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: Close
[0m22:27:08.700642 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9578dde2-38c0-489b-ae07-c40a5dd134ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115bb5b10>]}
[0m22:27:08.701708 [info ] [Thread-3 (]: 7 of 7 OK created sql incremental model dev_silver.stg_fact_consolidated_messages  [[32mSUCCESS[0m in 1.34s]
[0m22:27:08.702498 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:27:08.919620 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.331 seconds
[0m22:27:08.923059 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: Close
[0m22:27:08.924380 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9578dde2-38c0-489b-ae07-c40a5dd134ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11249f710>]}
[0m22:27:08.925352 [info ] [Thread-2 (]: 5 of 7 OK created sql incremental model dev_gold.dim_conversation_part ......... [[32mSUCCESS[0m in 1.59s]
[0m22:27:08.926089 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:27:08.928200 [debug] [MainThread]: Using redshift connection "master"
[0m22:27:08.928636 [debug] [MainThread]: On master: BEGIN
[0m22:27:08.928980 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:27:08.929340 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:27:08.929865 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:27:09.315380 [debug] [MainThread]: SQL status: SUCCESS in 0.386 seconds
[0m22:27:09.317503 [debug] [MainThread]: On master: COMMIT
[0m22:27:09.318977 [debug] [MainThread]: Using redshift connection "master"
[0m22:27:09.319457 [debug] [MainThread]: On master: COMMIT
[0m22:27:09.366796 [debug] [MainThread]: SQL status: SUCCESS in 0.047 seconds
[0m22:27:09.368267 [debug] [MainThread]: On master: Close
[0m22:27:09.370027 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:27:09.370646 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_user' was properly closed.
[0m22:27:09.371018 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_conversation_part' was properly closed.
[0m22:27:09.371364 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages' was properly closed.
[0m22:27:09.371690 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_conversation_start' was properly closed.
[0m22:27:09.372221 [info ] [MainThread]: 
[0m22:27:09.372670 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 6.43 seconds (6.43s).
[0m22:27:09.374293 [debug] [MainThread]: Command end result
[0m22:27:09.405052 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m22:27:09.406280 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m22:27:09.410377 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/run_results.json
[0m22:27:09.410604 [info ] [MainThread]: 
[0m22:27:09.410855 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:27:09.411046 [info ] [MainThread]: 
[0m22:27:09.411243 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m22:27:09.413767 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.866482, "process_in_blocks": "0", "process_kernel_time": 0.287513, "process_mem_max_rss": "146063360", "process_out_blocks": "0", "process_user_time": 2.018379}
[0m22:27:09.414045 [debug] [MainThread]: Command `dbt run` succeeded at 22:27:09.413993 after 6.87 seconds
[0m22:27:09.414289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bc7ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d2f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cc5d50>]}
[0m22:27:09.414501 [debug] [MainThread]: Flushing usage events
[0m22:27:09.649886 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:46:09.606136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119c6a490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119851210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119cb7d90>]}


============================== 22:46:09.609117 | 759ee4de-61b6-4292-850a-bdda1cce4c9d ==============================
[0m22:46:09.609117 [info ] [MainThread]: Running with dbt=1.10.0-b2
[0m22:46:09.609490 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/henk/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:46:09.694956 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m22:46:09.695292 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m22:46:09.789407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '759ee4de-61b6-4292-850a-bdda1cce4c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a9c9150>]}
[0m22:46:09.813867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '759ee4de-61b6-4292-850a-bdda1cce4c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050f4950>]}
[0m22:46:09.814671 [info ] [MainThread]: Registered adapter: redshift=1.9.3
[0m22:46:09.879928 [debug] [MainThread]: checksum: 5a225a3ea19c91174578d2c3f7f3bd92801a2649697bdcbd194e936bd8925adb, vars: {}, profile: , target: , version: 1.10.0b2
[0m22:46:09.938401 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:46:09.938797 [debug] [MainThread]: Partial parsing: added file: dbt_thrive1_redshift_dw://models/gold/facts/fact_consolidated_messages.sql
[0m22:46:10.042317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '759ee4de-61b6-4292-850a-bdda1cce4c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11affe6d0>]}
[0m22:46:10.102365 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m22:46:10.103523 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m22:46:10.109331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '759ee4de-61b6-4292-850a-bdda1cce4c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b52b390>]}
[0m22:46:10.109608 [info ] [MainThread]: Found 8 models, 505 macros
[0m22:46:10.109782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '759ee4de-61b6-4292-850a-bdda1cce4c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b150910>]}
[0m22:46:10.110672 [info ] [MainThread]: 
[0m22:46:10.110839 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:46:10.110966 [info ] [MainThread]: 
[0m22:46:10.111204 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m22:46:10.113100 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev_dev_gold'
[0m22:46:10.113352 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev_dev_silver'
[0m22:46:10.121156 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_gold"
[0m22:46:10.123092 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_silver"
[0m22:46:10.123346 [debug] [ThreadPool]: On list_thrivedev_dev_gold: BEGIN
[0m22:46:10.123517 [debug] [ThreadPool]: On list_thrivedev_dev_silver: BEGIN
[0m22:46:10.123716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:46:10.123959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:46:10.124148 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:46:10.124301 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:46:10.126009 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:46:10.126199 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:46:10.606921 [debug] [ThreadPool]: SQL status: SUCCESS in 0.482 seconds
[0m22:46:10.608392 [debug] [ThreadPool]: SQL status: SUCCESS in 0.484 seconds
[0m22:46:10.609412 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_gold"
[0m22:46:10.609964 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_silver"
[0m22:46:10.610556 [debug] [ThreadPool]: On list_thrivedev_dev_gold: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_gold"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_gold'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_gold'
[0m22:46:10.611194 [debug] [ThreadPool]: On list_thrivedev_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_silver"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_silver'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_silver'
[0m22:46:10.724013 [debug] [ThreadPool]: SQL status: SUCCESS in 0.112 seconds
[0m22:46:10.724313 [debug] [ThreadPool]: SQL status: SUCCESS in 0.112 seconds
[0m22:46:10.753033 [debug] [ThreadPool]: On list_thrivedev_dev_silver: ROLLBACK
[0m22:46:10.753773 [debug] [ThreadPool]: On list_thrivedev_dev_gold: ROLLBACK
[0m22:46:10.825636 [debug] [ThreadPool]: On list_thrivedev_dev_gold: Close
[0m22:46:10.825861 [debug] [ThreadPool]: On list_thrivedev_dev_silver: Close
[0m22:46:10.830915 [debug] [MainThread]: Using redshift connection "master"
[0m22:46:10.831155 [debug] [MainThread]: On master: BEGIN
[0m22:46:10.831324 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:46:10.831481 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:46:10.831690 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:46:11.458262 [debug] [MainThread]: SQL status: SUCCESS in 0.626 seconds
[0m22:46:11.460378 [debug] [MainThread]: Using redshift connection "master"
[0m22:46:11.461402 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m22:46:11.573851 [debug] [MainThread]: SQL status: SUCCESS in 0.112 seconds
[0m22:46:11.577598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '759ee4de-61b6-4292-850a-bdda1cce4c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b336d90>]}
[0m22:46:11.578759 [debug] [MainThread]: On master: ROLLBACK
[0m22:46:11.634943 [debug] [MainThread]: On master: Close
[0m22:46:11.643579 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:46:11.644182 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:46:11.644752 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:46:11.645378 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_gold, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_part)
[0m22:46:11.645839 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_silver, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_start)
[0m22:46:11.646336 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.stg_dim_user'
[0m22:46:11.646726 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:46:11.647124 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:46:11.647520 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:46:11.652023 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:46:11.655173 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:46:11.658000 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:46:11.659261 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:46:11.659552 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:46:11.659831 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:46:11.660352 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:46:11.660827 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:46:11.661276 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:46:11.661728 [debug] [Thread-4 (]: Began running node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:46:11.662136 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:46:11.662549 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.dim_user
[0m22:46:11.662854 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:46:11.663303 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.dim_conversation_part'
[0m22:46:11.663594 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_user, now model.dbt_thrive1_redshift_dw.dim_conversation_start)
[0m22:46:11.663907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_conversation_part, now model.dbt_thrive1_redshift_dw.dim_user)
[0m22:46:11.664210 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_conversation_start, now model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages)
[0m22:46:11.664493 [debug] [Thread-4 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:46:11.664773 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:46:11.665012 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_user
[0m22:46:11.665238 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:46:11.671604 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:46:11.674206 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:46:11.676613 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:46:11.679141 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:46:11.680036 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_user
[0m22:46:11.680258 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:46:11.680468 [debug] [Thread-4 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:46:11.680650 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:46:11.681002 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_user
[0m22:46:11.681321 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:46:11.681664 [debug] [Thread-4 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:46:11.681999 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:46:11.682415 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.fact_consolidated_messages
[0m22:46:11.682690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.dim_user, now model.dbt_thrive1_redshift_dw.fact_consolidated_messages)
[0m22:46:11.682892 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.fact_consolidated_messages
[0m22:46:11.685211 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"
[0m22:46:11.685672 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.fact_consolidated_messages
[0m22:46:11.686008 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.fact_consolidated_messages
[0m22:46:11.686573 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:46:11.686737 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.fact_consolidated_messages' was properly closed.
[0m22:46:11.686881 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages' was properly closed.
[0m22:46:11.687016 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_conversation_start' was properly closed.
[0m22:46:11.687146 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_conversation_part' was properly closed.
[0m22:46:11.687825 [debug] [MainThread]: Command end result
[0m22:46:11.702225 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m22:46:11.702979 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m22:46:11.706367 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/run_results.json
[0m22:46:11.708684 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.1372714, "process_in_blocks": "0", "process_kernel_time": 0.244748, "process_mem_max_rss": "142737408", "process_out_blocks": "0", "process_user_time": 1.1903}
[0m22:46:11.708899 [debug] [MainThread]: Command `dbt compile` succeeded at 22:46:11.708857 after 2.14 seconds
[0m22:46:11.709085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119cb7910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119cb7850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119a5c610>]}
[0m22:46:11.709271 [debug] [MainThread]: Flushing usage events
[0m22:46:11.919653 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:46:15.132324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10546aad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054b7850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054b7d10>]}


============================== 22:46:15.135270 | caa2e66f-ad48-48c8-bd6d-61dabb53af33 ==============================
[0m22:46:15.135270 [info ] [MainThread]: Running with dbt=1.10.0-b2
[0m22:46:15.135673 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/henk/.dbt', 'log_path': '/Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:46:15.208326 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m22:46:15.208658 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m22:46:15.282927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'caa2e66f-ad48-48c8-bd6d-61dabb53af33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054f5550>]}
[0m22:46:15.307186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'caa2e66f-ad48-48c8-bd6d-61dabb53af33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102989550>]}
[0m22:46:15.308551 [info ] [MainThread]: Registered adapter: redshift=1.9.3
[0m22:46:15.369526 [debug] [MainThread]: checksum: 5a225a3ea19c91174578d2c3f7f3bd92801a2649697bdcbd194e936bd8925adb, vars: {}, profile: , target: , version: 1.10.0b2
[0m22:46:15.423440 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:46:15.423675 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:46:15.436193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'caa2e66f-ad48-48c8-bd6d-61dabb53af33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b9ad50>]}
[0m22:46:15.463263 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m22:46:15.464286 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m22:46:15.470282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'caa2e66f-ad48-48c8-bd6d-61dabb53af33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a97dd0>]}
[0m22:46:15.470562 [info ] [MainThread]: Found 8 models, 505 macros
[0m22:46:15.470732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'caa2e66f-ad48-48c8-bd6d-61dabb53af33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a1ad10>]}
[0m22:46:15.471636 [info ] [MainThread]: 
[0m22:46:15.471814 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:46:15.471947 [info ] [MainThread]: 
[0m22:46:15.472210 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m22:46:15.474163 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev'
[0m22:46:15.474423 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev'
[0m22:46:15.482720 [debug] [ThreadPool]: Using redshift connection "list_thrivedev"
[0m22:46:15.483887 [debug] [ThreadPool]: Using redshift connection "list_thrivedev"
[0m22:46:15.484047 [debug] [ThreadPool]: On list_thrivedev: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev"} */

    select distinct nspname from pg_namespace
[0m22:46:15.484208 [debug] [ThreadPool]: On list_thrivedev: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev"} */

    select distinct nspname from pg_namespace
[0m22:46:15.484375 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:46:15.484507 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:46:15.484678 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:46:15.484816 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:46:15.486664 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:46:15.486861 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:46:15.971950 [debug] [ThreadPool]: SQL status: SUCCESS in 0.487 seconds
[0m22:46:16.025244 [debug] [ThreadPool]: SQL status: SUCCESS in 0.541 seconds
[0m22:46:16.026879 [debug] [ThreadPool]: On list_thrivedev: Close
[0m22:46:16.027470 [debug] [ThreadPool]: On list_thrivedev: Close
[0m22:46:16.028952 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrivedev, now list_thrivedev_dev_gold)
[0m22:46:16.029311 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrivedev, now list_thrivedev_dev_silver)
[0m22:46:16.033781 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_gold"
[0m22:46:16.035958 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_silver"
[0m22:46:16.036148 [debug] [ThreadPool]: On list_thrivedev_dev_gold: BEGIN
[0m22:46:16.036327 [debug] [ThreadPool]: On list_thrivedev_dev_silver: BEGIN
[0m22:46:16.036476 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:46:16.036739 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:46:16.036994 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:46:16.037145 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:46:16.037361 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:46:16.037547 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:46:16.477528 [debug] [ThreadPool]: SQL status: SUCCESS in 0.441 seconds
[0m22:46:16.478146 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_silver"
[0m22:46:16.478544 [debug] [ThreadPool]: On list_thrivedev_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_silver"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_silver'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_silver'
[0m22:46:16.484889 [debug] [ThreadPool]: SQL status: SUCCESS in 0.448 seconds
[0m22:46:16.485237 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_gold"
[0m22:46:16.485603 [debug] [ThreadPool]: On list_thrivedev_dev_gold: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_gold"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_gold'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_gold'
[0m22:46:16.621391 [debug] [ThreadPool]: SQL status: SUCCESS in 0.142 seconds
[0m22:46:16.627623 [debug] [ThreadPool]: On list_thrivedev_dev_silver: ROLLBACK
[0m22:46:16.630643 [debug] [ThreadPool]: SQL status: SUCCESS in 0.145 seconds
[0m22:46:16.633459 [debug] [ThreadPool]: On list_thrivedev_dev_gold: ROLLBACK
[0m22:46:16.686656 [debug] [ThreadPool]: On list_thrivedev_dev_silver: Close
[0m22:46:16.689917 [debug] [ThreadPool]: On list_thrivedev_dev_gold: Close
[0m22:46:16.701678 [debug] [MainThread]: Using redshift connection "master"
[0m22:46:16.702163 [debug] [MainThread]: On master: BEGIN
[0m22:46:16.702445 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:46:16.702742 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:46:16.703173 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:46:17.267224 [debug] [MainThread]: SQL status: SUCCESS in 0.564 seconds
[0m22:46:17.268773 [debug] [MainThread]: Using redshift connection "master"
[0m22:46:17.269395 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m22:46:17.405594 [debug] [MainThread]: SQL status: SUCCESS in 0.136 seconds
[0m22:46:17.406708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'caa2e66f-ad48-48c8-bd6d-61dabb53af33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a5bb10>]}
[0m22:46:17.407188 [debug] [MainThread]: On master: ROLLBACK
[0m22:46:17.475226 [debug] [MainThread]: Using redshift connection "master"
[0m22:46:17.475558 [debug] [MainThread]: On master: BEGIN
[0m22:46:17.501250 [debug] [MainThread]: SQL status: SUCCESS in 0.025 seconds
[0m22:46:17.501736 [debug] [MainThread]: On master: COMMIT
[0m22:46:17.502244 [debug] [MainThread]: Using redshift connection "master"
[0m22:46:17.502625 [debug] [MainThread]: On master: COMMIT
[0m22:46:17.562734 [debug] [MainThread]: SQL status: SUCCESS in 0.060 seconds
[0m22:46:17.563923 [debug] [MainThread]: On master: Close
[0m22:46:17.569287 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:46:17.569601 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:46:17.569840 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:46:17.570189 [info ] [Thread-1 (]: 1 of 8 START sql incremental model dev_silver.stg_dim_conversation_part ........ [RUN]
[0m22:46:17.570494 [info ] [Thread-2 (]: 2 of 8 START sql incremental model dev_silver.stg_dim_conversation_start ....... [RUN]
[0m22:46:17.570762 [info ] [Thread-3 (]: 3 of 8 START sql incremental model dev_silver.stg_dim_user ..................... [RUN]
[0m22:46:17.571054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_gold, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_part)
[0m22:46:17.571283 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_silver, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_start)
[0m22:46:17.571534 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.stg_dim_user'
[0m22:46:17.571731 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:46:17.571943 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:46:17.572119 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:46:17.576575 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:46:17.580365 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:46:17.583465 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:46:17.584410 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:46:17.584822 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:46:17.585148 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:46:17.625335 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:46:17.629592 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:46:17.632319 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:46:17.632604 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"} */

    
  
    

  create temporary table
    "stg_dim_conversation_start__dbt_tmp224617605884"
    
    
    
  as (
    

select
    id, 
    source_type, 
    conv_dataset_email, 
    priority, 
    message, 
    created_at,
    getdate() as get_date_at
from
    dev_bronze.ext_conversation_start
  );
[0m22:46:17.632839 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"} */

    
  
    

  create temporary table
    "stg_dim_conversation_part__dbt_tmp224617603544"
    
    
    
  as (
    

select
    id, 
    conversation_id, 
    conv_dataset_email, 
    part_type, 
    message, 
    created_at,
    getdate() as get_date_at
from
    dev_bronze.ext_conversation_part
  );
[0m22:46:17.633047 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_user"} */

    
  
    

  create temporary table
    "stg_dim_user__dbt_tmp224617631095"
    
    
    
  as (
    

select
    id,
    name,
    email,
    is_customer,
    getdate() as get_date_at
from
    dev_bronze.ext_users
  );
[0m22:46:17.633240 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:46:17.633411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:46:17.633560 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:46:17.633734 [debug] [Thread-2 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:46:17.633897 [debug] [Thread-1 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:46:17.634057 [debug] [Thread-3 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:46:17.634317 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:46:17.634533 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:46:17.634740 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:46:19.399325 [debug] [Thread-3 (]: SQL status: SUCCESS in 1.765 seconds
[0m22:46:19.402127 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.768 seconds
[0m22:46:19.402933 [debug] [Thread-2 (]: SQL status: SUCCESS in 1.770 seconds
[0m22:46:19.421136 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:46:19.431095 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:46:19.438789 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:46:19.439110 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: BEGIN
[0m22:46:19.439365 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: BEGIN
[0m22:46:19.439598 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: BEGIN
[0m22:46:19.655400 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.214 seconds
[0m22:46:19.657672 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:46:19.659040 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_start__dbt_tmp224617605884'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_start__dbt_tmp224617605884'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'stg_dim_conversation_start__dbt_tmp224617605884'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:46:19.660288 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.220 seconds
[0m22:46:19.660919 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.221 seconds
[0m22:46:19.661427 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:46:19.661887 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:46:19.662618 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_user__dbt_tmp224617631095'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_user__dbt_tmp224617631095'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'stg_dim_user__dbt_tmp224617631095'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:46:19.663636 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_part__dbt_tmp224617603544'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_part__dbt_tmp224617603544'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'stg_dim_conversation_part__dbt_tmp224617603544'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:46:20.219757 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.558 seconds
[0m22:46:20.220964 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.556 seconds
[0m22:46:20.221896 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.557 seconds
[0m22:46:20.238341 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:46:20.247838 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:46:20.256902 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:46:20.257278 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_start'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_start'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_silver'
        and tablename = 'stg_dim_conversation_start'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_silver'
    
    order by ordinal_position
[0m22:46:20.257796 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_part'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_part'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_silver'
        and tablename = 'stg_dim_conversation_part'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_silver'
    
    order by ordinal_position
[0m22:46:20.258285 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_user'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_user'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_silver'
        and tablename = 'stg_dim_user'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_silver'
    
    order by ordinal_position
[0m22:46:20.661162 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.402 seconds
[0m22:46:20.684289 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:46:20.684901 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.426 seconds
[0m22:46:20.685255 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.426 seconds
[0m22:46:20.685856 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_start'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_start'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_silver'
        and tablename = 'stg_dim_conversation_start'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_silver'
    
    order by ordinal_position
[0m22:46:20.695062 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:46:20.700404 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:46:20.700756 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_part'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_part'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_silver'
        and tablename = 'stg_dim_conversation_part'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_silver'
    
    order by ordinal_position
[0m22:46:20.701132 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_user'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_user'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_silver'
        and tablename = 'stg_dim_user'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_silver'
    
    order by ordinal_position
[0m22:46:21.006636 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.305 seconds
[0m22:46:21.018587 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.317 seconds
[0m22:46:21.020714 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:46:21.020995 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.320 seconds
[0m22:46:21.021973 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:46:21.023197 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:46:21.026078 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:46:21.026429 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"} */

      
        
            
        delete from "thrivedev"."dev_silver"."stg_dim_conversation_part"
    where (id) in (
        select distinct id
        from "stg_dim_conversation_part__dbt_tmp224617603544" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:46:21.028307 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:46:21.029653 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:46:21.029963 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"} */

      
        
            
        delete from "thrivedev"."dev_silver"."stg_dim_conversation_start"
    where (id) in (
        select distinct id
        from "stg_dim_conversation_start__dbt_tmp224617605884" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:46:21.030273 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_user"} */

      
        
            
        delete from "thrivedev"."dev_silver"."stg_dim_user"
    where (id) in (
        select distinct id
        from "stg_dim_user__dbt_tmp224617631095" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:46:21.168638 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.141 seconds
[0m22:46:21.170577 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:46:21.171220 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: insert into "thrivedev"."dev_silver"."stg_dim_conversation_part" ("id", "conversation_id", "conv_dataset_email", "part_type", "message", "created_at", "get_date_at")
        (
            select "id", "conversation_id", "conv_dataset_email", "part_type", "message", "created_at", "get_date_at"
            from "stg_dim_conversation_part__dbt_tmp224617603544"
        )
[0m22:46:21.232676 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.202 seconds
[0m22:46:21.234393 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.203 seconds
[0m22:46:21.235414 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:46:21.236168 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:46:21.236828 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: insert into "thrivedev"."dev_silver"."stg_dim_conversation_start" ("id", "source_type", "conv_dataset_email", "priority", "message", "created_at", "get_date_at")
        (
            select "id", "source_type", "conv_dataset_email", "priority", "message", "created_at", "get_date_at"
            from "stg_dim_conversation_start__dbt_tmp224617605884"
        )
[0m22:46:21.237561 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: insert into "thrivedev"."dev_silver"."stg_dim_user" ("id", "name", "email", "is_customer", "get_date_at")
        (
            select "id", "name", "email", "is_customer", "get_date_at"
            from "stg_dim_user__dbt_tmp224617631095"
        )
[0m22:46:21.299453 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.127 seconds
[0m22:46:21.314769 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: COMMIT
[0m22:46:21.315092 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:46:21.315285 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: COMMIT
[0m22:46:21.383228 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.145 seconds
[0m22:46:21.387211 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: COMMIT
[0m22:46:21.387810 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:46:21.388136 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: COMMIT
[0m22:46:21.390571 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.152 seconds
[0m22:46:21.392039 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: COMMIT
[0m22:46:21.392529 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:46:21.392905 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: COMMIT
[0m22:46:21.429901 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.114 seconds
[0m22:46:21.432141 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: Close
[0m22:46:21.435754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caa2e66f-ad48-48c8-bd6d-61dabb53af33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111133010>]}
[0m22:46:21.436507 [info ] [Thread-1 (]: 1 of 8 OK created sql incremental model dev_silver.stg_dim_conversation_part ... [[32mSUCCESS[0m in 3.86s]
[0m22:46:21.437100 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:46:21.437752 [debug] [Thread-4 (]: Began running node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:46:21.438298 [info ] [Thread-4 (]: 4 of 8 START sql incremental model dev_gold.dim_conversation_part .............. [RUN]
[0m22:46:21.438857 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.dim_conversation_part'
[0m22:46:21.439230 [debug] [Thread-4 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:46:21.446838 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:46:21.447675 [debug] [Thread-4 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:46:21.451608 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:46:21.451887 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_part"} */

    
  
    

  create temporary table
    "dim_conversation_part__dbt_tmp224621449968"
    
    
    
  as (
    

select
    id as part_id,
    conversation_id,
    conv_dataset_email,
    part_type,
    message,
    created_at,
    get_date_at
from
    "thrivedev"."dev_silver"."stg_dim_conversation_part"



    where get_date_at > (select max(get_date_at) from "thrivedev"."dev_gold"."dim_conversation_part")

  );
[0m22:46:21.452070 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:46:21.452238 [debug] [Thread-4 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:46:21.452476 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:46:21.513195 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.120 seconds
[0m22:46:21.513788 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: Close
[0m22:46:21.514052 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.126 seconds
[0m22:46:21.514581 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caa2e66f-ad48-48c8-bd6d-61dabb53af33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cce110>]}
[0m22:46:21.515033 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: Close
[0m22:46:21.515446 [info ] [Thread-2 (]: 2 of 8 OK created sql incremental model dev_silver.stg_dim_conversation_start .. [[32mSUCCESS[0m in 3.94s]
[0m22:46:21.515950 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:46:21.516266 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caa2e66f-ad48-48c8-bd6d-61dabb53af33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11113c110>]}
[0m22:46:21.516797 [info ] [Thread-3 (]: 3 of 8 OK created sql incremental model dev_silver.stg_dim_user ................ [[32mSUCCESS[0m in 3.94s]
[0m22:46:21.517079 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:46:21.517377 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:46:21.517666 [info ] [Thread-1 (]: 5 of 8 START sql incremental model dev_gold.dim_conversation_start ............. [RUN]
[0m22:46:21.518069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_conversation_part, now model.dbt_thrive1_redshift_dw.dim_conversation_start)
[0m22:46:21.518295 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.dim_user
[0m22:46:21.518473 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:46:21.518647 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:46:21.518885 [info ] [Thread-2 (]: 6 of 8 START sql incremental model dev_gold.dim_user ........................... [RUN]
[0m22:46:21.521486 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:46:21.521813 [info ] [Thread-3 (]: 7 of 8 START sql incremental model dev_silver.stg_fact_consolidated_messages ... [RUN]
[0m22:46:21.522181 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_conversation_start, now model.dbt_thrive1_redshift_dw.dim_user)
[0m22:46:21.522526 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_user, now model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages)
[0m22:46:21.522757 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_user
[0m22:46:21.523007 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:46:21.525389 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:46:21.525653 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:46:21.527984 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:46:21.530932 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:46:21.531336 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_start"} */

    
  
    

  create temporary table
    "dim_conversation_start__dbt_tmp224621529472"
    
    
    
  as (
    

select
    id, 
    source_type, 
    conv_dataset_email, 
    priority, 
    message, 
    created_at,
    get_date_at
from
    "thrivedev"."dev_silver"."stg_dim_conversation_start"


    where get_date_at > (select max(get_date_at) from "thrivedev"."dev_gold"."dim_conversation_start")

  );
[0m22:46:21.531608 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_user
[0m22:46:21.531809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:46:21.535601 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:46:21.535812 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:46:21.536054 [debug] [Thread-1 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:46:21.536271 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_user"} */

    
  
    

  create temporary table
    "dim_user__dbt_tmp224621533271"
    
    
    
  as (
    

select
    id as user_id,
    name,
    email,
    is_customer,
    get_date_at
from
    "thrivedev"."dev_silver"."stg_dim_user"


    where get_date_at > (select max(get_date_at) from "thrivedev"."dev_gold"."dim_user")

  );
[0m22:46:21.540200 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:46:21.540471 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:46:21.540647 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:46:21.540874 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"} */

    
  
    

  create temporary table
    "stg_fact_consolidated_messages__dbt_tmp224621537563"
    
    
    
  as (
    


WITH
  start_msgs AS (
    SELECT
      id           AS msg_id,
      conv_dataset_email AS email,
      id           AS conversation_id,
      message,
      'open'       AS message_type,
      created_at
    FROM 
        "thrivedev"."dev_silver"."stg_dim_conversation_start"
  ),
  part_msgs AS (
    SELECT
      id           AS msg_id,
      conv_dataset_email AS email,
      conversation_id,
      message,
      part_type    AS message_type,
      created_at
    FROM 
        "thrivedev"."dev_silver"."stg_dim_conversation_part"
  ),
  all_msgs AS (
    SELECT * FROM start_msgs
    UNION ALL
    SELECT * FROM part_msgs
  ),
  conv_customer AS (
    SELECT
      am.conversation_id,
      u.id AS user_id
    FROM all_msgs am
    INNER JOIN "thrivedev"."dev_silver"."stg_dim_user" u
      ON am.email = u.email
    WHERE u.is_customer = 1
    GROUP BY user_id, am.conversation_id
  )
SELECT
  am.msg_id      AS id,
  cc.user_id     AS user_id,
  am.email       AS email,
  am.conversation_id,
  am.message,
  am.message_type,
  am.created_at
FROM all_msgs am
INNER JOIN conv_customer cc
  ON am.conversation_id = cc.conversation_id
ORDER BY
  am.conversation_id,
  am.created_at
  );
[0m22:46:21.541786 [debug] [Thread-2 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:46:21.542286 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:46:21.542503 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:46:21.543482 [debug] [Thread-3 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:46:21.546285 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:46:22.005895 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.553 seconds
[0m22:46:22.022004 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:46:22.022669 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: BEGIN
[0m22:46:22.093662 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.070 seconds
[0m22:46:22.095300 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:46:22.096529 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_part__dbt_tmp224621449968'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_part__dbt_tmp224621449968'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'dim_conversation_part__dbt_tmp224621449968'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:46:22.301891 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.770 seconds
[0m22:46:22.315176 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:46:22.315689 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: BEGIN
[0m22:46:22.421049 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.880 seconds
[0m22:46:22.429550 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:46:22.429829 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_user: BEGIN
[0m22:46:22.545402 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.448 seconds
[0m22:46:22.558742 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:46:22.559399 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_part'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_part'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_gold'
        and tablename = 'dim_conversation_part'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_gold'
    
    order by ordinal_position
[0m22:46:22.568287 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.252 seconds
[0m22:46:22.568658 [debug] [Thread-3 (]: SQL status: SUCCESS in 1.026 seconds
[0m22:46:22.569033 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:46:22.578703 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:46:22.579035 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.149 seconds
[0m22:46:22.579515 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_start__dbt_tmp224621529472'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_start__dbt_tmp224621529472'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'dim_conversation_start__dbt_tmp224621529472'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:46:22.579967 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: BEGIN
[0m22:46:22.580229 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:46:22.580920 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_user__dbt_tmp224621533271'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_user__dbt_tmp224621533271'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'dim_user__dbt_tmp224621533271'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:46:22.798499 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.217 seconds
[0m22:46:22.800114 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:46:22.801081 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_fact_consolidated_messages__dbt_tmp224621537563'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_fact_consolidated_messages__dbt_tmp224621537563'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'stg_fact_consolidated_messages__dbt_tmp224621537563'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:46:23.021111 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.460 seconds
[0m22:46:23.039387 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:46:23.040176 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_part'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_part'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_gold'
        and tablename = 'dim_conversation_part'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_gold'
    
    order by ordinal_position
[0m22:46:23.199650 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.619 seconds
[0m22:46:23.213946 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:46:23.214336 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_start'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_start'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_gold'
        and tablename = 'dim_conversation_start'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_gold'
    
    order by ordinal_position
[0m22:46:23.365548 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.783 seconds
[0m22:46:23.381918 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:46:23.382704 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_user'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_user'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_gold'
        and tablename = 'dim_user'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_gold'
    
    order by ordinal_position
[0m22:46:23.397945 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.357 seconds
[0m22:46:23.400179 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:46:23.403804 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:46:23.404170 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_part"} */

      
        
            
        delete from "thrivedev"."dev_gold"."dim_conversation_part"
    where (part_id) in (
        select distinct part_id
        from "dim_conversation_part__dbt_tmp224621449968" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:46:23.438653 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.637 seconds
[0m22:46:23.450928 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:46:23.451425 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_fact_consolidated_messages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_fact_consolidated_messages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_silver'
        and tablename = 'stg_fact_consolidated_messages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_silver'
    
    order by ordinal_position
[0m22:46:23.528164 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.123 seconds
[0m22:46:23.529463 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:46:23.530041 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: insert into "thrivedev"."dev_gold"."dim_conversation_part" ("part_id", "conversation_id", "conv_dataset_email", "part_type", "message", "created_at", "get_date_at")
        (
            select "part_id", "conversation_id", "conv_dataset_email", "part_type", "message", "created_at", "get_date_at"
            from "dim_conversation_part__dbt_tmp224621449968"
        )
[0m22:46:23.575282 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.360 seconds
[0m22:46:23.591014 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:46:23.591607 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_start'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_start'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_gold'
        and tablename = 'dim_conversation_start'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_gold'
    
    order by ordinal_position
[0m22:46:23.673507 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.143 seconds
[0m22:46:23.676947 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: COMMIT
[0m22:46:23.677869 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:46:23.678407 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: COMMIT
[0m22:46:23.807407 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.128 seconds
[0m22:46:23.809783 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: Close
[0m22:46:23.810939 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caa2e66f-ad48-48c8-bd6d-61dabb53af33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107605b10>]}
[0m22:46:23.811567 [info ] [Thread-4 (]: 4 of 8 OK created sql incremental model dev_gold.dim_conversation_part ......... [[32mSUCCESS[0m in 2.37s]
[0m22:46:23.811994 [debug] [Thread-4 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:46:23.818399 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.435 seconds
[0m22:46:23.832005 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:46:23.832566 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_user'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_user'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_gold'
        and tablename = 'dim_user'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_gold'
    
    order by ordinal_position
[0m22:46:23.953499 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.501 seconds
[0m22:46:23.955385 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.363 seconds
[0m22:46:23.970835 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:46:23.972961 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:46:23.973585 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_fact_consolidated_messages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_fact_consolidated_messages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_silver'
        and tablename = 'stg_fact_consolidated_messages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_silver'
    
    order by ordinal_position
[0m22:46:23.976024 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:46:23.976345 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_start"} */

      
        
            
        delete from "thrivedev"."dev_gold"."dim_conversation_start"
    where (id) in (
        select distinct id
        from "dim_conversation_start__dbt_tmp224621529472" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:46:24.047848 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.214 seconds
[0m22:46:24.051914 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:46:24.054655 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:46:24.055166 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_user"} */

      
        
            
        delete from "thrivedev"."dev_gold"."dim_user"
    where (user_id) in (
        select distinct user_id
        from "dim_user__dbt_tmp224621533271" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:46:24.094728 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.118 seconds
[0m22:46:24.097469 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:46:24.098382 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: insert into "thrivedev"."dev_gold"."dim_conversation_start" ("id", "source_type", "conv_dataset_email", "priority", "message", "created_at", "get_date_at")
        (
            select "id", "source_type", "conv_dataset_email", "priority", "message", "created_at", "get_date_at"
            from "dim_conversation_start__dbt_tmp224621529472"
        )
[0m22:46:24.179850 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.124 seconds
[0m22:46:24.181510 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:46:24.182767 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_user: insert into "thrivedev"."dev_gold"."dim_user" ("user_id", "name", "email", "is_customer", "get_date_at")
        (
            select "user_id", "name", "email", "is_customer", "get_date_at"
            from "dim_user__dbt_tmp224621533271"
        )
[0m22:46:24.197233 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.223 seconds
[0m22:46:24.202018 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:46:24.205981 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:46:24.206431 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"} */

      
        
            
        delete from "thrivedev"."dev_silver"."stg_fact_consolidated_messages"
    where (id) in (
        select distinct id
        from "stg_fact_consolidated_messages__dbt_tmp224621537563" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:46:24.219969 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.121 seconds
[0m22:46:24.221758 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: COMMIT
[0m22:46:24.222221 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:46:24.222570 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: COMMIT
[0m22:46:24.351611 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.129 seconds
[0m22:46:24.353330 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: Close
[0m22:46:24.354811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caa2e66f-ad48-48c8-bd6d-61dabb53af33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111ee510>]}
[0m22:46:24.355701 [info ] [Thread-1 (]: 5 of 8 OK created sql incremental model dev_gold.dim_conversation_start ........ [[32mSUCCESS[0m in 2.84s]
[0m22:46:24.356319 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:46:24.360146 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.176 seconds
[0m22:46:24.362042 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_user: COMMIT
[0m22:46:24.362608 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.156 seconds
[0m22:46:24.363274 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:46:24.363776 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:46:24.364192 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_user: COMMIT
[0m22:46:24.364553 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: insert into "thrivedev"."dev_silver"."stg_fact_consolidated_messages" ("id", "user_id", "email", "conversation_id", "message", "message_type", "created_at")
        (
            select "id", "user_id", "email", "conversation_id", "message", "message_type", "created_at"
            from "stg_fact_consolidated_messages__dbt_tmp224621537563"
        )
[0m22:46:24.476294 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.111 seconds
[0m22:46:24.480136 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_user: Close
[0m22:46:24.481859 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caa2e66f-ad48-48c8-bd6d-61dabb53af33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111130e10>]}
[0m22:46:24.482938 [info ] [Thread-2 (]: 6 of 8 OK created sql incremental model dev_gold.dim_user ...................... [[32mSUCCESS[0m in 2.96s]
[0m22:46:24.483759 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_user
[0m22:46:24.484614 [debug] [Thread-4 (]: Began running node model.dbt_thrive1_redshift_dw.fact_consolidated_messages
[0m22:46:24.485231 [info ] [Thread-4 (]: 8 of 8 START sql view model dev_gold.fact_consolidated_messages ................ [RUN]
[0m22:46:24.485719 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.dim_conversation_part, now model.dbt_thrive1_redshift_dw.fact_consolidated_messages)
[0m22:46:24.486104 [debug] [Thread-4 (]: Began compiling node model.dbt_thrive1_redshift_dw.fact_consolidated_messages
[0m22:46:24.491961 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"
[0m22:46:24.492661 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.127 seconds
[0m22:46:24.494301 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: COMMIT
[0m22:46:24.494846 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:46:24.495270 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: COMMIT
[0m22:46:24.495641 [debug] [Thread-4 (]: Began executing node model.dbt_thrive1_redshift_dw.fact_consolidated_messages
[0m22:46:24.512017 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"
[0m22:46:24.517024 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"
[0m22:46:24.517321 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.fact_consolidated_messages: BEGIN
[0m22:46:24.517546 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:46:24.517799 [debug] [Thread-4 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:46:24.518169 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:46:24.602112 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.106 seconds
[0m22:46:24.602668 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: Close
[0m22:46:24.603126 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caa2e66f-ad48-48c8-bd6d-61dabb53af33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11181aed0>]}
[0m22:46:24.603516 [info ] [Thread-3 (]: 7 of 8 OK created sql incremental model dev_silver.stg_fact_consolidated_messages  [[32mSUCCESS[0m in 3.08s]
[0m22:46:24.603831 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:46:24.937418 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.419 seconds
[0m22:46:24.939593 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"
[0m22:46:24.940814 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"} */


  create view "thrivedev"."dev_gold"."fact_consolidated_messages__dbt_tmp" as (
    

WITH
  start_msgs AS (
    SELECT
      id           AS msg_id,
      conv_dataset_email AS email,
      id           AS conversation_id,
      message,
      'open'       AS message_type,
      created_at
    FROM 
        "thrivedev"."dev_gold"."dim_conversation_start"
  ),
  part_msgs AS (
    SELECT
      id           AS msg_id,
      conv_dataset_email AS email,
      conversation_id,
      message,
      part_type    AS message_type,
      created_at
    FROM 
        "thrivedev"."dev_gold"."dim_conversation_part"
  ),
  all_msgs AS (
    SELECT * FROM start_msgs
    UNION ALL
    SELECT * FROM part_msgs
  ),
  conv_customer AS (
    SELECT
      am.conversation_id,
      u.id AS user_id
    FROM all_msgs am
    INNER JOIN "thrivedev"."dev_gold"."dim_user" u
      ON am.email = u.email
    WHERE u.is_customer = 1
    GROUP BY user_id, am.conversation_id
  )
SELECT
  am.msg_id      AS id,
  cc.user_id     AS user_id,
  am.email       AS email,
  am.conversation_id,
  am.message,
  am.message_type,
  am.created_at
FROM all_msgs am
INNER JOIN conv_customer cc
  ON am.conversation_id = cc.conversation_id
ORDER BY
  am.conversation_id,
  am.created_at
  ) ;
[0m22:46:24.980089 [debug] [Thread-4 (]: Redshift adapter: Redshift error: column "id" does not exist in dim_conversation_part
[0m22:46:24.981716 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.fact_consolidated_messages: ROLLBACK
[0m22:46:25.041472 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.fact_consolidated_messages: Close
[0m22:46:25.053134 [debug] [Thread-4 (]: Database Error in model fact_consolidated_messages (models/gold/facts/fact_consolidated_messages.sql)
  column "id" does not exist in dim_conversation_part
  compiled code at target/run/dbt_thrive1_redshift_dw/models/gold/facts/fact_consolidated_messages.sql
[0m22:46:25.054039 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caa2e66f-ad48-48c8-bd6d-61dabb53af33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111143c10>]}
[0m22:46:25.054934 [error] [Thread-4 (]: 8 of 8 ERROR creating sql view model dev_gold.fact_consolidated_messages ....... [[31mERROR[0m in 0.57s]
[0m22:46:25.055578 [debug] [Thread-4 (]: Finished running node model.dbt_thrive1_redshift_dw.fact_consolidated_messages
[0m22:46:25.056192 [debug] [Thread-7 (]: Marking all children of 'model.dbt_thrive1_redshift_dw.fact_consolidated_messages' to be skipped because of status 'error'.  Reason: Database Error in model fact_consolidated_messages (models/gold/facts/fact_consolidated_messages.sql)
  column "id" does not exist in dim_conversation_part
  compiled code at target/run/dbt_thrive1_redshift_dw/models/gold/facts/fact_consolidated_messages.sql.
[0m22:46:25.058689 [debug] [MainThread]: Using redshift connection "master"
[0m22:46:25.059013 [debug] [MainThread]: On master: BEGIN
[0m22:46:25.059272 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:46:25.059553 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:46:25.059998 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:46:25.422280 [debug] [MainThread]: SQL status: SUCCESS in 0.362 seconds
[0m22:46:25.424372 [debug] [MainThread]: On master: COMMIT
[0m22:46:25.425654 [debug] [MainThread]: Using redshift connection "master"
[0m22:46:25.426318 [debug] [MainThread]: On master: COMMIT
[0m22:46:25.487043 [debug] [MainThread]: SQL status: SUCCESS in 0.060 seconds
[0m22:46:25.488515 [debug] [MainThread]: On master: Close
[0m22:46:25.490067 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:46:25.490697 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_conversation_start' was properly closed.
[0m22:46:25.491716 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_user' was properly closed.
[0m22:46:25.492259 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages' was properly closed.
[0m22:46:25.492620 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.fact_consolidated_messages' was properly closed.
[0m22:46:25.493205 [info ] [MainThread]: 
[0m22:46:25.493715 [info ] [MainThread]: Finished running 7 incremental models, 1 view model in 0 hours 0 minutes and 10.02 seconds (10.02s).
[0m22:46:25.495603 [debug] [MainThread]: Command end result
[0m22:46:25.522445 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m22:46:25.524182 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m22:46:25.528891 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/run_results.json
[0m22:46:25.529129 [info ] [MainThread]: 
[0m22:46:25.529381 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:46:25.529573 [info ] [MainThread]: 
[0m22:46:25.529823 [error] [MainThread]: [31mFailure in model fact_consolidated_messages (models/gold/facts/fact_consolidated_messages.sql)[0m
[0m22:46:25.530055 [error] [MainThread]:   Database Error in model fact_consolidated_messages (models/gold/facts/fact_consolidated_messages.sql)
  column "id" does not exist in dim_conversation_part
  compiled code at target/run/dbt_thrive1_redshift_dw/models/gold/facts/fact_consolidated_messages.sql
[0m22:46:25.530226 [info ] [MainThread]: 
[0m22:46:25.530432 [info ] [MainThread]:   compiled code at target/compiled/dbt_thrive1_redshift_dw/models/gold/facts/fact_consolidated_messages.sql
[0m22:46:25.530601 [info ] [MainThread]: 
[0m22:46:25.530790 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=8
[0m22:46:25.533529 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 10.439707, "process_in_blocks": "0", "process_kernel_time": 0.276795, "process_mem_max_rss": "148144128", "process_out_blocks": "0", "process_user_time": 2.250343}
[0m22:46:25.533791 [debug] [MainThread]: Command `dbt run` failed at 22:46:25.533738 after 10.44 seconds
[0m22:46:25.534022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054b4350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d26950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111138850>]}
[0m22:46:25.534229 [debug] [MainThread]: Flushing usage events
[0m22:46:25.755622 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:47:45.890593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e6a710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eb7210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eb7810>]}


============================== 22:47:45.893987 | 82577f2e-8c7e-4303-859a-8b061f95fc82 ==============================
[0m22:47:45.893987 [info ] [MainThread]: Running with dbt=1.10.0-b2
[0m22:47:45.894504 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/logs', 'debug': 'False', 'profiles_dir': '/Users/henk/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:47:45.979150 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m22:47:45.979471 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m22:47:46.071189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82577f2e-8c7e-4303-859a-8b061f95fc82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ecfd10>]}
[0m22:47:46.096721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82577f2e-8c7e-4303-859a-8b061f95fc82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1020fcb50>]}
[0m22:47:46.097576 [info ] [MainThread]: Registered adapter: redshift=1.9.3
[0m22:47:46.158885 [debug] [MainThread]: checksum: 5a225a3ea19c91174578d2c3f7f3bd92801a2649697bdcbd194e936bd8925adb, vars: {}, profile: , target: , version: 1.10.0b2
[0m22:47:46.216324 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:47:46.216683 [debug] [MainThread]: Partial parsing: updated file: dbt_thrive1_redshift_dw://models/gold/facts/fact_consolidated_messages.sql
[0m22:47:46.321486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82577f2e-8c7e-4303-859a-8b061f95fc82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e51050>]}
[0m22:47:46.383593 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m22:47:46.385059 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m22:47:46.391246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82577f2e-8c7e-4303-859a-8b061f95fc82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c5c4d0>]}
[0m22:47:46.391519 [info ] [MainThread]: Found 8 models, 505 macros
[0m22:47:46.391697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82577f2e-8c7e-4303-859a-8b061f95fc82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ca5e10>]}
[0m22:47:46.392680 [info ] [MainThread]: 
[0m22:47:46.392873 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:47:46.393013 [info ] [MainThread]: 
[0m22:47:46.393259 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m22:47:46.395272 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev_dev_gold'
[0m22:47:46.395509 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev_dev_silver'
[0m22:47:46.403591 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_gold"
[0m22:47:46.405627 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_silver"
[0m22:47:46.405844 [debug] [ThreadPool]: On list_thrivedev_dev_gold: BEGIN
[0m22:47:46.406017 [debug] [ThreadPool]: On list_thrivedev_dev_silver: BEGIN
[0m22:47:46.406171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:47:46.406307 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:47:46.406563 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:47:46.406852 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:47:46.408645 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:47:46.408855 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:47:46.851950 [debug] [ThreadPool]: SQL status: SUCCESS in 0.445 seconds
[0m22:47:46.854627 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_gold"
[0m22:47:46.855763 [debug] [ThreadPool]: On list_thrivedev_dev_gold: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_gold"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_gold'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_gold'
[0m22:47:46.861004 [debug] [ThreadPool]: SQL status: SUCCESS in 0.455 seconds
[0m22:47:46.861724 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_silver"
[0m22:47:46.862236 [debug] [ThreadPool]: On list_thrivedev_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_silver"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_silver'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_silver'
[0m22:47:46.959028 [debug] [ThreadPool]: SQL status: SUCCESS in 0.096 seconds
[0m22:47:46.959425 [debug] [ThreadPool]: SQL status: SUCCESS in 0.103 seconds
[0m22:47:46.991806 [debug] [ThreadPool]: On list_thrivedev_dev_silver: ROLLBACK
[0m22:47:46.992499 [debug] [ThreadPool]: On list_thrivedev_dev_gold: ROLLBACK
[0m22:47:47.050297 [debug] [ThreadPool]: On list_thrivedev_dev_gold: Close
[0m22:47:47.050513 [debug] [ThreadPool]: On list_thrivedev_dev_silver: Close
[0m22:47:47.057065 [debug] [MainThread]: Using redshift connection "master"
[0m22:47:47.057327 [debug] [MainThread]: On master: BEGIN
[0m22:47:47.057517 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:47:47.057717 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:47:47.057984 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:47:47.451131 [debug] [MainThread]: SQL status: SUCCESS in 0.393 seconds
[0m22:47:47.453390 [debug] [MainThread]: Using redshift connection "master"
[0m22:47:47.454481 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m22:47:47.558470 [debug] [MainThread]: SQL status: SUCCESS in 0.103 seconds
[0m22:47:47.563297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82577f2e-8c7e-4303-859a-8b061f95fc82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e8aa50>]}
[0m22:47:47.564553 [debug] [MainThread]: On master: ROLLBACK
[0m22:47:47.626969 [debug] [MainThread]: On master: Close
[0m22:47:47.633106 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:47:47.633662 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:47:47.634153 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:47:47.634736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_gold, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_part)
[0m22:47:47.635182 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_silver, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_start)
[0m22:47:47.635709 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.stg_dim_user'
[0m22:47:47.636109 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:47:47.636505 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:47:47.636874 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:47:47.641327 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:47:47.644416 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:47:47.647260 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:47:47.648553 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:47:47.648848 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:47:47.649464 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:47:47.649719 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:47:47.650187 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:47:47.650681 [debug] [Thread-4 (]: Began running node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:47:47.651173 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:47:47.651600 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.dim_user
[0m22:47:47.651974 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.dim_conversation_start'
[0m22:47:47.652587 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:47:47.652877 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_conversation_start, now model.dbt_thrive1_redshift_dw.dim_user)
[0m22:47:47.653137 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:47:47.653405 [debug] [Thread-4 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:47:47.653741 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_user, now model.dbt_thrive1_redshift_dw.dim_conversation_part)
[0m22:47:47.654086 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_user
[0m22:47:47.654386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_conversation_part, now model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages)
[0m22:47:47.661335 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:47:47.661701 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:47:47.664326 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:47:47.664604 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:47:47.667227 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:47:47.669938 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:47:47.670193 [debug] [Thread-4 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:47:47.670463 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_user
[0m22:47:47.670889 [debug] [Thread-4 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:47:47.671073 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:47:47.671398 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_user
[0m22:47:47.671638 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:47:47.671977 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:47:47.672372 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:47:47.672671 [debug] [Thread-4 (]: Began running node model.dbt_thrive1_redshift_dw.fact_consolidated_messages
[0m22:47:47.672933 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.dim_conversation_start, now model.dbt_thrive1_redshift_dw.fact_consolidated_messages)
[0m22:47:47.673133 [debug] [Thread-4 (]: Began compiling node model.dbt_thrive1_redshift_dw.fact_consolidated_messages
[0m22:47:47.675462 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"
[0m22:47:47.675828 [debug] [Thread-4 (]: Began executing node model.dbt_thrive1_redshift_dw.fact_consolidated_messages
[0m22:47:47.676164 [debug] [Thread-4 (]: Finished running node model.dbt_thrive1_redshift_dw.fact_consolidated_messages
[0m22:47:47.676723 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:47:47.676889 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages' was properly closed.
[0m22:47:47.677035 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_user' was properly closed.
[0m22:47:47.677172 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_conversation_part' was properly closed.
[0m22:47:47.677304 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.fact_consolidated_messages' was properly closed.
[0m22:47:47.677984 [debug] [MainThread]: Command end result
[0m22:47:47.692369 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m22:47:47.693380 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m22:47:47.697022 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/run_results.json
[0m22:47:47.699288 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.8492876, "process_in_blocks": "0", "process_kernel_time": 0.250397, "process_mem_max_rss": "143097856", "process_out_blocks": "0", "process_user_time": 1.235793}
[0m22:47:47.699521 [debug] [MainThread]: Command `dbt compile` succeeded at 22:47:47.699476 after 1.85 seconds
[0m22:47:47.699728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eb73d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eb7b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102479910>]}
[0m22:47:47.699925 [debug] [MainThread]: Flushing usage events
[0m22:47:47.887462 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:47:51.805835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fd9690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10502cf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10502d210>]}


============================== 22:47:51.808314 | 8f273a67-3531-445d-bb95-c0ff45c73395 ==============================
[0m22:47:51.808314 [info ] [MainThread]: Running with dbt=1.10.0-b2
[0m22:47:51.808687 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/henk/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:47:51.866918 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m22:47:51.867285 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m22:47:51.943885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f273a67-3531-445d-bb95-c0ff45c73395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f114d0>]}
[0m22:47:51.968021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f273a67-3531-445d-bb95-c0ff45c73395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028042d0>]}
[0m22:47:51.969392 [info ] [MainThread]: Registered adapter: redshift=1.9.3
[0m22:47:52.030800 [debug] [MainThread]: checksum: 5a225a3ea19c91174578d2c3f7f3bd92801a2649697bdcbd194e936bd8925adb, vars: {}, profile: , target: , version: 1.10.0b2
[0m22:47:52.081520 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:47:52.081719 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:47:52.093820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f273a67-3531-445d-bb95-c0ff45c73395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11004f090>]}
[0m22:47:52.120395 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m22:47:52.121510 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m22:47:52.127870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f273a67-3531-445d-bb95-c0ff45c73395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107693f90>]}
[0m22:47:52.128157 [info ] [MainThread]: Found 8 models, 505 macros
[0m22:47:52.128330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f273a67-3531-445d-bb95-c0ff45c73395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107661dd0>]}
[0m22:47:52.129252 [info ] [MainThread]: 
[0m22:47:52.129432 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:47:52.129559 [info ] [MainThread]: 
[0m22:47:52.129803 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m22:47:52.131805 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev'
[0m22:47:52.132072 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev'
[0m22:47:52.140852 [debug] [ThreadPool]: Using redshift connection "list_thrivedev"
[0m22:47:52.142189 [debug] [ThreadPool]: Using redshift connection "list_thrivedev"
[0m22:47:52.142374 [debug] [ThreadPool]: On list_thrivedev: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev"} */

    select distinct nspname from pg_namespace
[0m22:47:52.142529 [debug] [ThreadPool]: On list_thrivedev: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev"} */

    select distinct nspname from pg_namespace
[0m22:47:52.142664 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:47:52.142785 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:47:52.142941 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:47:52.143070 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:47:52.145314 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:47:52.145593 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:47:52.570243 [debug] [ThreadPool]: SQL status: SUCCESS in 0.428 seconds
[0m22:47:52.629082 [debug] [ThreadPool]: SQL status: SUCCESS in 0.486 seconds
[0m22:47:52.630565 [debug] [ThreadPool]: On list_thrivedev: Close
[0m22:47:52.631124 [debug] [ThreadPool]: On list_thrivedev: Close
[0m22:47:52.632207 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrivedev, now list_thrivedev_dev_silver)
[0m22:47:52.632502 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrivedev, now list_thrivedev_dev_gold)
[0m22:47:52.636144 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_silver"
[0m22:47:52.637929 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_gold"
[0m22:47:52.638092 [debug] [ThreadPool]: On list_thrivedev_dev_silver: BEGIN
[0m22:47:52.638225 [debug] [ThreadPool]: On list_thrivedev_dev_gold: BEGIN
[0m22:47:52.638346 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:47:52.638465 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:47:52.638604 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:47:52.638751 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:47:52.639039 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:47:52.639231 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:47:53.026156 [debug] [ThreadPool]: SQL status: SUCCESS in 0.387 seconds
[0m22:47:53.028449 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_silver"
[0m22:47:53.029347 [debug] [ThreadPool]: On list_thrivedev_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_silver"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_silver'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_silver'
[0m22:47:53.055121 [debug] [ThreadPool]: SQL status: SUCCESS in 0.416 seconds
[0m22:47:53.056785 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_gold"
[0m22:47:53.058047 [debug] [ThreadPool]: On list_thrivedev_dev_gold: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_gold"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_gold'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_gold'
[0m22:47:53.109974 [debug] [ThreadPool]: SQL status: SUCCESS in 0.080 seconds
[0m22:47:53.111985 [debug] [ThreadPool]: On list_thrivedev_dev_silver: ROLLBACK
[0m22:47:53.139819 [debug] [ThreadPool]: SQL status: SUCCESS in 0.081 seconds
[0m22:47:53.141097 [debug] [ThreadPool]: On list_thrivedev_dev_gold: ROLLBACK
[0m22:47:53.250521 [debug] [ThreadPool]: On list_thrivedev_dev_silver: Close
[0m22:47:53.262551 [debug] [ThreadPool]: On list_thrivedev_dev_gold: Close
[0m22:47:53.267607 [debug] [MainThread]: Using redshift connection "master"
[0m22:47:53.267808 [debug] [MainThread]: On master: BEGIN
[0m22:47:53.267932 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:47:53.268074 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:47:53.268272 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:47:53.682975 [debug] [MainThread]: SQL status: SUCCESS in 0.414 seconds
[0m22:47:53.685991 [debug] [MainThread]: Using redshift connection "master"
[0m22:47:53.686534 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m22:47:53.808255 [debug] [MainThread]: SQL status: SUCCESS in 0.121 seconds
[0m22:47:53.810862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f273a67-3531-445d-bb95-c0ff45c73395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e9f310>]}
[0m22:47:53.811678 [debug] [MainThread]: On master: ROLLBACK
[0m22:47:53.866288 [debug] [MainThread]: Using redshift connection "master"
[0m22:47:53.867299 [debug] [MainThread]: On master: BEGIN
[0m22:47:53.895450 [debug] [MainThread]: SQL status: SUCCESS in 0.027 seconds
[0m22:47:53.896999 [debug] [MainThread]: On master: COMMIT
[0m22:47:53.899288 [debug] [MainThread]: Using redshift connection "master"
[0m22:47:53.900133 [debug] [MainThread]: On master: COMMIT
[0m22:47:53.952462 [debug] [MainThread]: SQL status: SUCCESS in 0.052 seconds
[0m22:47:53.953764 [debug] [MainThread]: On master: Close
[0m22:47:53.959532 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:47:53.960160 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:47:53.960676 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:47:53.961380 [info ] [Thread-1 (]: 1 of 8 START sql incremental model dev_silver.stg_dim_conversation_part ........ [RUN]
[0m22:47:53.961951 [info ] [Thread-2 (]: 2 of 8 START sql incremental model dev_silver.stg_dim_conversation_start ....... [RUN]
[0m22:47:53.962471 [info ] [Thread-3 (]: 3 of 8 START sql incremental model dev_silver.stg_dim_user ..................... [RUN]
[0m22:47:53.962976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_silver, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_part)
[0m22:47:53.963386 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_gold, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_start)
[0m22:47:53.963871 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.stg_dim_user'
[0m22:47:53.964250 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:47:53.964609 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:47:53.964939 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:47:53.969435 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:47:53.972890 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:47:53.975562 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:47:53.976721 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:47:53.977133 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:47:53.977461 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:47:54.029016 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:47:54.030627 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:47:54.033103 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:47:54.033349 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"} */

    
  
    

  create temporary table
    "stg_dim_conversation_start__dbt_tmp224753997748"
    
    
    
  as (
    

select
    id, 
    source_type, 
    conv_dataset_email, 
    priority, 
    message, 
    created_at,
    getdate() as get_date_at
from
    dev_bronze.ext_conversation_start
  );
[0m22:47:54.033579 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_user"} */

    
  
    

  create temporary table
    "stg_dim_user__dbt_tmp224754006387"
    
    
    
  as (
    

select
    id,
    name,
    email,
    is_customer,
    getdate() as get_date_at
from
    dev_bronze.ext_users
  );
[0m22:47:54.033816 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"} */

    
  
    

  create temporary table
    "stg_dim_conversation_part__dbt_tmp224754031936"
    
    
    
  as (
    

select
    id, 
    conversation_id, 
    conv_dataset_email, 
    part_type, 
    message, 
    created_at,
    getdate() as get_date_at
from
    dev_bronze.ext_conversation_part
  );
[0m22:47:54.034023 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:47:54.034197 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:47:54.034351 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:47:54.034521 [debug] [Thread-2 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:47:54.034683 [debug] [Thread-3 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:47:54.034839 [debug] [Thread-1 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:47:54.035091 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:47:54.035276 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:47:54.035494 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:47:55.305644 [debug] [Thread-2 (]: SQL status: SUCCESS in 1.268 seconds
[0m22:47:55.326735 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:47:55.327404 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: BEGIN
[0m22:47:55.345635 [debug] [Thread-3 (]: SQL status: SUCCESS in 1.311 seconds
[0m22:47:55.356909 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:47:55.357434 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: BEGIN
[0m22:47:55.392374 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.065 seconds
[0m22:47:55.392627 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:47:55.392891 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_start__dbt_tmp224753997748'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_start__dbt_tmp224753997748'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'stg_dim_conversation_start__dbt_tmp224753997748'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:47:55.409730 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.375 seconds
[0m22:47:55.419869 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:47:55.420331 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.063 seconds
[0m22:47:55.420616 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: BEGIN
[0m22:47:55.420899 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:47:55.421473 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_user__dbt_tmp224754006387'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_user__dbt_tmp224754006387'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'stg_dim_user__dbt_tmp224754006387'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:47:55.477018 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.056 seconds
[0m22:47:55.477521 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:47:55.478132 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_part__dbt_tmp224754031936'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_part__dbt_tmp224754031936'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'stg_dim_conversation_part__dbt_tmp224754031936'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:47:55.767931 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.374 seconds
[0m22:47:55.783157 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:47:55.783859 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_start'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_start'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_silver'
        and tablename = 'stg_dim_conversation_start'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_silver'
    
    order by ordinal_position
[0m22:47:55.856645 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.434 seconds
[0m22:47:55.868001 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:47:55.868639 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_user'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_user'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_silver'
        and tablename = 'stg_dim_user'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_silver'
    
    order by ordinal_position
[0m22:47:55.879650 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.401 seconds
[0m22:47:55.890225 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:47:55.890764 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_part'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_part'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_silver'
        and tablename = 'stg_dim_conversation_part'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_silver'
    
    order by ordinal_position
[0m22:47:56.082896 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.298 seconds
[0m22:47:56.103037 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:47:56.103806 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_start'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_start'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_silver'
        and tablename = 'stg_dim_conversation_start'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_silver'
    
    order by ordinal_position
[0m22:47:56.209502 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.340 seconds
[0m22:47:56.227691 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:47:56.228291 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_user'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_user'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_silver'
        and tablename = 'stg_dim_user'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_silver'
    
    order by ordinal_position
[0m22:47:56.241101 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.350 seconds
[0m22:47:56.251436 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:47:56.251993 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_part'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_part'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_silver'
        and tablename = 'stg_dim_conversation_part'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_silver'
    
    order by ordinal_position
[0m22:47:56.417353 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.312 seconds
[0m22:47:56.429049 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:47:56.431361 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:47:56.431733 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"} */

      
        
            
        delete from "thrivedev"."dev_silver"."stg_dim_conversation_start"
    where (id) in (
        select distinct id
        from "stg_dim_conversation_start__dbt_tmp224753997748" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:47:56.489571 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.261 seconds
[0m22:47:56.491125 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:47:56.494377 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:47:56.494744 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_user"} */

      
        
            
        delete from "thrivedev"."dev_silver"."stg_dim_user"
    where (id) in (
        select distinct id
        from "stg_dim_user__dbt_tmp224754006387" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:47:56.550130 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.118 seconds
[0m22:47:56.550566 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:47:56.550876 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: insert into "thrivedev"."dev_silver"."stg_dim_conversation_start" ("id", "source_type", "conv_dataset_email", "priority", "message", "created_at", "get_date_at")
        (
            select "id", "source_type", "conv_dataset_email", "priority", "message", "created_at", "get_date_at"
            from "stg_dim_conversation_start__dbt_tmp224753997748"
        )
[0m22:47:56.551520 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.299 seconds
[0m22:47:56.553011 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:47:56.554824 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:47:56.555140 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"} */

      
        
            
        delete from "thrivedev"."dev_silver"."stg_dim_conversation_part"
    where (id) in (
        select distinct id
        from "stg_dim_conversation_part__dbt_tmp224754031936" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:47:56.602675 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.108 seconds
[0m22:47:56.603264 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:47:56.603558 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: insert into "thrivedev"."dev_silver"."stg_dim_user" ("id", "name", "email", "is_customer", "get_date_at")
        (
            select "id", "name", "email", "is_customer", "get_date_at"
            from "stg_dim_user__dbt_tmp224754006387"
        )
[0m22:47:56.665718 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.114 seconds
[0m22:47:56.674662 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: COMMIT
[0m22:47:56.675021 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:47:56.675219 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: COMMIT
[0m22:47:56.698213 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.143 seconds
[0m22:47:56.698571 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:47:56.698833 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: insert into "thrivedev"."dev_silver"."stg_dim_conversation_part" ("id", "conversation_id", "conv_dataset_email", "part_type", "message", "created_at", "get_date_at")
        (
            select "id", "conversation_id", "conv_dataset_email", "part_type", "message", "created_at", "get_date_at"
            from "stg_dim_conversation_part__dbt_tmp224754031936"
        )
[0m22:47:56.741700 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.136 seconds
[0m22:47:56.742545 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: COMMIT
[0m22:47:56.742778 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:47:56.742928 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: COMMIT
[0m22:47:56.774877 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.099 seconds
[0m22:47:56.776047 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: Close
[0m22:47:56.777921 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f273a67-3531-445d-bb95-c0ff45c73395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d74c90>]}
[0m22:47:56.778462 [info ] [Thread-2 (]: 2 of 8 OK created sql incremental model dev_silver.stg_dim_conversation_start .. [[32mSUCCESS[0m in 2.81s]
[0m22:47:56.778862 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:47:56.779216 [debug] [Thread-4 (]: Began running node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:47:56.779519 [info ] [Thread-4 (]: 4 of 8 START sql incremental model dev_gold.dim_conversation_start ............. [RUN]
[0m22:47:56.779801 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.dim_conversation_start'
[0m22:47:56.779971 [debug] [Thread-4 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:47:56.783893 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:47:56.784319 [debug] [Thread-4 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:47:56.786607 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:47:56.786803 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_start"} */

    
  
    

  create temporary table
    "dim_conversation_start__dbt_tmp224756785458"
    
    
    
  as (
    

select
    id, 
    source_type, 
    conv_dataset_email, 
    priority, 
    message, 
    created_at,
    get_date_at
from
    "thrivedev"."dev_silver"."stg_dim_conversation_start"


    where get_date_at > (select max(get_date_at) from "thrivedev"."dev_gold"."dim_conversation_start")

  );
[0m22:47:56.786971 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:47:56.787131 [debug] [Thread-4 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:47:56.787402 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:47:56.808029 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.109 seconds
[0m22:47:56.808938 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: COMMIT
[0m22:47:56.809210 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:47:56.809380 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: COMMIT
[0m22:47:56.853304 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.110 seconds
[0m22:47:56.853798 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: Close
[0m22:47:56.854202 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f273a67-3531-445d-bb95-c0ff45c73395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d36c10>]}
[0m22:47:56.854551 [info ] [Thread-3 (]: 3 of 8 OK created sql incremental model dev_silver.stg_dim_user ................ [[32mSUCCESS[0m in 2.89s]
[0m22:47:56.854832 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:47:56.855145 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.dim_user
[0m22:47:56.855407 [info ] [Thread-2 (]: 5 of 8 START sql incremental model dev_gold.dim_user ........................... [RUN]
[0m22:47:56.855618 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_conversation_start, now model.dbt_thrive1_redshift_dw.dim_user)
[0m22:47:56.855791 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_user
[0m22:47:56.858070 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:47:56.858525 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_user
[0m22:47:56.860932 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:47:56.861122 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_user"} */

    
  
    

  create temporary table
    "dim_user__dbt_tmp224756859642"
    
    
    
  as (
    

select
    id as user_id,
    name,
    email,
    is_customer,
    get_date_at
from
    "thrivedev"."dev_silver"."stg_dim_user"


    where get_date_at > (select max(get_date_at) from "thrivedev"."dev_gold"."dim_user")

  );
[0m22:47:56.861289 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:47:56.861455 [debug] [Thread-2 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:47:56.861681 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:47:56.908466 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.099 seconds
[0m22:47:56.909104 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: Close
[0m22:47:56.909527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f273a67-3531-445d-bb95-c0ff45c73395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e6a150>]}
[0m22:47:56.909856 [info ] [Thread-1 (]: 1 of 8 OK created sql incremental model dev_silver.stg_dim_conversation_part ... [[32mSUCCESS[0m in 2.95s]
[0m22:47:56.910121 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:47:56.910499 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:47:56.910725 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:47:56.911012 [info ] [Thread-3 (]: 6 of 8 START sql incremental model dev_gold.dim_conversation_part .............. [RUN]
[0m22:47:56.911280 [info ] [Thread-1 (]: 7 of 8 START sql incremental model dev_silver.stg_fact_consolidated_messages ... [RUN]
[0m22:47:56.911529 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_user, now model.dbt_thrive1_redshift_dw.dim_conversation_part)
[0m22:47:56.911739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_conversation_part, now model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages)
[0m22:47:56.911910 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:47:56.912067 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:47:56.914191 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:47:56.916437 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:47:56.917031 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:47:56.920407 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:47:56.920687 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:47:56.920951 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_part"} */

    
  
    

  create temporary table
    "dim_conversation_part__dbt_tmp224756918342"
    
    
    
  as (
    

select
    id as part_id,
    conversation_id,
    conv_dataset_email,
    part_type,
    message,
    created_at,
    get_date_at
from
    "thrivedev"."dev_silver"."stg_dim_conversation_part"



    where get_date_at > (select max(get_date_at) from "thrivedev"."dev_gold"."dim_conversation_part")

  );
[0m22:47:56.924899 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:47:56.925190 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:47:56.925493 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"} */

    
  
    

  create temporary table
    "stg_fact_consolidated_messages__dbt_tmp224756922250"
    
    
    
  as (
    


WITH
  start_msgs AS (
    SELECT
      id           AS msg_id,
      conv_dataset_email AS email,
      id           AS conversation_id,
      message,
      'open'       AS message_type,
      created_at
    FROM 
        "thrivedev"."dev_silver"."stg_dim_conversation_start"
  ),
  part_msgs AS (
    SELECT
      id           AS msg_id,
      conv_dataset_email AS email,
      conversation_id,
      message,
      part_type    AS message_type,
      created_at
    FROM 
        "thrivedev"."dev_silver"."stg_dim_conversation_part"
  ),
  all_msgs AS (
    SELECT * FROM start_msgs
    UNION ALL
    SELECT * FROM part_msgs
  ),
  conv_customer AS (
    SELECT
      am.conversation_id,
      u.id AS user_id
    FROM all_msgs am
    INNER JOIN "thrivedev"."dev_silver"."stg_dim_user" u
      ON am.email = u.email
    WHERE u.is_customer = 1
    GROUP BY user_id, am.conversation_id
  )
SELECT
  am.msg_id      AS id,
  cc.user_id     AS user_id,
  am.email       AS email,
  am.conversation_id,
  am.message,
  am.message_type,
  am.created_at
FROM all_msgs am
INNER JOIN conv_customer cc
  ON am.conversation_id = cc.conversation_id
ORDER BY
  am.conversation_id,
  am.created_at
  );
[0m22:47:56.925758 [debug] [Thread-3 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:47:56.926017 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:47:56.926258 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:47:56.926434 [debug] [Thread-1 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:47:56.927362 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:47:57.340833 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.553 seconds
[0m22:47:57.357384 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:47:57.357998 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: BEGIN
[0m22:47:57.412688 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.054 seconds
[0m22:47:57.413835 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:47:57.415427 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_start__dbt_tmp224756785458'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_start__dbt_tmp224756785458'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'dim_conversation_start__dbt_tmp224756785458'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:47:57.562077 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.700 seconds
[0m22:47:57.576505 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:47:57.577028 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_user: BEGIN
[0m22:47:57.579876 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.655 seconds
[0m22:47:57.591475 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:47:57.591898 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: BEGIN
[0m22:47:57.636126 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.059 seconds
[0m22:47:57.636534 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:47:57.637066 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_user__dbt_tmp224756859642'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_user__dbt_tmp224756859642'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'dim_user__dbt_tmp224756859642'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:47:57.650066 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.058 seconds
[0m22:47:57.650224 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:47:57.650461 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_part__dbt_tmp224756918342'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_part__dbt_tmp224756918342'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'dim_conversation_part__dbt_tmp224756918342'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:47:57.745420 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.819 seconds
[0m22:47:57.761570 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:47:57.762143 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: BEGIN
[0m22:47:57.825065 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.062 seconds
[0m22:47:57.827241 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:47:57.828286 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_fact_consolidated_messages__dbt_tmp224756922250'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_fact_consolidated_messages__dbt_tmp224756922250'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'stg_fact_consolidated_messages__dbt_tmp224756922250'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:47:57.930431 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.514 seconds
[0m22:47:57.945397 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:47:57.946038 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_start'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_start'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_gold'
        and tablename = 'dim_conversation_start'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_gold'
    
    order by ordinal_position
[0m22:47:58.238420 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.588 seconds
[0m22:47:58.249350 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:47:58.249931 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_part'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_part'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_gold'
        and tablename = 'dim_conversation_part'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_gold'
    
    order by ordinal_position
[0m22:47:58.286255 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.649 seconds
[0m22:47:58.297463 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:47:58.297996 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_user'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_user'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_gold'
        and tablename = 'dim_user'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_gold'
    
    order by ordinal_position
[0m22:47:58.369881 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.541 seconds
[0m22:47:58.370394 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.424 seconds
[0m22:47:58.382876 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:47:58.389586 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_fact_consolidated_messages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_fact_consolidated_messages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_silver'
        and tablename = 'stg_fact_consolidated_messages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_silver'
    
    order by ordinal_position
[0m22:47:58.391403 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:47:58.391721 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_start'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_start'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_gold'
        and tablename = 'dim_conversation_start'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_gold'
    
    order by ordinal_position
[0m22:47:58.706176 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.456 seconds
[0m22:47:58.719296 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:47:58.720775 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_part'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_part'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_gold'
        and tablename = 'dim_conversation_part'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_gold'
    
    order by ordinal_position
[0m22:47:58.768540 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.470 seconds
[0m22:47:58.780113 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:47:58.780474 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.388 seconds
[0m22:47:58.781032 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_user'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_user'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_gold'
        and tablename = 'dim_user'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_gold'
    
    order by ordinal_position
[0m22:47:58.782817 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:47:58.785449 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:47:58.785743 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_start"} */

      
        
            
        delete from "thrivedev"."dev_gold"."dim_conversation_start"
    where (id) in (
        select distinct id
        from "dim_conversation_start__dbt_tmp224756785458" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:47:58.900392 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.508 seconds
[0m22:47:58.916358 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:47:58.917052 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_fact_consolidated_messages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_fact_consolidated_messages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_silver'
        and tablename = 'stg_fact_consolidated_messages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_silver'
    
    order by ordinal_position
[0m22:47:58.925038 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.139 seconds
[0m22:47:58.925410 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:47:58.925735 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: insert into "thrivedev"."dev_gold"."dim_conversation_start" ("id", "source_type", "conv_dataset_email", "priority", "message", "created_at", "get_date_at")
        (
            select "id", "source_type", "conv_dataset_email", "priority", "message", "created_at", "get_date_at"
            from "dim_conversation_start__dbt_tmp224756785458"
        )
[0m22:47:59.079402 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.358 seconds
[0m22:47:59.082236 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:47:59.082964 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.157 seconds
[0m22:47:59.084597 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: COMMIT
[0m22:47:59.085207 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:47:59.085540 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: COMMIT
[0m22:47:59.087841 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:47:59.088330 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_part"} */

      
        
            
        delete from "thrivedev"."dev_gold"."dim_conversation_part"
    where (part_id) in (
        select distinct part_id
        from "dim_conversation_part__dbt_tmp224756918342" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:47:59.239996 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.154 seconds
[0m22:47:59.240888 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: Close
[0m22:47:59.241395 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f273a67-3531-445d-bb95-c0ff45c73395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111990c50>]}
[0m22:47:59.241815 [info ] [Thread-4 (]: 4 of 8 OK created sql incremental model dev_gold.dim_conversation_start ........ [[32mSUCCESS[0m in 2.46s]
[0m22:47:59.242142 [debug] [Thread-4 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:47:59.253902 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.165 seconds
[0m22:47:59.254325 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:47:59.254619 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: insert into "thrivedev"."dev_gold"."dim_conversation_part" ("part_id", "conversation_id", "conv_dataset_email", "part_type", "message", "created_at", "get_date_at")
        (
            select "part_id", "conversation_id", "conv_dataset_email", "part_type", "message", "created_at", "get_date_at"
            from "dim_conversation_part__dbt_tmp224756918342"
        )
[0m22:47:59.254861 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.472 seconds
[0m22:47:59.256069 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:47:59.257433 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:47:59.257704 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_user"} */

      
        
            
        delete from "thrivedev"."dev_gold"."dim_user"
    where (user_id) in (
        select distinct user_id
        from "dim_user__dbt_tmp224756859642" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:47:59.266766 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.349 seconds
[0m22:47:59.267998 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:47:59.269664 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:47:59.269938 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"} */

      
        
            
        delete from "thrivedev"."dev_silver"."stg_fact_consolidated_messages"
    where (id) in (
        select distinct id
        from "stg_fact_consolidated_messages__dbt_tmp224756922250" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:47:59.385245 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.130 seconds
[0m22:47:59.386635 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: COMMIT
[0m22:47:59.387079 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:47:59.387367 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: COMMIT
[0m22:47:59.450150 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.192 seconds
[0m22:47:59.450689 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:47:59.450997 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_user: insert into "thrivedev"."dev_gold"."dim_user" ("user_id", "name", "email", "is_customer", "get_date_at")
        (
            select "user_id", "name", "email", "is_customer", "get_date_at"
            from "dim_user__dbt_tmp224756859642"
        )
[0m22:47:59.516265 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.129 seconds
[0m22:47:59.516908 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: Close
[0m22:47:59.517358 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f273a67-3531-445d-bb95-c0ff45c73395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a7d290>]}
[0m22:47:59.517776 [info ] [Thread-3 (]: 6 of 8 OK created sql incremental model dev_gold.dim_conversation_part ......... [[32mSUCCESS[0m in 2.61s]
[0m22:47:59.518098 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:47:59.528353 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.258 seconds
[0m22:47:59.528661 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:47:59.528873 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: insert into "thrivedev"."dev_silver"."stg_fact_consolidated_messages" ("id", "user_id", "email", "conversation_id", "message", "message_type", "created_at")
        (
            select "id", "user_id", "email", "conversation_id", "message", "message_type", "created_at"
            from "stg_fact_consolidated_messages__dbt_tmp224756922250"
        )
[0m22:47:59.581648 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.130 seconds
[0m22:47:59.582888 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_user: COMMIT
[0m22:47:59.583306 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:47:59.583597 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_user: COMMIT
[0m22:47:59.706709 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.122 seconds
[0m22:47:59.709593 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_user: Close
[0m22:47:59.711286 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f273a67-3531-445d-bb95-c0ff45c73395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11280d450>]}
[0m22:47:59.712338 [info ] [Thread-2 (]: 5 of 8 OK created sql incremental model dev_gold.dim_user ...................... [[32mSUCCESS[0m in 2.86s]
[0m22:47:59.713054 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_user
[0m22:47:59.713896 [debug] [Thread-4 (]: Began running node model.dbt_thrive1_redshift_dw.fact_consolidated_messages
[0m22:47:59.714500 [info ] [Thread-4 (]: 8 of 8 START sql view model dev_gold.fact_consolidated_messages ................ [RUN]
[0m22:47:59.715083 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.dim_conversation_start, now model.dbt_thrive1_redshift_dw.fact_consolidated_messages)
[0m22:47:59.715475 [debug] [Thread-4 (]: Began compiling node model.dbt_thrive1_redshift_dw.fact_consolidated_messages
[0m22:47:59.721222 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"
[0m22:47:59.721917 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.193 seconds
[0m22:47:59.723702 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: COMMIT
[0m22:47:59.724248 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:47:59.724680 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: COMMIT
[0m22:47:59.725275 [debug] [Thread-4 (]: Began executing node model.dbt_thrive1_redshift_dw.fact_consolidated_messages
[0m22:47:59.741228 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"
[0m22:47:59.745365 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"
[0m22:47:59.745622 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.fact_consolidated_messages: BEGIN
[0m22:47:59.745845 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:47:59.746075 [debug] [Thread-4 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:47:59.746381 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:47:59.871106 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.146 seconds
[0m22:47:59.871898 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: Close
[0m22:47:59.872440 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f273a67-3531-445d-bb95-c0ff45c73395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b92d90>]}
[0m22:47:59.872915 [info ] [Thread-1 (]: 7 of 8 OK created sql incremental model dev_silver.stg_fact_consolidated_messages  [[32mSUCCESS[0m in 2.96s]
[0m22:47:59.873302 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:48:00.146142 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.399 seconds
[0m22:48:00.148842 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"
[0m22:48:00.149757 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"} */


  create view "thrivedev"."dev_gold"."fact_consolidated_messages__dbt_tmp" as (
    

WITH
  start_msgs AS (
    SELECT
      id           AS msg_id,
      conv_dataset_email AS email,
      id           AS conversation_id,
      message,
      'open'       AS message_type,
      created_at
    FROM 
        "thrivedev"."dev_gold"."dim_conversation_start"
  ),
  part_msgs AS (
    SELECT
      part_id           AS msg_id,
      conv_dataset_email AS email,
      conversation_id,
      message,
      part_type    AS message_type,
      created_at
    FROM 
        "thrivedev"."dev_gold"."dim_conversation_part"
  ),
  all_msgs AS (
    SELECT * FROM start_msgs
    UNION ALL
    SELECT * FROM part_msgs
  ),
  conv_customer AS (
    SELECT
      am.conversation_id,
      u.id AS user_id
    FROM all_msgs am
    INNER JOIN "thrivedev"."dev_gold"."dim_user" u
      ON am.email = u.email
    WHERE u.is_customer = 1
    GROUP BY user_id, am.conversation_id
  )
SELECT
  am.msg_id      AS id,
  cc.user_id     AS user_id,
  am.email       AS email,
  am.conversation_id,
  am.message,
  am.message_type,
  am.created_at
FROM all_msgs am
INNER JOIN conv_customer cc
  ON am.conversation_id = cc.conversation_id
ORDER BY
  am.conversation_id,
  am.created_at
  ) ;
[0m22:48:00.189346 [debug] [Thread-4 (]: Redshift adapter: Redshift error: column u.id does not exist
[0m22:48:00.190928 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.fact_consolidated_messages: ROLLBACK
[0m22:48:00.258887 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.fact_consolidated_messages: Close
[0m22:48:00.270129 [debug] [Thread-4 (]: Database Error in model fact_consolidated_messages (models/gold/facts/fact_consolidated_messages.sql)
  column u.id does not exist
  compiled code at target/run/dbt_thrive1_redshift_dw/models/gold/facts/fact_consolidated_messages.sql
[0m22:48:00.271020 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f273a67-3531-445d-bb95-c0ff45c73395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ac9e50>]}
[0m22:48:00.271899 [error] [Thread-4 (]: 8 of 8 ERROR creating sql view model dev_gold.fact_consolidated_messages ....... [[31mERROR[0m in 0.56s]
[0m22:48:00.272600 [debug] [Thread-4 (]: Finished running node model.dbt_thrive1_redshift_dw.fact_consolidated_messages
[0m22:48:00.273216 [debug] [Thread-7 (]: Marking all children of 'model.dbt_thrive1_redshift_dw.fact_consolidated_messages' to be skipped because of status 'error'.  Reason: Database Error in model fact_consolidated_messages (models/gold/facts/fact_consolidated_messages.sql)
  column u.id does not exist
  compiled code at target/run/dbt_thrive1_redshift_dw/models/gold/facts/fact_consolidated_messages.sql.
[0m22:48:00.275796 [debug] [MainThread]: Using redshift connection "master"
[0m22:48:00.276125 [debug] [MainThread]: On master: BEGIN
[0m22:48:00.276384 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:48:00.276663 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:48:00.277144 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:48:00.662336 [debug] [MainThread]: SQL status: SUCCESS in 0.385 seconds
[0m22:48:00.664265 [debug] [MainThread]: On master: COMMIT
[0m22:48:00.665139 [debug] [MainThread]: Using redshift connection "master"
[0m22:48:00.665556 [debug] [MainThread]: On master: COMMIT
[0m22:48:00.732056 [debug] [MainThread]: SQL status: SUCCESS in 0.066 seconds
[0m22:48:00.733363 [debug] [MainThread]: On master: Close
[0m22:48:00.734357 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:48:00.734782 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages' was properly closed.
[0m22:48:00.735131 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_user' was properly closed.
[0m22:48:00.735455 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_conversation_part' was properly closed.
[0m22:48:00.735767 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.fact_consolidated_messages' was properly closed.
[0m22:48:00.736333 [info ] [MainThread]: 
[0m22:48:00.736801 [info ] [MainThread]: Finished running 7 incremental models, 1 view model in 0 hours 0 minutes and 8.61 seconds (8.61s).
[0m22:48:00.738379 [debug] [MainThread]: Command end result
[0m22:48:00.758595 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m22:48:00.759935 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m22:48:00.764535 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/run_results.json
[0m22:48:00.764808 [info ] [MainThread]: 
[0m22:48:00.765074 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:48:00.765293 [info ] [MainThread]: 
[0m22:48:00.765563 [error] [MainThread]: [31mFailure in model fact_consolidated_messages (models/gold/facts/fact_consolidated_messages.sql)[0m
[0m22:48:00.765837 [error] [MainThread]:   Database Error in model fact_consolidated_messages (models/gold/facts/fact_consolidated_messages.sql)
  column u.id does not exist
  compiled code at target/run/dbt_thrive1_redshift_dw/models/gold/facts/fact_consolidated_messages.sql
[0m22:48:00.766031 [info ] [MainThread]: 
[0m22:48:00.766265 [info ] [MainThread]:   compiled code at target/compiled/dbt_thrive1_redshift_dw/models/gold/facts/fact_consolidated_messages.sql
[0m22:48:00.766457 [info ] [MainThread]: 
[0m22:48:00.766673 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=8
[0m22:48:00.769519 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.998936, "process_in_blocks": "0", "process_kernel_time": 0.254806, "process_mem_max_rss": "153927680", "process_out_blocks": "0", "process_user_time": 2.083084}
[0m22:48:00.769851 [debug] [MainThread]: Command `dbt run` failed at 22:48:00.769789 after 9.00 seconds
[0m22:48:00.770131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fc62d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100f38cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100f38c90>]}
[0m22:48:00.770386 [debug] [MainThread]: Flushing usage events
[0m22:48:00.997484 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:48:32.198546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10893e5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108989650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10898bcd0>]}


============================== 22:48:32.201458 | 4deda78d-6d63-40e8-9d77-6c98ac6963df ==============================
[0m22:48:32.201458 [info ] [MainThread]: Running with dbt=1.10.0-b2
[0m22:48:32.201801 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/henk/.dbt', 'log_path': '/Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt compile', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:48:32.285216 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m22:48:32.285565 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m22:48:32.377089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4deda78d-6d63-40e8-9d77-6c98ac6963df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106784f10>]}
[0m22:48:32.400692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4deda78d-6d63-40e8-9d77-6c98ac6963df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106160b10>]}
[0m22:48:32.401324 [info ] [MainThread]: Registered adapter: redshift=1.9.3
[0m22:48:32.463581 [debug] [MainThread]: checksum: 5a225a3ea19c91174578d2c3f7f3bd92801a2649697bdcbd194e936bd8925adb, vars: {}, profile: , target: , version: 1.10.0b2
[0m22:48:32.518289 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:48:32.518611 [debug] [MainThread]: Partial parsing: updated file: dbt_thrive1_redshift_dw://models/gold/facts/fact_consolidated_messages.sql
[0m22:48:32.618639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4deda78d-6d63-40e8-9d77-6c98ac6963df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10946f990>]}
[0m22:48:32.673790 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m22:48:32.675343 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m22:48:32.681143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4deda78d-6d63-40e8-9d77-6c98ac6963df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109de93d0>]}
[0m22:48:32.681395 [info ] [MainThread]: Found 8 models, 505 macros
[0m22:48:32.681565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4deda78d-6d63-40e8-9d77-6c98ac6963df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d8ddd0>]}
[0m22:48:32.682425 [info ] [MainThread]: 
[0m22:48:32.682588 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:48:32.682717 [info ] [MainThread]: 
[0m22:48:32.682939 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m22:48:32.684825 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev_dev_silver'
[0m22:48:32.685047 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev_dev_gold'
[0m22:48:32.692880 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_silver"
[0m22:48:32.694840 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_gold"
[0m22:48:32.695017 [debug] [ThreadPool]: On list_thrivedev_dev_silver: BEGIN
[0m22:48:32.695163 [debug] [ThreadPool]: On list_thrivedev_dev_gold: BEGIN
[0m22:48:32.695303 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:48:32.695427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:48:32.695585 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:48:32.695720 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:48:32.697626 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:48:32.698011 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:48:33.097185 [debug] [ThreadPool]: SQL status: SUCCESS in 0.401 seconds
[0m22:48:33.098866 [debug] [ThreadPool]: SQL status: SUCCESS in 0.403 seconds
[0m22:48:33.099977 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_gold"
[0m22:48:33.100504 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_silver"
[0m22:48:33.101095 [debug] [ThreadPool]: On list_thrivedev_dev_gold: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_gold"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_gold'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_gold'
[0m22:48:33.101942 [debug] [ThreadPool]: On list_thrivedev_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_silver"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_silver'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_silver'
[0m22:48:33.208226 [debug] [ThreadPool]: SQL status: SUCCESS in 0.105 seconds
[0m22:48:33.209551 [debug] [ThreadPool]: SQL status: SUCCESS in 0.107 seconds
[0m22:48:33.251001 [debug] [ThreadPool]: On list_thrivedev_dev_gold: ROLLBACK
[0m22:48:33.251855 [debug] [ThreadPool]: On list_thrivedev_dev_silver: ROLLBACK
[0m22:48:33.304687 [debug] [ThreadPool]: On list_thrivedev_dev_gold: Close
[0m22:48:33.304923 [debug] [ThreadPool]: On list_thrivedev_dev_silver: Close
[0m22:48:33.310650 [debug] [MainThread]: Using redshift connection "master"
[0m22:48:33.310872 [debug] [MainThread]: On master: BEGIN
[0m22:48:33.311021 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:48:33.311177 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:48:33.311405 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:48:33.679281 [debug] [MainThread]: SQL status: SUCCESS in 0.368 seconds
[0m22:48:33.681377 [debug] [MainThread]: Using redshift connection "master"
[0m22:48:33.682486 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m22:48:33.794659 [debug] [MainThread]: SQL status: SUCCESS in 0.111 seconds
[0m22:48:33.799245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4deda78d-6d63-40e8-9d77-6c98ac6963df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d9ebd0>]}
[0m22:48:33.800341 [debug] [MainThread]: On master: ROLLBACK
[0m22:48:33.859277 [debug] [MainThread]: On master: Close
[0m22:48:33.868455 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:48:33.869140 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:48:33.869741 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:48:33.870304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_silver, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_part)
[0m22:48:33.870764 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_gold, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_start)
[0m22:48:33.871291 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.stg_dim_user'
[0m22:48:33.871685 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:48:33.872088 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:48:33.872459 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:48:33.876834 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:48:33.879979 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:48:33.882774 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:48:33.883786 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:48:33.884111 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:48:33.884387 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:48:33.884924 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:48:33.885424 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:48:33.885880 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:48:33.886371 [debug] [Thread-4 (]: Began running node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:48:33.886748 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.dim_user
[0m22:48:33.887155 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:48:33.887426 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:48:33.887907 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.dim_conversation_start'
[0m22:48:33.888202 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_user, now model.dbt_thrive1_redshift_dw.dim_user)
[0m22:48:33.888517 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_conversation_start, now model.dbt_thrive1_redshift_dw.dim_conversation_part)
[0m22:48:33.888812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_conversation_part, now model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages)
[0m22:48:33.889095 [debug] [Thread-4 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:48:33.889353 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_user
[0m22:48:33.889584 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:48:33.889813 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:48:33.896310 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:48:33.898873 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:48:33.901282 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:48:33.903795 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:48:33.904353 [debug] [Thread-4 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:48:33.904613 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_user
[0m22:48:33.905036 [debug] [Thread-4 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:48:33.905246 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:48:33.905576 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_user
[0m22:48:33.905751 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:48:33.906131 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:48:33.906493 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:48:33.906776 [debug] [Thread-4 (]: Began running node model.dbt_thrive1_redshift_dw.fact_consolidated_messages
[0m22:48:33.907039 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.dim_conversation_start, now model.dbt_thrive1_redshift_dw.fact_consolidated_messages)
[0m22:48:33.907247 [debug] [Thread-4 (]: Began compiling node model.dbt_thrive1_redshift_dw.fact_consolidated_messages
[0m22:48:33.909543 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"
[0m22:48:33.909892 [debug] [Thread-4 (]: Began executing node model.dbt_thrive1_redshift_dw.fact_consolidated_messages
[0m22:48:33.910231 [debug] [Thread-4 (]: Finished running node model.dbt_thrive1_redshift_dw.fact_consolidated_messages
[0m22:48:33.910791 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:48:33.910956 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages' was properly closed.
[0m22:48:33.911103 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_conversation_part' was properly closed.
[0m22:48:33.911236 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_user' was properly closed.
[0m22:48:33.911369 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.fact_consolidated_messages' was properly closed.
[0m22:48:33.912049 [debug] [MainThread]: Command end result
[0m22:48:33.926301 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m22:48:33.927104 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m22:48:33.930549 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/run_results.json
[0m22:48:33.932852 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.7701931, "process_in_blocks": "0", "process_kernel_time": 0.225775, "process_mem_max_rss": "143196160", "process_out_blocks": "0", "process_user_time": 1.187758}
[0m22:48:33.933071 [debug] [MainThread]: Command `dbt compile` succeeded at 22:48:33.933028 after 1.77 seconds
[0m22:48:33.933262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10898b490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108982390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104855dd0>]}
[0m22:48:33.933457 [debug] [MainThread]: Flushing usage events
[0m22:48:34.097152 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:48:36.734180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f60a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d5c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105faed50>]}


============================== 22:48:36.736257 | f6fb6651-6dcb-4025-a41a-479e79c95004 ==============================
[0m22:48:36.736257 [info ] [MainThread]: Running with dbt=1.10.0-b2
[0m22:48:36.736572 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/henk/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:48:36.789515 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m22:48:36.789817 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m22:48:36.862019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6fb6651-6dcb-4025-a41a-479e79c95004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ffbd90>]}
[0m22:48:36.884779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6fb6651-6dcb-4025-a41a-479e79c95004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102cae2d0>]}
[0m22:48:36.885235 [info ] [MainThread]: Registered adapter: redshift=1.9.3
[0m22:48:36.942835 [debug] [MainThread]: checksum: 5a225a3ea19c91174578d2c3f7f3bd92801a2649697bdcbd194e936bd8925adb, vars: {}, profile: , target: , version: 1.10.0b2
[0m22:48:36.988579 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:48:36.988886 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:48:37.001436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6fb6651-6dcb-4025-a41a-479e79c95004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107687150>]}
[0m22:48:37.029345 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m22:48:37.030508 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m22:48:37.036467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6fb6651-6dcb-4025-a41a-479e79c95004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075b3f10>]}
[0m22:48:37.036739 [info ] [MainThread]: Found 8 models, 505 macros
[0m22:48:37.036918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6fb6651-6dcb-4025-a41a-479e79c95004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062ff790>]}
[0m22:48:37.037937 [info ] [MainThread]: 
[0m22:48:37.038117 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:48:37.038250 [info ] [MainThread]: 
[0m22:48:37.038525 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m22:48:37.040678 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev'
[0m22:48:37.047922 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev'
[0m22:48:37.049546 [debug] [ThreadPool]: Using redshift connection "list_thrivedev"
[0m22:48:37.050934 [debug] [ThreadPool]: Using redshift connection "list_thrivedev"
[0m22:48:37.051191 [debug] [ThreadPool]: On list_thrivedev: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev"} */

    select distinct nspname from pg_namespace
[0m22:48:37.051386 [debug] [ThreadPool]: On list_thrivedev: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev"} */

    select distinct nspname from pg_namespace
[0m22:48:37.051565 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:48:37.051728 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:48:37.051904 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:48:37.052061 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:48:37.054137 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:48:37.054362 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:48:37.503725 [debug] [ThreadPool]: SQL status: SUCCESS in 0.452 seconds
[0m22:48:37.505061 [debug] [ThreadPool]: SQL status: SUCCESS in 0.453 seconds
[0m22:48:37.577122 [debug] [ThreadPool]: On list_thrivedev: Close
[0m22:48:37.577797 [debug] [ThreadPool]: On list_thrivedev: Close
[0m22:48:37.578947 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrivedev, now list_thrivedev_dev_gold)
[0m22:48:37.579218 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrivedev, now list_thrivedev_dev_silver)
[0m22:48:37.582615 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_gold"
[0m22:48:37.584360 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_silver"
[0m22:48:37.584526 [debug] [ThreadPool]: On list_thrivedev_dev_gold: BEGIN
[0m22:48:37.584660 [debug] [ThreadPool]: On list_thrivedev_dev_silver: BEGIN
[0m22:48:37.584785 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:48:37.584913 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:48:37.585053 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:48:37.585188 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:48:37.585381 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:48:37.585543 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:48:38.030061 [debug] [ThreadPool]: SQL status: SUCCESS in 0.443 seconds
[0m22:48:38.030828 [debug] [ThreadPool]: SQL status: SUCCESS in 0.446 seconds
[0m22:48:38.031249 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_silver"
[0m22:48:38.031677 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_gold"
[0m22:48:38.032193 [debug] [ThreadPool]: On list_thrivedev_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_silver"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_silver'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_silver'
[0m22:48:38.032743 [debug] [ThreadPool]: On list_thrivedev_dev_gold: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_gold"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_gold'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_gold'
[0m22:48:38.155692 [debug] [ThreadPool]: SQL status: SUCCESS in 0.122 seconds
[0m22:48:38.157922 [debug] [ThreadPool]: On list_thrivedev_dev_silver: ROLLBACK
[0m22:48:38.158350 [debug] [ThreadPool]: SQL status: SUCCESS in 0.125 seconds
[0m22:48:38.159815 [debug] [ThreadPool]: On list_thrivedev_dev_gold: ROLLBACK
[0m22:48:38.256895 [debug] [ThreadPool]: On list_thrivedev_dev_gold: Close
[0m22:48:38.258060 [debug] [ThreadPool]: On list_thrivedev_dev_silver: Close
[0m22:48:38.272859 [debug] [MainThread]: Using redshift connection "master"
[0m22:48:38.273353 [debug] [MainThread]: On master: BEGIN
[0m22:48:38.273673 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:48:38.274003 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:48:38.274450 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:48:38.900959 [debug] [MainThread]: SQL status: SUCCESS in 0.627 seconds
[0m22:48:38.902433 [debug] [MainThread]: Using redshift connection "master"
[0m22:48:38.903525 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m22:48:39.166560 [debug] [MainThread]: SQL status: SUCCESS in 0.262 seconds
[0m22:48:39.168349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6fb6651-6dcb-4025-a41a-479e79c95004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076b8350>]}
[0m22:48:39.169020 [debug] [MainThread]: On master: ROLLBACK
[0m22:48:39.249340 [debug] [MainThread]: Using redshift connection "master"
[0m22:48:39.251675 [debug] [MainThread]: On master: BEGIN
[0m22:48:39.302426 [debug] [MainThread]: SQL status: SUCCESS in 0.050 seconds
[0m22:48:39.304145 [debug] [MainThread]: On master: COMMIT
[0m22:48:39.305357 [debug] [MainThread]: Using redshift connection "master"
[0m22:48:39.305834 [debug] [MainThread]: On master: COMMIT
[0m22:48:39.372468 [debug] [MainThread]: SQL status: SUCCESS in 0.065 seconds
[0m22:48:39.394049 [debug] [MainThread]: On master: Close
[0m22:48:39.409537 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:48:39.410923 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:48:39.411333 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:48:39.413740 [info ] [Thread-1 (]: 1 of 8 START sql incremental model dev_silver.stg_dim_conversation_part ........ [RUN]
[0m22:48:39.415476 [info ] [Thread-2 (]: 2 of 8 START sql incremental model dev_silver.stg_dim_conversation_start ....... [RUN]
[0m22:48:39.416591 [info ] [Thread-3 (]: 3 of 8 START sql incremental model dev_silver.stg_dim_user ..................... [RUN]
[0m22:48:39.420008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_gold, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_part)
[0m22:48:39.421125 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_silver, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_start)
[0m22:48:39.428765 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.stg_dim_user'
[0m22:48:39.438583 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:48:39.439440 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:48:39.441779 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:48:39.449499 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:48:39.451509 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:48:39.453335 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:48:39.453944 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:48:39.454215 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:48:39.454416 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:48:39.495642 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:48:39.496828 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:48:39.499131 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:48:39.499345 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_user"} */

    
  
    

  create temporary table
    "stg_dim_user__dbt_tmp224839485970"
    
    
    
  as (
    

select
    id,
    name,
    email,
    is_customer,
    getdate() as get_date_at
from
    dev_bronze.ext_users
  );
[0m22:48:39.499541 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"} */

    
  
    

  create temporary table
    "stg_dim_conversation_part__dbt_tmp224839471871"
    
    
    
  as (
    

select
    id, 
    conversation_id, 
    conv_dataset_email, 
    part_type, 
    message, 
    created_at,
    getdate() as get_date_at
from
    dev_bronze.ext_conversation_part
  );
[0m22:48:39.499727 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"} */

    
  
    

  create temporary table
    "stg_dim_conversation_start__dbt_tmp224839498069"
    
    
    
  as (
    

select
    id, 
    source_type, 
    conv_dataset_email, 
    priority, 
    message, 
    created_at,
    getdate() as get_date_at
from
    dev_bronze.ext_conversation_start
  );
[0m22:48:39.499944 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:48:39.500132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:48:39.500294 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:48:39.500465 [debug] [Thread-3 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:48:39.500630 [debug] [Thread-1 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:48:39.500787 [debug] [Thread-2 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:48:39.501016 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:48:39.501203 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:48:39.501390 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:48:41.360939 [debug] [Thread-3 (]: SQL status: SUCCESS in 1.861 seconds
[0m22:48:41.370934 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:48:41.371247 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: BEGIN
[0m22:48:41.375084 [debug] [Thread-2 (]: SQL status: SUCCESS in 1.875 seconds
[0m22:48:41.382524 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:48:41.382840 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: BEGIN
[0m22:48:41.413461 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.913 seconds
[0m22:48:41.420312 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:48:41.420610 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: BEGIN
[0m22:48:41.426249 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.055 seconds
[0m22:48:41.426497 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:48:41.426840 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_user__dbt_tmp224839485970'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_user__dbt_tmp224839485970'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'stg_dim_user__dbt_tmp224839485970'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:48:41.436786 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.054 seconds
[0m22:48:41.437035 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:48:41.437359 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_start__dbt_tmp224839498069'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_start__dbt_tmp224839498069'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'stg_dim_conversation_start__dbt_tmp224839498069'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:48:41.483694 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.063 seconds
[0m22:48:41.484094 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:48:41.484512 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_part__dbt_tmp224839471871'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_part__dbt_tmp224839471871'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'stg_dim_conversation_part__dbt_tmp224839471871'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:48:42.057633 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.619 seconds
[0m22:48:42.076965 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:48:42.077720 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_start'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_start'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_silver'
        and tablename = 'stg_dim_conversation_start'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_silver'
    
    order by ordinal_position
[0m22:48:42.084083 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.599 seconds
[0m22:48:42.093871 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:48:42.094322 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_part'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_part'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_silver'
        and tablename = 'stg_dim_conversation_part'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_silver'
    
    order by ordinal_position
[0m22:48:42.095413 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.668 seconds
[0m22:48:42.104786 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:48:42.105169 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_user'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_user'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_silver'
        and tablename = 'stg_dim_user'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_silver'
    
    order by ordinal_position
[0m22:48:42.517519 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.438 seconds
[0m22:48:42.519028 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.424 seconds
[0m22:48:42.537652 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:48:42.546742 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:48:42.547228 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_start'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_start'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_silver'
        and tablename = 'stg_dim_conversation_start'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_silver'
    
    order by ordinal_position
[0m22:48:42.547821 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_part'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_part'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_silver'
        and tablename = 'stg_dim_conversation_part'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_silver'
    
    order by ordinal_position
[0m22:48:42.556916 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.451 seconds
[0m22:48:42.564915 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:48:42.565300 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_user'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_user'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_silver'
        and tablename = 'stg_dim_user'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_silver'
    
    order by ordinal_position
[0m22:48:43.001255 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.452 seconds
[0m22:48:43.020314 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:48:43.024043 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:48:43.024398 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"} */

      
        
            
        delete from "thrivedev"."dev_silver"."stg_dim_conversation_part"
    where (id) in (
        select distinct id
        from "stg_dim_conversation_part__dbt_tmp224839471871" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:48:43.028971 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.463 seconds
[0m22:48:43.030474 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:48:43.033689 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:48:43.034062 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_user"} */

      
        
            
        delete from "thrivedev"."dev_silver"."stg_dim_user"
    where (id) in (
        select distinct id
        from "stg_dim_user__dbt_tmp224839485970" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:48:43.034383 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.486 seconds
[0m22:48:43.035796 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:48:43.037419 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:48:43.037698 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"} */

      
        
            
        delete from "thrivedev"."dev_silver"."stg_dim_conversation_start"
    where (id) in (
        select distinct id
        from "stg_dim_conversation_start__dbt_tmp224839498069" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:48:43.187794 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.162 seconds
[0m22:48:43.189949 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:48:43.190546 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: insert into "thrivedev"."dev_silver"."stg_dim_conversation_part" ("id", "conversation_id", "conv_dataset_email", "part_type", "message", "created_at", "get_date_at")
        (
            select "id", "conversation_id", "conv_dataset_email", "part_type", "message", "created_at", "get_date_at"
            from "stg_dim_conversation_part__dbt_tmp224839471871"
        )
[0m22:48:43.215400 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.177 seconds
[0m22:48:43.217203 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:48:43.218440 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: insert into "thrivedev"."dev_silver"."stg_dim_conversation_start" ("id", "source_type", "conv_dataset_email", "priority", "message", "created_at", "get_date_at")
        (
            select "id", "source_type", "conv_dataset_email", "priority", "message", "created_at", "get_date_at"
            from "stg_dim_conversation_start__dbt_tmp224839498069"
        )
[0m22:48:43.219023 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.184 seconds
[0m22:48:43.219897 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:48:43.220828 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: insert into "thrivedev"."dev_silver"."stg_dim_user" ("id", "name", "email", "is_customer", "get_date_at")
        (
            select "id", "name", "email", "is_customer", "get_date_at"
            from "stg_dim_user__dbt_tmp224839485970"
        )
[0m22:48:43.324314 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.133 seconds
[0m22:48:43.343294 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: COMMIT
[0m22:48:43.343668 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:48:43.343844 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: COMMIT
[0m22:48:43.471688 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.250 seconds
[0m22:48:43.473116 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.253 seconds
[0m22:48:43.476083 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: COMMIT
[0m22:48:43.476895 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.133 seconds
[0m22:48:43.478640 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: COMMIT
[0m22:48:43.479382 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:48:43.481945 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: Close
[0m22:48:43.482470 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:48:43.482856 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: COMMIT
[0m22:48:43.483324 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: COMMIT
[0m22:48:43.487112 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6fb6651-6dcb-4025-a41a-479e79c95004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069ce390>]}
[0m22:48:43.487848 [info ] [Thread-1 (]: 1 of 8 OK created sql incremental model dev_silver.stg_dim_conversation_part ... [[32mSUCCESS[0m in 4.06s]
[0m22:48:43.488649 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:48:43.489337 [debug] [Thread-4 (]: Began running node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:48:43.489762 [info ] [Thread-4 (]: 4 of 8 START sql incremental model dev_gold.dim_conversation_part .............. [RUN]
[0m22:48:43.490257 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.dim_conversation_part'
[0m22:48:43.490580 [debug] [Thread-4 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:48:43.497808 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:48:43.498799 [debug] [Thread-4 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:48:43.503400 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:48:43.503874 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_part"} */

    
  
    

  create temporary table
    "dim_conversation_part__dbt_tmp224843501154"
    
    
    
  as (
    

select
    id as part_id,
    conversation_id,
    conv_dataset_email,
    part_type,
    message,
    created_at,
    get_date_at
from
    "thrivedev"."dev_silver"."stg_dim_conversation_part"



    where get_date_at > (select max(get_date_at) from "thrivedev"."dev_gold"."dim_conversation_part")

  );
[0m22:48:43.504156 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:48:43.504438 [debug] [Thread-4 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:48:43.504774 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:48:43.653486 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.169 seconds
[0m22:48:43.654468 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: Close
[0m22:48:43.655159 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6fb6651-6dcb-4025-a41a-479e79c95004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a399850>]}
[0m22:48:43.655795 [info ] [Thread-3 (]: 3 of 8 OK created sql incremental model dev_silver.stg_dim_user ................ [[32mSUCCESS[0m in 4.23s]
[0m22:48:43.656296 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:48:43.656772 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.dim_user
[0m22:48:43.657146 [info ] [Thread-1 (]: 5 of 8 START sql incremental model dev_gold.dim_user ........................... [RUN]
[0m22:48:43.657577 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.172 seconds
[0m22:48:43.657961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_conversation_part, now model.dbt_thrive1_redshift_dw.dim_user)
[0m22:48:43.658598 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: Close
[0m22:48:43.658892 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_user
[0m22:48:43.662588 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:48:43.663147 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6fb6651-6dcb-4025-a41a-479e79c95004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d28610>]}
[0m22:48:43.663820 [info ] [Thread-2 (]: 2 of 8 OK created sql incremental model dev_silver.stg_dim_conversation_start .. [[32mSUCCESS[0m in 4.24s]
[0m22:48:43.664428 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:48:43.664929 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_user
[0m22:48:43.668510 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:48:43.668736 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:48:43.668918 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_user"} */

    
  
    

  create temporary table
    "dim_user__dbt_tmp224843666768"
    
    
    
  as (
    

select
    id as user_id,
    name,
    email,
    is_customer,
    get_date_at
from
    "thrivedev"."dev_silver"."stg_dim_user"


    where get_date_at > (select max(get_date_at) from "thrivedev"."dev_gold"."dim_user")

  );
[0m22:48:43.669082 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:48:43.669312 [info ] [Thread-3 (]: 6 of 8 START sql incremental model dev_gold.dim_conversation_start ............. [RUN]
[0m22:48:43.669530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:48:43.669786 [info ] [Thread-2 (]: 7 of 8 START sql incremental model dev_silver.stg_fact_consolidated_messages ... [RUN]
[0m22:48:43.670006 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_user, now model.dbt_thrive1_redshift_dw.dim_conversation_start)
[0m22:48:43.670197 [debug] [Thread-1 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:48:43.670362 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_conversation_start, now model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages)
[0m22:48:43.670519 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:48:43.670739 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:48:43.670908 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:48:43.673062 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:48:43.675788 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:48:43.676612 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:48:43.680364 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:48:43.680644 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:48:43.680863 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_start"} */

    
  
    

  create temporary table
    "dim_conversation_start__dbt_tmp224843678020"
    
    
    
  as (
    

select
    id, 
    source_type, 
    conv_dataset_email, 
    priority, 
    message, 
    created_at,
    get_date_at
from
    "thrivedev"."dev_silver"."stg_dim_conversation_start"


    where get_date_at > (select max(get_date_at) from "thrivedev"."dev_gold"."dim_conversation_start")

  );
[0m22:48:43.685399 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:48:43.686504 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:48:43.687562 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"} */

    
  
    

  create temporary table
    "stg_fact_consolidated_messages__dbt_tmp224843682371"
    
    
    
  as (
    


WITH
  start_msgs AS (
    SELECT
      id           AS msg_id,
      conv_dataset_email AS email,
      id           AS conversation_id,
      message,
      'open'       AS message_type,
      created_at
    FROM 
        "thrivedev"."dev_silver"."stg_dim_conversation_start"
  ),
  part_msgs AS (
    SELECT
      id           AS msg_id,
      conv_dataset_email AS email,
      conversation_id,
      message,
      part_type    AS message_type,
      created_at
    FROM 
        "thrivedev"."dev_silver"."stg_dim_conversation_part"
  ),
  all_msgs AS (
    SELECT * FROM start_msgs
    UNION ALL
    SELECT * FROM part_msgs
  ),
  conv_customer AS (
    SELECT
      am.conversation_id,
      u.id AS user_id
    FROM all_msgs am
    INNER JOIN "thrivedev"."dev_silver"."stg_dim_user" u
      ON am.email = u.email
    WHERE u.is_customer = 1
    GROUP BY user_id, am.conversation_id
  )
SELECT
  am.msg_id      AS id,
  cc.user_id     AS user_id,
  am.email       AS email,
  am.conversation_id,
  am.message,
  am.message_type,
  am.created_at
FROM all_msgs am
INNER JOIN conv_customer cc
  ON am.conversation_id = cc.conversation_id
ORDER BY
  am.conversation_id,
  am.created_at
  );
[0m22:48:43.688211 [debug] [Thread-3 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:48:43.688480 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:48:43.689616 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:48:43.690801 [debug] [Thread-2 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:48:43.692481 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:48:44.261969 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.757 seconds
[0m22:48:44.279541 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:48:44.280085 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: BEGIN
[0m22:48:44.355178 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.074 seconds
[0m22:48:44.356886 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:48:44.358398 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_part__dbt_tmp224843501154'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_part__dbt_tmp224843501154'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'dim_conversation_part__dbt_tmp224843501154'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:48:44.655846 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.986 seconds
[0m22:48:44.664794 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.978 seconds
[0m22:48:44.673975 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:48:44.680770 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_user: BEGIN
[0m22:48:44.685520 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:48:44.685998 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: BEGIN
[0m22:48:44.740933 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.055 seconds
[0m22:48:44.741328 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:48:44.741917 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_user__dbt_tmp224843666768'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_user__dbt_tmp224843666768'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'dim_user__dbt_tmp224843666768'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:48:44.752427 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.066 seconds
[0m22:48:44.752779 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:48:44.753352 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_start__dbt_tmp224843678020'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_start__dbt_tmp224843678020'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'dim_conversation_start__dbt_tmp224843678020'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:48:44.974498 [debug] [Thread-2 (]: SQL status: SUCCESS in 1.285 seconds
[0m22:48:44.990423 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:48:44.990815 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: BEGIN
[0m22:48:45.071686 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.080 seconds
[0m22:48:45.072239 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:48:45.072861 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_fact_consolidated_messages__dbt_tmp224843682371'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_fact_consolidated_messages__dbt_tmp224843682371'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'stg_fact_consolidated_messages__dbt_tmp224843682371'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:48:45.290477 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.931 seconds
[0m22:48:45.307220 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:48:45.307899 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_part'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_part'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_gold'
        and tablename = 'dim_conversation_part'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_gold'
    
    order by ordinal_position
[0m22:48:45.489883 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.736 seconds
[0m22:48:45.497570 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:48:45.498053 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_start'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_start'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_gold'
        and tablename = 'dim_conversation_start'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_gold'
    
    order by ordinal_position
[0m22:48:45.524454 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.782 seconds
[0m22:48:45.534461 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:48:45.534885 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_user'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_user'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_gold'
        and tablename = 'dim_user'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_gold'
    
    order by ordinal_position
[0m22:48:45.801525 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.727 seconds
[0m22:48:45.819767 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:48:45.820476 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_fact_consolidated_messages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_fact_consolidated_messages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_silver'
        and tablename = 'stg_fact_consolidated_messages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_silver'
    
    order by ordinal_position
[0m22:48:45.833481 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.525 seconds
[0m22:48:45.838841 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:48:45.839128 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_part'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_part'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_gold'
        and tablename = 'dim_conversation_part'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_gold'
    
    order by ordinal_position
[0m22:48:45.949574 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.451 seconds
[0m22:48:45.965801 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:48:45.966388 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_start'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_start'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_gold'
        and tablename = 'dim_conversation_start'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_gold'
    
    order by ordinal_position
[0m22:48:45.987643 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.452 seconds
[0m22:48:46.000143 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:48:46.000611 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_user'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_user'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_gold'
        and tablename = 'dim_user'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_gold'
    
    order by ordinal_position
[0m22:48:46.282962 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.443 seconds
[0m22:48:46.288863 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:48:46.292896 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:48:46.293333 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_part"} */

      
        
            
        delete from "thrivedev"."dev_gold"."dim_conversation_part"
    where (part_id) in (
        select distinct part_id
        from "dim_conversation_part__dbt_tmp224843501154" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:48:46.398971 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.432 seconds
[0m22:48:46.400527 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:48:46.402049 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:48:46.402288 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_start"} */

      
        
            
        delete from "thrivedev"."dev_gold"."dim_conversation_start"
    where (id) in (
        select distinct id
        from "dim_conversation_start__dbt_tmp224843678020" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:48:46.448737 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.628 seconds
[0m22:48:46.457199 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:48:46.457493 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.164 seconds
[0m22:48:46.457976 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_fact_consolidated_messages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_fact_consolidated_messages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_silver'
        and tablename = 'stg_fact_consolidated_messages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_silver'
    
    order by ordinal_position
[0m22:48:46.458401 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:48:46.458715 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: insert into "thrivedev"."dev_gold"."dim_conversation_part" ("part_id", "conversation_id", "conv_dataset_email", "part_type", "message", "created_at", "get_date_at")
        (
            select "part_id", "conversation_id", "conv_dataset_email", "part_type", "message", "created_at", "get_date_at"
            from "dim_conversation_part__dbt_tmp224843501154"
        )
[0m22:48:46.476595 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.476 seconds
[0m22:48:46.477796 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:48:46.479321 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:48:46.479603 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_user"} */

      
        
            
        delete from "thrivedev"."dev_gold"."dim_user"
    where (user_id) in (
        select distinct user_id
        from "dim_user__dbt_tmp224843666768" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:48:46.550927 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.148 seconds
[0m22:48:46.551416 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:48:46.551820 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: insert into "thrivedev"."dev_gold"."dim_conversation_start" ("id", "source_type", "conv_dataset_email", "priority", "message", "created_at", "get_date_at")
        (
            select "id", "source_type", "conv_dataset_email", "priority", "message", "created_at", "get_date_at"
            from "dim_conversation_start__dbt_tmp224843678020"
        )
[0m22:48:46.670373 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.186 seconds
[0m22:48:46.671824 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:48:46.672346 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.213 seconds
[0m22:48:46.672921 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_user: insert into "thrivedev"."dev_gold"."dim_user" ("user_id", "name", "email", "is_customer", "get_date_at")
        (
            select "user_id", "name", "email", "is_customer", "get_date_at"
            from "dim_user__dbt_tmp224843666768"
        )
[0m22:48:46.675149 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: COMMIT
[0m22:48:46.676150 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:48:46.676645 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: COMMIT
[0m22:48:46.767423 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.215 seconds
[0m22:48:46.772566 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: COMMIT
[0m22:48:46.773969 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:48:46.774683 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: COMMIT
[0m22:48:46.800490 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.342 seconds
[0m22:48:46.802478 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:48:46.806403 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:48:46.806806 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"} */

      
        
            
        delete from "thrivedev"."dev_silver"."stg_fact_consolidated_messages"
    where (id) in (
        select distinct id
        from "stg_fact_consolidated_messages__dbt_tmp224843682371" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:48:46.853445 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.176 seconds
[0m22:48:46.854615 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: Close
[0m22:48:46.855697 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6fb6651-6dcb-4025-a41a-479e79c95004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069ce690>]}
[0m22:48:46.856601 [info ] [Thread-4 (]: 4 of 8 OK created sql incremental model dev_gold.dim_conversation_part ......... [[32mSUCCESS[0m in 3.37s]
[0m22:48:46.857354 [debug] [Thread-4 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:48:46.963907 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.189 seconds
[0m22:48:46.965316 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: Close
[0m22:48:46.966292 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6fb6651-6dcb-4025-a41a-479e79c95004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a33fd50>]}
[0m22:48:46.967200 [info ] [Thread-3 (]: 6 of 8 OK created sql incremental model dev_gold.dim_conversation_start ........ [[32mSUCCESS[0m in 3.30s]
[0m22:48:46.967919 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:48:46.981464 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.306 seconds
[0m22:48:46.982654 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_user: COMMIT
[0m22:48:46.982987 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:48:46.983166 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_user: COMMIT
[0m22:48:46.992636 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.185 seconds
[0m22:48:46.993968 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:48:46.994633 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: insert into "thrivedev"."dev_silver"."stg_fact_consolidated_messages" ("id", "user_id", "email", "conversation_id", "message", "message_type", "created_at")
        (
            select "id", "user_id", "email", "conversation_id", "message", "message_type", "created_at"
            from "stg_fact_consolidated_messages__dbt_tmp224843682371"
        )
[0m22:48:47.094120 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.110 seconds
[0m22:48:47.097304 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_user: Close
[0m22:48:47.099357 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6fb6651-6dcb-4025-a41a-479e79c95004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a0f2810>]}
[0m22:48:47.100384 [info ] [Thread-1 (]: 5 of 8 OK created sql incremental model dev_gold.dim_user ...................... [[32mSUCCESS[0m in 3.44s]
[0m22:48:47.101128 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_user
[0m22:48:47.102005 [debug] [Thread-4 (]: Began running node model.dbt_thrive1_redshift_dw.fact_consolidated_messages
[0m22:48:47.102762 [info ] [Thread-4 (]: 8 of 8 START sql view model dev_gold.fact_consolidated_messages ................ [RUN]
[0m22:48:47.103441 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.dim_conversation_part, now model.dbt_thrive1_redshift_dw.fact_consolidated_messages)
[0m22:48:47.103888 [debug] [Thread-4 (]: Began compiling node model.dbt_thrive1_redshift_dw.fact_consolidated_messages
[0m22:48:47.109875 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"
[0m22:48:47.111093 [debug] [Thread-4 (]: Began executing node model.dbt_thrive1_redshift_dw.fact_consolidated_messages
[0m22:48:47.127518 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"
[0m22:48:47.127976 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.133 seconds
[0m22:48:47.129010 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: COMMIT
[0m22:48:47.129345 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:48:47.129502 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: COMMIT
[0m22:48:47.132255 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"
[0m22:48:47.132425 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.fact_consolidated_messages: BEGIN
[0m22:48:47.132577 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:48:47.132741 [debug] [Thread-4 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:48:47.132966 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:48:47.249566 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.120 seconds
[0m22:48:47.250202 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: Close
[0m22:48:47.250723 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6fb6651-6dcb-4025-a41a-479e79c95004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aaa3c90>]}
[0m22:48:47.251183 [info ] [Thread-2 (]: 7 of 8 OK created sql incremental model dev_silver.stg_fact_consolidated_messages  [[32mSUCCESS[0m in 3.58s]
[0m22:48:47.251575 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:48:47.527687 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.394 seconds
[0m22:48:47.529626 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"
[0m22:48:47.530280 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"} */


  create view "thrivedev"."dev_gold"."fact_consolidated_messages__dbt_tmp" as (
    

WITH
  start_msgs AS (
    SELECT
      id           AS msg_id,
      conv_dataset_email AS email,
      id           AS conversation_id,
      message,
      'open'       AS message_type,
      created_at
    FROM 
        "thrivedev"."dev_gold"."dim_conversation_start"
  ),
  part_msgs AS (
    SELECT
      part_id           AS msg_id,
      conv_dataset_email AS email,
      conversation_id,
      message,
      part_type    AS message_type,
      created_at
    FROM 
        "thrivedev"."dev_gold"."dim_conversation_part"
  ),
  all_msgs AS (
    SELECT * FROM start_msgs
    UNION ALL
    SELECT * FROM part_msgs
  ),
  conv_customer AS (
    SELECT
      am.conversation_id,
      u.user_id AS user_id
    FROM all_msgs am
    INNER JOIN "thrivedev"."dev_gold"."dim_user" u
      ON am.email = u.email
    WHERE u.is_customer = 1
    GROUP BY user_id, am.conversation_id
  )
SELECT
  am.msg_id      AS id,
  cc.user_id     AS user_id,
  am.email       AS email,
  am.conversation_id,
  am.message,
  am.message_type,
  am.created_at
FROM all_msgs am
INNER JOIN conv_customer cc
  ON am.conversation_id = cc.conversation_id
ORDER BY
  am.conversation_id,
  am.created_at
  ) ;
[0m22:48:47.673688 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.143 seconds
[0m22:48:47.678267 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"
[0m22:48:47.678630 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"} */
alter table "thrivedev"."dev_gold"."fact_consolidated_messages__dbt_tmp" rename to "fact_consolidated_messages"
[0m22:48:47.763580 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.084 seconds
[0m22:48:47.768048 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.fact_consolidated_messages: COMMIT
[0m22:48:47.768744 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"
[0m22:48:47.769200 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.fact_consolidated_messages: COMMIT
[0m22:48:47.849538 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.080 seconds
[0m22:48:47.852053 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"
[0m22:48:47.853147 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.fact_consolidated_messages: BEGIN
[0m22:48:47.909547 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.055 seconds
[0m22:48:47.920554 [debug] [Thread-4 (]: Applying DROP to: "thrivedev"."dev_gold"."fact_consolidated_messages__dbt_backup"
[0m22:48:47.925495 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"
[0m22:48:47.925887 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"} */
drop view if exists "thrivedev"."dev_gold"."fact_consolidated_messages__dbt_backup" cascade
[0m22:48:47.992725 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.066 seconds
[0m22:48:47.994956 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.fact_consolidated_messages: COMMIT
[0m22:48:47.995659 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"
[0m22:48:47.996122 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.fact_consolidated_messages: COMMIT
[0m22:48:48.051562 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.054 seconds
[0m22:48:48.053667 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"
[0m22:48:48.054575 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.fact_consolidated_messages: BEGIN
[0m22:48:48.083464 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.028 seconds
[0m22:48:48.086178 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.fact_consolidated_messages: ROLLBACK
[0m22:48:48.142034 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.fact_consolidated_messages: Close
[0m22:48:48.145607 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6fb6651-6dcb-4025-a41a-479e79c95004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075b09d0>]}
[0m22:48:48.147105 [info ] [Thread-4 (]: 8 of 8 OK created sql view model dev_gold.fact_consolidated_messages ........... [[32mSUCCESS[0m in 1.04s]
[0m22:48:48.147929 [debug] [Thread-4 (]: Finished running node model.dbt_thrive1_redshift_dw.fact_consolidated_messages
[0m22:48:48.150085 [debug] [MainThread]: Using redshift connection "master"
[0m22:48:48.150608 [debug] [MainThread]: On master: BEGIN
[0m22:48:48.150939 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:48:48.151283 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:48:48.151788 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:48:48.983597 [debug] [MainThread]: SQL status: SUCCESS in 0.832 seconds
[0m22:48:48.986260 [debug] [MainThread]: On master: COMMIT
[0m22:48:48.987263 [debug] [MainThread]: Using redshift connection "master"
[0m22:48:48.988076 [debug] [MainThread]: On master: COMMIT
[0m22:48:49.043418 [debug] [MainThread]: SQL status: SUCCESS in 0.055 seconds
[0m22:48:49.045090 [debug] [MainThread]: On master: Close
[0m22:48:49.046640 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:48:49.047131 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_user' was properly closed.
[0m22:48:49.047484 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages' was properly closed.
[0m22:48:49.047826 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_conversation_start' was properly closed.
[0m22:48:49.048147 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.fact_consolidated_messages' was properly closed.
[0m22:48:49.048713 [info ] [MainThread]: 
[0m22:48:49.049187 [info ] [MainThread]: Finished running 7 incremental models, 1 view model in 0 hours 0 minutes and 12.01 seconds (12.01s).
[0m22:48:49.051119 [debug] [MainThread]: Command end result
[0m22:48:49.078577 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m22:48:49.079927 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m22:48:49.084189 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/run_results.json
[0m22:48:49.084424 [info ] [MainThread]: 
[0m22:48:49.084677 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:48:49.084876 [info ] [MainThread]: 
[0m22:48:49.085089 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m22:48:49.087816 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.3839655, "process_in_blocks": "0", "process_kernel_time": 0.286841, "process_mem_max_rss": "154681344", "process_out_blocks": "0", "process_user_time": 2.239742}
[0m22:48:49.088127 [debug] [MainThread]: Command `dbt run` succeeded at 22:48:49.088067 after 12.38 seconds
[0m22:48:49.088387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fb7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fb65d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105158fd0>]}
[0m22:48:49.088619 [debug] [MainThread]: Flushing usage events
[0m22:48:49.294644 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:58:48.238319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a60ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ab5650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ab7d10>]}


============================== 22:58:48.241422 | fa50850f-553d-4a0c-bfa3-29a887ea9e7a ==============================
[0m22:58:48.241422 [info ] [MainThread]: Running with dbt=1.10.0-b2
[0m22:58:48.241773 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/henk/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:58:48.324675 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m22:58:48.325067 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m22:58:48.415582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa50850f-553d-4a0c-bfa3-29a887ea9e7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105431d10>]}
[0m22:58:48.439375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa50850f-553d-4a0c-bfa3-29a887ea9e7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe1990>]}
[0m22:58:48.440018 [info ] [MainThread]: Registered adapter: redshift=1.9.3
[0m22:58:48.500788 [debug] [MainThread]: checksum: 5a225a3ea19c91174578d2c3f7f3bd92801a2649697bdcbd194e936bd8925adb, vars: {}, profile: , target: , version: 1.10.0b2
[0m22:58:48.557596 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:58:48.557925 [debug] [MainThread]: Partial parsing: updated file: dbt_thrive1_redshift_dw://models/gold/facts/fact_consolidated_messages.sql
[0m22:58:48.659008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa50850f-553d-4a0c-bfa3-29a887ea9e7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111791250>]}
[0m22:58:48.718170 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m22:58:48.719294 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m22:58:48.725368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa50850f-553d-4a0c-bfa3-29a887ea9e7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b72150>]}
[0m22:58:48.725620 [info ] [MainThread]: Found 8 models, 505 macros
[0m22:58:48.725788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa50850f-553d-4a0c-bfa3-29a887ea9e7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11402b650>]}
[0m22:58:48.726647 [info ] [MainThread]: 
[0m22:58:48.726806 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:58:48.726934 [info ] [MainThread]: 
[0m22:58:48.727157 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m22:58:48.729034 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev_dev_gold'
[0m22:58:48.729298 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev_dev_silver'
[0m22:58:48.737236 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_gold"
[0m22:58:48.739178 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_silver"
[0m22:58:48.739356 [debug] [ThreadPool]: On list_thrivedev_dev_gold: BEGIN
[0m22:58:48.739511 [debug] [ThreadPool]: On list_thrivedev_dev_silver: BEGIN
[0m22:58:48.739652 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:58:48.739780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:58:48.739940 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:58:48.740078 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:58:48.741974 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:58:48.742164 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:58:49.127953 [debug] [ThreadPool]: SQL status: SUCCESS in 0.388 seconds
[0m22:58:49.130417 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_silver"
[0m22:58:49.131164 [debug] [ThreadPool]: On list_thrivedev_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_silver"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_silver'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_silver'
[0m22:58:49.184962 [debug] [ThreadPool]: SQL status: SUCCESS in 0.445 seconds
[0m22:58:49.186632 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_gold"
[0m22:58:49.187697 [debug] [ThreadPool]: On list_thrivedev_dev_gold: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_gold"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_gold'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_gold'
[0m22:58:49.207708 [debug] [ThreadPool]: SQL status: SUCCESS in 0.076 seconds
[0m22:58:49.247697 [debug] [ThreadPool]: On list_thrivedev_dev_silver: ROLLBACK
[0m22:58:49.262831 [debug] [ThreadPool]: SQL status: SUCCESS in 0.074 seconds
[0m22:58:49.263777 [debug] [ThreadPool]: On list_thrivedev_dev_gold: ROLLBACK
[0m22:58:49.303749 [debug] [ThreadPool]: On list_thrivedev_dev_silver: Close
[0m22:58:49.315492 [debug] [ThreadPool]: On list_thrivedev_dev_gold: Close
[0m22:58:49.321055 [debug] [MainThread]: Using redshift connection "master"
[0m22:58:49.321284 [debug] [MainThread]: On master: BEGIN
[0m22:58:49.321433 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:58:49.321591 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:58:49.321810 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:58:49.710363 [debug] [MainThread]: SQL status: SUCCESS in 0.389 seconds
[0m22:58:49.712703 [debug] [MainThread]: Using redshift connection "master"
[0m22:58:49.713773 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m22:58:49.828946 [debug] [MainThread]: SQL status: SUCCESS in 0.114 seconds
[0m22:58:49.834510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa50850f-553d-4a0c-bfa3-29a887ea9e7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104feda90>]}
[0m22:58:49.835367 [debug] [MainThread]: On master: ROLLBACK
[0m22:58:49.897107 [debug] [MainThread]: On master: Close
[0m22:58:49.904407 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:58:49.904978 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:58:49.905413 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:58:49.905947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_gold, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_part)
[0m22:58:49.906390 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_silver, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_start)
[0m22:58:49.906938 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.stg_dim_user'
[0m22:58:49.907349 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:58:49.907715 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:58:49.908055 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:58:49.911982 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:58:49.913615 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:58:49.915108 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:58:49.916073 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:58:49.916379 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:58:49.916623 [debug] [Thread-4 (]: Began running node model.dbt_thrive1_redshift_dw.dim_user
[0m22:58:49.916844 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.dim_user'
[0m22:58:49.916997 [debug] [Thread-4 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_user
[0m22:58:49.921456 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:58:49.921676 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:58:49.922074 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:58:49.922253 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:58:49.922588 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:58:49.922934 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:58:49.923156 [debug] [Thread-4 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_user
[0m22:58:49.923423 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_user, now model.dbt_thrive1_redshift_dw.dim_conversation_part)
[0m22:58:49.923824 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:58:49.924049 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:58:49.924428 [debug] [Thread-4 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_user
[0m22:58:49.924660 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:58:49.924921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_conversation_part, now model.dbt_thrive1_redshift_dw.dim_conversation_start)
[0m22:58:49.925185 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_conversation_start, now model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages)
[0m22:58:49.928010 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:58:49.928295 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:58:49.928576 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:58:49.931605 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:58:49.934573 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:58:49.934804 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:58:49.935334 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:58:49.935673 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:58:49.935880 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:58:49.936262 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:58:49.936618 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:58:49.937083 [debug] [Thread-4 (]: Began running node model.dbt_thrive1_redshift_dw.fact_consolidated_messages
[0m22:58:49.937365 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.dim_user, now model.dbt_thrive1_redshift_dw.fact_consolidated_messages)
[0m22:58:49.937594 [debug] [Thread-4 (]: Began compiling node model.dbt_thrive1_redshift_dw.fact_consolidated_messages
[0m22:58:49.940190 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"
[0m22:58:49.940921 [debug] [Thread-4 (]: Began executing node model.dbt_thrive1_redshift_dw.fact_consolidated_messages
[0m22:58:49.941291 [debug] [Thread-4 (]: Finished running node model.dbt_thrive1_redshift_dw.fact_consolidated_messages
[0m22:58:49.941863 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:58:49.942057 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_conversation_start' was properly closed.
[0m22:58:49.942220 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages' was properly closed.
[0m22:58:49.942373 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_conversation_part' was properly closed.
[0m22:58:49.942514 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.fact_consolidated_messages' was properly closed.
[0m22:58:49.943203 [debug] [MainThread]: Command end result
[0m22:58:49.957330 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m22:58:49.958279 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m22:58:49.962035 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/run_results.json
[0m22:58:49.964358 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.7612927, "process_in_blocks": "0", "process_kernel_time": 0.237461, "process_mem_max_rss": "142737408", "process_out_blocks": "0", "process_user_time": 1.17889}
[0m22:58:49.964578 [debug] [MainThread]: Command `dbt compile` succeeded at 22:58:49.964534 after 1.76 seconds
[0m22:58:49.964764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103549d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035e4390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035e4cd0>]}
[0m22:58:49.964957 [debug] [MainThread]: Flushing usage events
[0m22:58:50.194646 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:58:53.017277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10915d9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10915e690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10915cd10>]}


============================== 22:58:53.019562 | 2b697c01-656e-4a0b-8d14-be52969cde34 ==============================
[0m22:58:53.019562 [info ] [MainThread]: Running with dbt=1.10.0-b2
[0m22:58:53.019940 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/logs', 'version_check': 'True', 'profiles_dir': '/Users/henk/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:58:53.076497 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m22:58:53.076906 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m22:58:53.153147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b697c01-656e-4a0b-8d14-be52969cde34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091c7d50>]}
[0m22:58:53.177911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b697c01-656e-4a0b-8d14-be52969cde34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105048f90>]}
[0m22:58:53.178409 [info ] [MainThread]: Registered adapter: redshift=1.9.3
[0m22:58:53.239719 [debug] [MainThread]: checksum: 5a225a3ea19c91174578d2c3f7f3bd92801a2649697bdcbd194e936bd8925adb, vars: {}, profile: , target: , version: 1.10.0b2
[0m22:58:53.283872 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:58:53.284184 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:58:53.297523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b697c01-656e-4a0b-8d14-be52969cde34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a89c2d0>]}
[0m22:58:53.327370 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m22:58:53.328555 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m22:58:53.333395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b697c01-656e-4a0b-8d14-be52969cde34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7a5f90>]}
[0m22:58:53.333766 [info ] [MainThread]: Found 8 models, 505 macros
[0m22:58:53.334063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b697c01-656e-4a0b-8d14-be52969cde34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a770050>]}
[0m22:58:53.335012 [info ] [MainThread]: 
[0m22:58:53.335193 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:58:53.335328 [info ] [MainThread]: 
[0m22:58:53.335564 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m22:58:53.337525 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev'
[0m22:58:53.337885 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev'
[0m22:58:53.356861 [debug] [ThreadPool]: Using redshift connection "list_thrivedev"
[0m22:58:53.357341 [debug] [ThreadPool]: Using redshift connection "list_thrivedev"
[0m22:58:53.357718 [debug] [ThreadPool]: On list_thrivedev: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev"} */

    select distinct nspname from pg_namespace
[0m22:58:53.358203 [debug] [ThreadPool]: On list_thrivedev: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev"} */

    select distinct nspname from pg_namespace
[0m22:58:53.358404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:58:53.358549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:58:53.358733 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:58:53.358883 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:58:53.361094 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:58:53.361388 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:58:53.807787 [debug] [ThreadPool]: SQL status: SUCCESS in 0.449 seconds
[0m22:58:53.811545 [debug] [ThreadPool]: SQL status: SUCCESS in 0.453 seconds
[0m22:58:53.879934 [debug] [ThreadPool]: On list_thrivedev: Close
[0m22:58:53.880616 [debug] [ThreadPool]: On list_thrivedev: Close
[0m22:58:53.881718 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrivedev, now list_thrivedev_dev_silver)
[0m22:58:53.881982 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrivedev, now list_thrivedev_dev_gold)
[0m22:58:53.885520 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_silver"
[0m22:58:53.887325 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_gold"
[0m22:58:53.887488 [debug] [ThreadPool]: On list_thrivedev_dev_silver: BEGIN
[0m22:58:53.887626 [debug] [ThreadPool]: On list_thrivedev_dev_gold: BEGIN
[0m22:58:53.887746 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:58:53.887866 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:58:53.888007 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:58:53.888139 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:58:53.888330 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:58:53.888486 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:58:54.326439 [debug] [ThreadPool]: SQL status: SUCCESS in 0.438 seconds
[0m22:58:54.327205 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_silver"
[0m22:58:54.327689 [debug] [ThreadPool]: On list_thrivedev_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_silver"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_silver'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_silver'
[0m22:58:54.335955 [debug] [ThreadPool]: SQL status: SUCCESS in 0.448 seconds
[0m22:58:54.336449 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_gold"
[0m22:58:54.336829 [debug] [ThreadPool]: On list_thrivedev_dev_gold: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_gold"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_gold'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_gold'
[0m22:58:54.410268 [debug] [ThreadPool]: SQL status: SUCCESS in 0.082 seconds
[0m22:58:54.411474 [debug] [ThreadPool]: On list_thrivedev_dev_silver: ROLLBACK
[0m22:58:54.423187 [debug] [ThreadPool]: SQL status: SUCCESS in 0.086 seconds
[0m22:58:54.424172 [debug] [ThreadPool]: On list_thrivedev_dev_gold: ROLLBACK
[0m22:58:54.458453 [debug] [ThreadPool]: On list_thrivedev_dev_silver: Close
[0m22:58:54.482714 [debug] [ThreadPool]: On list_thrivedev_dev_gold: Close
[0m22:58:54.490571 [debug] [MainThread]: Using redshift connection "master"
[0m22:58:54.490879 [debug] [MainThread]: On master: BEGIN
[0m22:58:54.491103 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:58:54.491319 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:58:54.491615 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:58:54.881073 [debug] [MainThread]: SQL status: SUCCESS in 0.389 seconds
[0m22:58:54.882700 [debug] [MainThread]: Using redshift connection "master"
[0m22:58:54.883280 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m22:58:54.996535 [debug] [MainThread]: SQL status: SUCCESS in 0.112 seconds
[0m22:58:55.002219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b697c01-656e-4a0b-8d14-be52969cde34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055f3750>]}
[0m22:58:55.003200 [debug] [MainThread]: On master: ROLLBACK
[0m22:58:55.059500 [debug] [MainThread]: Using redshift connection "master"
[0m22:58:55.061114 [debug] [MainThread]: On master: BEGIN
[0m22:58:55.089798 [debug] [MainThread]: SQL status: SUCCESS in 0.028 seconds
[0m22:58:55.091176 [debug] [MainThread]: On master: COMMIT
[0m22:58:55.092439 [debug] [MainThread]: Using redshift connection "master"
[0m22:58:55.093321 [debug] [MainThread]: On master: COMMIT
[0m22:58:55.147857 [debug] [MainThread]: SQL status: SUCCESS in 0.054 seconds
[0m22:58:55.149496 [debug] [MainThread]: On master: Close
[0m22:58:55.156546 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:58:55.157170 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:58:55.157700 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:58:55.158457 [info ] [Thread-1 (]: 1 of 8 START sql incremental model dev_silver.stg_dim_conversation_part ........ [RUN]
[0m22:58:55.159120 [info ] [Thread-2 (]: 2 of 8 START sql incremental model dev_silver.stg_dim_conversation_start ....... [RUN]
[0m22:58:55.159691 [info ] [Thread-3 (]: 3 of 8 START sql incremental model dev_silver.stg_dim_user ..................... [RUN]
[0m22:58:55.160287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_silver, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_part)
[0m22:58:55.160721 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_gold, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_start)
[0m22:58:55.161211 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.stg_dim_user'
[0m22:58:55.161606 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:58:55.161968 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:58:55.162307 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:58:55.166951 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:58:55.170480 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:58:55.173134 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:58:55.174265 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:58:55.174712 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:58:55.181395 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:58:55.225542 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:58:55.226645 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:58:55.229003 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:58:55.229220 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"} */

    
  
    

  create temporary table
    "stg_dim_conversation_start__dbt_tmp225855211093"
    
    
    
  as (
    

select
    id, 
    source_type, 
    conv_dataset_email, 
    priority, 
    message, 
    created_at,
    getdate() as get_date_at
from
    dev_bronze.ext_conversation_start
  );
[0m22:58:55.229418 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"} */

    
  
    

  create temporary table
    "stg_dim_conversation_part__dbt_tmp225855196246"
    
    
    
  as (
    

select
    id, 
    conversation_id, 
    conv_dataset_email, 
    part_type, 
    message, 
    created_at,
    getdate() as get_date_at
from
    dev_bronze.ext_conversation_part
  );
[0m22:58:55.229603 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_user"} */

    
  
    

  create temporary table
    "stg_dim_user__dbt_tmp225855227918"
    
    
    
  as (
    

select
    id,
    name,
    email,
    is_customer,
    getdate() as get_date_at
from
    dev_bronze.ext_users
  );
[0m22:58:55.229776 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:58:55.229932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:58:55.230078 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:58:55.230250 [debug] [Thread-2 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:58:55.230407 [debug] [Thread-1 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:58:55.230564 [debug] [Thread-3 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:58:55.230787 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:58:55.230984 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:58:55.231173 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:58:56.545619 [debug] [Thread-3 (]: SQL status: SUCCESS in 1.315 seconds
[0m22:58:56.556413 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.326 seconds
[0m22:58:56.560045 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:58:56.568575 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:58:56.568846 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: BEGIN
[0m22:58:56.569076 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: BEGIN
[0m22:58:56.620087 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.051 seconds
[0m22:58:56.620403 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.051 seconds
[0m22:58:56.620715 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:58:56.621008 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:58:56.621464 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_user__dbt_tmp225855227918'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_user__dbt_tmp225855227918'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'stg_dim_user__dbt_tmp225855227918'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:58:56.622087 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_part__dbt_tmp225855196246'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_part__dbt_tmp225855196246'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'stg_dim_conversation_part__dbt_tmp225855196246'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:58:56.711949 [debug] [Thread-2 (]: SQL status: SUCCESS in 1.482 seconds
[0m22:58:56.729518 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:58:56.729985 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: BEGIN
[0m22:58:56.788773 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.058 seconds
[0m22:58:56.790658 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:58:56.792231 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_start__dbt_tmp225855211093'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_start__dbt_tmp225855211093'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'stg_dim_conversation_start__dbt_tmp225855211093'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:58:57.046911 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.424 seconds
[0m22:58:57.055503 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:58:57.055883 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_user'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_user'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_silver'
        and tablename = 'stg_dim_user'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_silver'
    
    order by ordinal_position
[0m22:58:57.112269 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.490 seconds
[0m22:58:57.120593 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:58:57.121090 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_part'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_part'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_silver'
        and tablename = 'stg_dim_conversation_part'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_silver'
    
    order by ordinal_position
[0m22:58:57.202663 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.410 seconds
[0m22:58:57.214972 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:58:57.215505 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_start'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_start'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_silver'
        and tablename = 'stg_dim_conversation_start'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_silver'
    
    order by ordinal_position
[0m22:58:57.392817 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.336 seconds
[0m22:58:57.414055 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:58:57.414780 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_user'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_user'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_silver'
        and tablename = 'stg_dim_user'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_silver'
    
    order by ordinal_position
[0m22:58:57.441873 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.320 seconds
[0m22:58:57.452901 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:58:57.453402 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_part'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_part'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_silver'
        and tablename = 'stg_dim_conversation_part'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_silver'
    
    order by ordinal_position
[0m22:58:57.635832 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.220 seconds
[0m22:58:57.637927 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.422 seconds
[0m22:58:57.656296 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:58:57.666037 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:58:57.666617 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_start'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_start'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_silver'
        and tablename = 'stg_dim_conversation_start'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_silver'
    
    order by ordinal_position
[0m22:58:57.669245 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:58:57.669533 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_user"} */

      
        
            
        delete from "thrivedev"."dev_silver"."stg_dim_user"
    where (id) in (
        select distinct id
        from "stg_dim_user__dbt_tmp225855227918" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:58:57.690125 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.236 seconds
[0m22:58:57.691663 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:58:57.695177 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:58:57.695482 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"} */

      
        
            
        delete from "thrivedev"."dev_silver"."stg_dim_conversation_part"
    where (id) in (
        select distinct id
        from "stg_dim_conversation_part__dbt_tmp225855196246" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:58:57.791816 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.122 seconds
[0m22:58:57.792565 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:58:57.793050 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: insert into "thrivedev"."dev_silver"."stg_dim_user" ("id", "name", "email", "is_customer", "get_date_at")
        (
            select "id", "name", "email", "is_customer", "get_date_at"
            from "stg_dim_user__dbt_tmp225855227918"
        )
[0m22:58:57.840816 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.144 seconds
[0m22:58:57.842666 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:58:57.843591 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: insert into "thrivedev"."dev_silver"."stg_dim_conversation_part" ("id", "conversation_id", "conv_dataset_email", "part_type", "message", "created_at", "get_date_at")
        (
            select "id", "conversation_id", "conv_dataset_email", "part_type", "message", "created_at", "get_date_at"
            from "stg_dim_conversation_part__dbt_tmp225855196246"
        )
[0m22:58:57.894846 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.226 seconds
[0m22:58:57.899649 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:58:57.900386 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.107 seconds
[0m22:58:57.914315 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: COMMIT
[0m22:58:57.914706 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m22:58:57.914881 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: COMMIT
[0m22:58:57.915701 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:58:57.915952 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"} */

      
        
            
        delete from "thrivedev"."dev_silver"."stg_dim_conversation_start"
    where (id) in (
        select distinct id
        from "stg_dim_conversation_start__dbt_tmp225855211093" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:58:57.949900 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.106 seconds
[0m22:58:57.951238 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: COMMIT
[0m22:58:57.951702 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m22:58:57.952058 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: COMMIT
[0m22:58:58.025712 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.109 seconds
[0m22:58:58.031420 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: Close
[0m22:58:58.035597 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b697c01-656e-4a0b-8d14-be52969cde34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8c4c10>]}
[0m22:58:58.036469 [info ] [Thread-3 (]: 3 of 8 OK created sql incremental model dev_silver.stg_dim_user ................ [[32mSUCCESS[0m in 2.87s]
[0m22:58:58.037111 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m22:58:58.037850 [debug] [Thread-4 (]: Began running node model.dbt_thrive1_redshift_dw.dim_user
[0m22:58:58.038345 [info ] [Thread-4 (]: 4 of 8 START sql incremental model dev_gold.dim_user ........................... [RUN]
[0m22:58:58.038909 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.dim_user'
[0m22:58:58.039284 [debug] [Thread-4 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_user
[0m22:58:58.047633 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:58:58.048876 [debug] [Thread-4 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_user
[0m22:58:58.053687 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:58:58.054078 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_user"} */

    
  
    

  create temporary table
    "dim_user__dbt_tmp225858051415"
    
    
    
  as (
    

select
    id as user_id,
    name,
    email,
    is_customer,
    get_date_at
from
    "thrivedev"."dev_silver"."stg_dim_user"


    where get_date_at > (select max(get_date_at) from "thrivedev"."dev_gold"."dim_user")

  );
[0m22:58:58.054386 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:58:58.054710 [debug] [Thread-4 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:58:58.055140 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:58:58.067511 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.151 seconds
[0m22:58:58.067936 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:58:58.068245 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: insert into "thrivedev"."dev_silver"."stg_dim_conversation_start" ("id", "source_type", "conv_dataset_email", "priority", "message", "created_at", "get_date_at")
        (
            select "id", "source_type", "conv_dataset_email", "priority", "message", "created_at", "get_date_at"
            from "stg_dim_conversation_start__dbt_tmp225855211093"
        )
[0m22:58:58.068640 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.116 seconds
[0m22:58:58.069329 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: Close
[0m22:58:58.069882 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b697c01-656e-4a0b-8d14-be52969cde34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d862390>]}
[0m22:58:58.070320 [info ] [Thread-1 (]: 1 of 8 OK created sql incremental model dev_silver.stg_dim_conversation_part ... [[32mSUCCESS[0m in 2.91s]
[0m22:58:58.070697 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m22:58:58.071125 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:58:58.071477 [info ] [Thread-3 (]: 5 of 8 START sql incremental model dev_gold.dim_conversation_part .............. [RUN]
[0m22:58:58.071777 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_user, now model.dbt_thrive1_redshift_dw.dim_conversation_part)
[0m22:58:58.072011 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:58:58.074959 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:58:58.075720 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:58:58.079120 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:58:58.079451 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_part"} */

    
  
    

  create temporary table
    "dim_conversation_part__dbt_tmp225858077399"
    
    
    
  as (
    

select
    id as part_id,
    conversation_id,
    conv_dataset_email,
    part_type,
    message,
    created_at,
    get_date_at
from
    "thrivedev"."dev_silver"."stg_dim_conversation_part"



    where get_date_at > (select max(get_date_at) from "thrivedev"."dev_gold"."dim_conversation_part")

  );
[0m22:58:58.079704 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:58:58.079917 [debug] [Thread-3 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:58:58.080179 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:58:58.178418 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.110 seconds
[0m22:58:58.179428 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: COMMIT
[0m22:58:58.179751 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m22:58:58.179960 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: COMMIT
[0m22:58:58.280025 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.100 seconds
[0m22:58:58.281014 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: Close
[0m22:58:58.281853 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b697c01-656e-4a0b-8d14-be52969cde34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091a2d50>]}
[0m22:58:58.282482 [info ] [Thread-2 (]: 2 of 8 OK created sql incremental model dev_silver.stg_dim_conversation_start .. [[32mSUCCESS[0m in 3.12s]
[0m22:58:58.282957 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m22:58:58.283531 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:58:58.283880 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:58:58.284255 [info ] [Thread-1 (]: 6 of 8 START sql incremental model dev_gold.dim_conversation_start ............. [RUN]
[0m22:58:58.284630 [info ] [Thread-2 (]: 7 of 8 START sql incremental model dev_silver.stg_fact_consolidated_messages ... [RUN]
[0m22:58:58.285030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_conversation_part, now model.dbt_thrive1_redshift_dw.dim_conversation_start)
[0m22:58:58.285390 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_conversation_start, now model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages)
[0m22:58:58.285702 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:58:58.285993 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:58:58.289981 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:58:58.293219 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:58:58.294080 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:58:58.294406 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:58:58.301147 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:58:58.304580 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:58:58.304960 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"} */

    
  
    

  create temporary table
    "stg_fact_consolidated_messages__dbt_tmp225858296340"
    
    
    
  as (
    


WITH
  start_msgs AS (
    SELECT
      id           AS msg_id,
      conv_dataset_email AS email,
      id           AS conversation_id,
      message,
      'open'       AS message_type,
      created_at
    FROM 
        "thrivedev"."dev_silver"."stg_dim_conversation_start"
  ),
  part_msgs AS (
    SELECT
      id           AS msg_id,
      conv_dataset_email AS email,
      conversation_id,
      message,
      part_type    AS message_type,
      created_at
    FROM 
        "thrivedev"."dev_silver"."stg_dim_conversation_part"
  ),
  all_msgs AS (
    SELECT * FROM start_msgs
    UNION ALL
    SELECT * FROM part_msgs
  ),
  conv_customer AS (
    SELECT
      am.conversation_id,
      u.id AS user_id
    FROM all_msgs am
    INNER JOIN "thrivedev"."dev_silver"."stg_dim_user" u
      ON am.email = u.email
    WHERE u.is_customer = 1
    GROUP BY user_id, am.conversation_id
  )
SELECT
  am.msg_id      AS id,
  cc.user_id     AS user_id,
  am.email       AS email,
  am.conversation_id,
  am.message,
  am.message_type,
  am.created_at
FROM all_msgs am
INNER JOIN conv_customer cc
  ON am.conversation_id = cc.conversation_id
ORDER BY
  am.conversation_id,
  am.created_at
  );
[0m22:58:58.305304 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_start"} */

    
  
    

  create temporary table
    "dim_conversation_start__dbt_tmp225858302949"
    
    
    
  as (
    

select
    id, 
    source_type, 
    conv_dataset_email, 
    priority, 
    message, 
    created_at,
    get_date_at
from
    "thrivedev"."dev_silver"."stg_dim_conversation_start"


    where get_date_at > (select max(get_date_at) from "thrivedev"."dev_gold"."dim_conversation_start")

  );
[0m22:58:58.305561 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:58:58.305819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:58:58.306091 [debug] [Thread-2 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:58:58.306379 [debug] [Thread-1 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:58:58.306799 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:58:58.307070 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:58:58.615251 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.560 seconds
[0m22:58:58.632317 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:58:58.633011 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_user: BEGIN
[0m22:58:58.636104 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.556 seconds
[0m22:58:58.645133 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:58:58.645411 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: BEGIN
[0m22:58:58.697745 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.052 seconds
[0m22:58:58.698149 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:58:58.698586 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_part__dbt_tmp225858077399'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_part__dbt_tmp225858077399'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'dim_conversation_part__dbt_tmp225858077399'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:58:58.699177 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.066 seconds
[0m22:58:58.699491 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:58:58.699911 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_user__dbt_tmp225858051415'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_user__dbt_tmp225858051415'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'dim_user__dbt_tmp225858051415'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:58:58.946185 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.639 seconds
[0m22:58:58.962045 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:58:58.962525 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: BEGIN
[0m22:58:59.039366 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.076 seconds
[0m22:58:59.040845 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:58:59.042273 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_start__dbt_tmp225858302949'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_start__dbt_tmp225858302949'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'dim_conversation_start__dbt_tmp225858302949'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:58:59.118551 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.812 seconds
[0m22:58:59.133270 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:58:59.133745 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: BEGIN
[0m22:58:59.201931 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.068 seconds
[0m22:58:59.203514 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:58:59.204481 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_fact_consolidated_messages__dbt_tmp225858296340'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_fact_consolidated_messages__dbt_tmp225858296340'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'stg_fact_consolidated_messages__dbt_tmp225858296340'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m22:58:59.230046 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.531 seconds
[0m22:58:59.238276 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:58:59.238533 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.538 seconds
[0m22:58:59.238788 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_part'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_part'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_gold'
        and tablename = 'dim_conversation_part'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_gold'
    
    order by ordinal_position
[0m22:58:59.247080 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:58:59.247833 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_user'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_user'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_gold'
        and tablename = 'dim_user'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_gold'
    
    order by ordinal_position
[0m22:58:59.509099 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.464 seconds
[0m22:58:59.526601 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:58:59.527283 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_start'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_start'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_gold'
        and tablename = 'dim_conversation_start'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_gold'
    
    order by ordinal_position
[0m22:58:59.739749 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.534 seconds
[0m22:58:59.755640 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:58:59.756408 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_fact_consolidated_messages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_fact_consolidated_messages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_silver'
        and tablename = 'stg_fact_consolidated_messages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_silver'
    
    order by ordinal_position
[0m22:58:59.764555 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.516 seconds
[0m22:58:59.774539 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:58:59.775012 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_user'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_user'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_gold'
        and tablename = 'dim_user'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_gold'
    
    order by ordinal_position
[0m22:58:59.779021 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.532 seconds
[0m22:58:59.787659 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:58:59.788078 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_part'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_part'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_gold'
        and tablename = 'dim_conversation_part'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_gold'
    
    order by ordinal_position
[0m22:58:59.982445 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.454 seconds
[0m22:58:59.999627 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:59:00.000152 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_start'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_start'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_gold'
        and tablename = 'dim_conversation_start'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_gold'
    
    order by ordinal_position
[0m22:59:00.181214 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.405 seconds
[0m22:59:00.185541 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:59:00.189857 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:59:00.190322 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_user"} */

      
        
            
        delete from "thrivedev"."dev_gold"."dim_user"
    where (user_id) in (
        select distinct user_id
        from "dim_user__dbt_tmp225858051415" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:59:00.206716 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.418 seconds
[0m22:59:00.209285 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:59:00.211647 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:59:00.212079 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_part"} */

      
        
            
        delete from "thrivedev"."dev_gold"."dim_conversation_part"
    where (part_id) in (
        select distinct part_id
        from "dim_conversation_part__dbt_tmp225858077399" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:59:00.236496 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.479 seconds
[0m22:59:00.250225 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:59:00.250847 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_fact_consolidated_messages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_fact_consolidated_messages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_silver'
        and tablename = 'stg_fact_consolidated_messages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_silver'
    
    order by ordinal_position
[0m22:59:00.348376 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.337 seconds
[0m22:59:00.350051 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.159 seconds
[0m22:59:00.354194 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:59:00.355204 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:59:00.355796 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_user: insert into "thrivedev"."dev_gold"."dim_user" ("user_id", "name", "email", "is_customer", "get_date_at")
        (
            select "user_id", "name", "email", "is_customer", "get_date_at"
            from "dim_user__dbt_tmp225858051415"
        )
[0m22:59:00.358368 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:59:00.358704 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_start"} */

      
        
            
        delete from "thrivedev"."dev_gold"."dim_conversation_start"
    where (id) in (
        select distinct id
        from "dim_conversation_start__dbt_tmp225858302949" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:59:00.405143 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.192 seconds
[0m22:59:00.408995 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:59:00.409705 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: insert into "thrivedev"."dev_gold"."dim_conversation_part" ("part_id", "conversation_id", "conv_dataset_email", "part_type", "message", "created_at", "get_date_at")
        (
            select "part_id", "conversation_id", "conv_dataset_email", "part_type", "message", "created_at", "get_date_at"
            from "dim_conversation_part__dbt_tmp225858077399"
        )
[0m22:59:00.516228 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.160 seconds
[0m22:59:00.521009 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_user: COMMIT
[0m22:59:00.521580 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m22:59:00.521772 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_user: COMMIT
[0m22:59:00.523667 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.165 seconds
[0m22:59:00.524178 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:59:00.524637 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: insert into "thrivedev"."dev_gold"."dim_conversation_start" ("id", "source_type", "conv_dataset_email", "priority", "message", "created_at", "get_date_at")
        (
            select "id", "source_type", "conv_dataset_email", "priority", "message", "created_at", "get_date_at"
            from "dim_conversation_start__dbt_tmp225858302949"
        )
[0m22:59:00.578964 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.168 seconds
[0m22:59:00.582963 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: COMMIT
[0m22:59:00.583534 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m22:59:00.583805 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.332 seconds
[0m22:59:00.584111 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: COMMIT
[0m22:59:00.585599 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:59:00.588601 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:59:00.588899 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"} */

      
        
            
        delete from "thrivedev"."dev_silver"."stg_fact_consolidated_messages"
    where (id) in (
        select distinct id
        from "stg_fact_consolidated_messages__dbt_tmp225858296340" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m22:59:00.635357 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.113 seconds
[0m22:59:00.638475 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_user: Close
[0m22:59:00.639994 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b697c01-656e-4a0b-8d14-be52969cde34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d85e910>]}
[0m22:59:00.640790 [info ] [Thread-4 (]: 4 of 8 OK created sql incremental model dev_gold.dim_user ...................... [[32mSUCCESS[0m in 2.60s]
[0m22:59:00.641346 [debug] [Thread-4 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_user
[0m22:59:00.705514 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.119 seconds
[0m22:59:00.707169 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: Close
[0m22:59:00.708260 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b697c01-656e-4a0b-8d14-be52969cde34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc13610>]}
[0m22:59:00.709208 [info ] [Thread-3 (]: 5 of 8 OK created sql incremental model dev_gold.dim_conversation_part ......... [[32mSUCCESS[0m in 2.64s]
[0m22:59:00.709964 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m22:59:00.711964 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.187 seconds
[0m22:59:00.714014 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: COMMIT
[0m22:59:00.714662 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m22:59:00.714830 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: COMMIT
[0m22:59:00.725448 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.136 seconds
[0m22:59:00.725833 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:59:00.726021 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: insert into "thrivedev"."dev_silver"."stg_fact_consolidated_messages" ("id", "user_id", "email", "conversation_id", "message", "message_type", "created_at")
        (
            select "id", "user_id", "email", "conversation_id", "message", "message_type", "created_at"
            from "stg_fact_consolidated_messages__dbt_tmp225858296340"
        )
[0m22:59:00.837485 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.122 seconds
[0m22:59:00.838343 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: Close
[0m22:59:00.838983 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b697c01-656e-4a0b-8d14-be52969cde34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc9bdd0>]}
[0m22:59:00.839510 [info ] [Thread-1 (]: 6 of 8 OK created sql incremental model dev_gold.dim_conversation_start ........ [[32mSUCCESS[0m in 2.55s]
[0m22:59:00.839940 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m22:59:00.840425 [debug] [Thread-4 (]: Began running node model.dbt_thrive1_redshift_dw.fact_consolidated_messages
[0m22:59:00.840859 [info ] [Thread-4 (]: 8 of 8 START sql view model dev_gold.fact_consolidated_messages ................ [RUN]
[0m22:59:00.841247 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.dim_user, now model.dbt_thrive1_redshift_dw.fact_consolidated_messages)
[0m22:59:00.841563 [debug] [Thread-4 (]: Began compiling node model.dbt_thrive1_redshift_dw.fact_consolidated_messages
[0m22:59:00.845213 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"
[0m22:59:00.846123 [debug] [Thread-4 (]: Began executing node model.dbt_thrive1_redshift_dw.fact_consolidated_messages
[0m22:59:00.859531 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"
[0m22:59:00.863509 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"
[0m22:59:00.863814 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.fact_consolidated_messages: BEGIN
[0m22:59:00.864025 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:59:00.864250 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.138 seconds
[0m22:59:00.864469 [debug] [Thread-4 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:59:00.865288 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: COMMIT
[0m22:59:00.865608 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:59:00.865885 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m22:59:00.866529 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: COMMIT
[0m22:59:00.986692 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.120 seconds
[0m22:59:00.987388 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: Close
[0m22:59:00.987904 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b697c01-656e-4a0b-8d14-be52969cde34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bedbd0>]}
[0m22:59:00.988353 [info ] [Thread-2 (]: 7 of 8 OK created sql incremental model dev_silver.stg_fact_consolidated_messages  [[32mSUCCESS[0m in 2.70s]
[0m22:59:00.988706 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m22:59:01.267537 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.403 seconds
[0m22:59:01.269643 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"
[0m22:59:01.270445 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"} */


  create view "thrivedev"."dev_gold"."fact_consolidated_messages__dbt_tmp" as (
    

WITH
  start_msgs AS (
    SELECT
      id           AS msg_id,
      conv_dataset_email AS email,
      id           AS conversation_id,
      message,
      'open'       AS message_type,
      created_at
    FROM 
        "thrivedev"."dev_gold"."dim_conversation_start"
  ),
  part_msgs AS (
    SELECT
      part_id           AS msg_id,
      conv_dataset_email AS email,
      conversation_id,
      message,
      part_type    AS message_type,
      created_at
    FROM 
        "thrivedev"."dev_gold"."dim_conversation_part"
  ),
  all_msgs AS (
    SELECT * FROM start_msgs
    UNION ALL
    SELECT * FROM part_msgs
  ),
  conv_customer AS (
    SELECT
      u.user_id AS user_id,
      am.conversation_id
    FROM all_msgs am
    INNER JOIN "thrivedev"."dev_gold"."dim_user" u
      ON am.email = u.email
    WHERE u.is_customer = 1
    GROUP BY u.user_id
  )
SELECT
  am.msg_id      AS id,
  cc.user_id     AS user_id,
  am.email       AS email,
  am.conversation_id,
  am.message,
  am.message_type,
  am.created_at
FROM all_msgs am
INNER JOIN conv_customer cc
  ON am.conversation_id = cc.conversation_id
ORDER BY
  am.conversation_id,
  am.created_at
  ) ;
[0m22:59:01.311224 [debug] [Thread-4 (]: Redshift adapter: Redshift error: column "am.conversation_id" must appear in the GROUP BY clause or be used in an aggregate function
[0m22:59:01.312918 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.fact_consolidated_messages: ROLLBACK
[0m22:59:01.369081 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.fact_consolidated_messages: Close
[0m22:59:01.376955 [debug] [Thread-4 (]: Database Error in model fact_consolidated_messages (models/gold/facts/fact_consolidated_messages.sql)
  column "am.conversation_id" must appear in the GROUP BY clause or be used in an aggregate function
  compiled code at target/run/dbt_thrive1_redshift_dw/models/gold/facts/fact_consolidated_messages.sql
[0m22:59:01.377675 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b697c01-656e-4a0b-8d14-be52969cde34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccc0110>]}
[0m22:59:01.378531 [error] [Thread-4 (]: 8 of 8 ERROR creating sql view model dev_gold.fact_consolidated_messages ....... [[31mERROR[0m in 0.54s]
[0m22:59:01.379194 [debug] [Thread-4 (]: Finished running node model.dbt_thrive1_redshift_dw.fact_consolidated_messages
[0m22:59:01.379723 [debug] [Thread-7 (]: Marking all children of 'model.dbt_thrive1_redshift_dw.fact_consolidated_messages' to be skipped because of status 'error'.  Reason: Database Error in model fact_consolidated_messages (models/gold/facts/fact_consolidated_messages.sql)
  column "am.conversation_id" must appear in the GROUP BY clause or be used in an aggregate function
  compiled code at target/run/dbt_thrive1_redshift_dw/models/gold/facts/fact_consolidated_messages.sql.
[0m22:59:01.382125 [debug] [MainThread]: Using redshift connection "master"
[0m22:59:01.382485 [debug] [MainThread]: On master: BEGIN
[0m22:59:01.382760 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:59:01.383054 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m22:59:01.383512 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:59:01.796614 [debug] [MainThread]: SQL status: SUCCESS in 0.413 seconds
[0m22:59:01.798855 [debug] [MainThread]: On master: COMMIT
[0m22:59:01.800117 [debug] [MainThread]: Using redshift connection "master"
[0m22:59:01.800542 [debug] [MainThread]: On master: COMMIT
[0m22:59:01.850730 [debug] [MainThread]: SQL status: SUCCESS in 0.050 seconds
[0m22:59:01.852238 [debug] [MainThread]: On master: Close
[0m22:59:01.854079 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:59:01.854590 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_conversation_start' was properly closed.
[0m22:59:01.855007 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages' was properly closed.
[0m22:59:01.855485 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_conversation_part' was properly closed.
[0m22:59:01.855913 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.fact_consolidated_messages' was properly closed.
[0m22:59:01.856873 [info ] [MainThread]: 
[0m22:59:01.857438 [info ] [MainThread]: Finished running 7 incremental models, 1 view model in 0 hours 0 minutes and 8.52 seconds (8.52s).
[0m22:59:01.859437 [debug] [MainThread]: Command end result
[0m22:59:01.885747 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m22:59:01.887150 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m22:59:01.891353 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/run_results.json
[0m22:59:01.891582 [info ] [MainThread]: 
[0m22:59:01.891825 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:59:01.892017 [info ] [MainThread]: 
[0m22:59:01.892266 [error] [MainThread]: [31mFailure in model fact_consolidated_messages (models/gold/facts/fact_consolidated_messages.sql)[0m
[0m22:59:01.892506 [error] [MainThread]:   Database Error in model fact_consolidated_messages (models/gold/facts/fact_consolidated_messages.sql)
  column "am.conversation_id" must appear in the GROUP BY clause or be used in an aggregate function
  compiled code at target/run/dbt_thrive1_redshift_dw/models/gold/facts/fact_consolidated_messages.sql
[0m22:59:01.892688 [info ] [MainThread]: 
[0m22:59:01.892898 [info ] [MainThread]:   compiled code at target/compiled/dbt_thrive1_redshift_dw/models/gold/facts/fact_consolidated_messages.sql
[0m22:59:01.893071 [info ] [MainThread]: 
[0m22:59:01.893258 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=8
[0m22:59:01.895944 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.913252, "process_in_blocks": "0", "process_kernel_time": 0.264416, "process_mem_max_rss": "153452544", "process_out_blocks": "0", "process_user_time": 2.138109}
[0m22:59:01.896219 [debug] [MainThread]: Command `dbt run` failed at 22:59:01.896164 after 8.91 seconds
[0m22:59:01.896478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10914e410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091b6010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091b7f50>]}
[0m22:59:01.896706 [debug] [MainThread]: Flushing usage events
[0m22:59:02.100705 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:19:03.320371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a26a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a2b7510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a2b78d0>]}


============================== 23:19:03.323215 | a43e5e0f-ea4c-4c07-a8fc-dc459de68ba9 ==============================
[0m23:19:03.323215 [info ] [MainThread]: Running with dbt=1.10.0-b2
[0m23:19:03.323558 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/henk/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m23:19:03.409400 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m23:19:03.409778 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m23:19:03.499728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a43e5e0f-ea4c-4c07-a8fc-dc459de68ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a2af950>]}
[0m23:19:03.522728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a43e5e0f-ea4c-4c07-a8fc-dc459de68ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bc5350>]}
[0m23:19:03.523352 [info ] [MainThread]: Registered adapter: redshift=1.9.3
[0m23:19:03.587211 [debug] [MainThread]: checksum: 5a225a3ea19c91174578d2c3f7f3bd92801a2649697bdcbd194e936bd8925adb, vars: {}, profile: , target: , version: 1.10.0b2
[0m23:19:03.644499 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:19:03.644856 [debug] [MainThread]: Partial parsing: updated file: dbt_thrive1_redshift_dw://models/gold/facts/fact_consolidated_messages.sql
[0m23:19:03.745023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a43e5e0f-ea4c-4c07-a8fc-dc459de68ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c207050>]}
[0m23:19:03.801688 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m23:19:03.803212 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m23:19:03.808945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a43e5e0f-ea4c-4c07-a8fc-dc459de68ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d230c50>]}
[0m23:19:03.809194 [info ] [MainThread]: Found 8 models, 505 macros
[0m23:19:03.809363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a43e5e0f-ea4c-4c07-a8fc-dc459de68ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c9a4e50>]}
[0m23:19:03.810231 [info ] [MainThread]: 
[0m23:19:03.810407 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:19:03.810534 [info ] [MainThread]: 
[0m23:19:03.810761 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m23:19:03.812687 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev_dev_silver'
[0m23:19:03.812940 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev_dev_gold'
[0m23:19:03.821251 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_silver"
[0m23:19:03.823645 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_gold"
[0m23:19:03.823916 [debug] [ThreadPool]: On list_thrivedev_dev_silver: BEGIN
[0m23:19:03.824114 [debug] [ThreadPool]: On list_thrivedev_dev_gold: BEGIN
[0m23:19:03.824254 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:19:03.824499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:19:03.824801 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m23:19:03.824989 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m23:19:03.827440 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:19:03.827825 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:19:04.279712 [debug] [ThreadPool]: SQL status: SUCCESS in 0.455 seconds
[0m23:19:04.281784 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_gold"
[0m23:19:04.282353 [debug] [ThreadPool]: On list_thrivedev_dev_gold: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_gold"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_gold'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_gold'
[0m23:19:04.292017 [debug] [ThreadPool]: SQL status: SUCCESS in 0.468 seconds
[0m23:19:04.293161 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_silver"
[0m23:19:04.293912 [debug] [ThreadPool]: On list_thrivedev_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_silver"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_silver'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_silver'
[0m23:19:04.369153 [debug] [ThreadPool]: SQL status: SUCCESS in 0.086 seconds
[0m23:19:04.375024 [debug] [ThreadPool]: SQL status: SUCCESS in 0.080 seconds
[0m23:19:04.412754 [debug] [ThreadPool]: On list_thrivedev_dev_gold: ROLLBACK
[0m23:19:04.413646 [debug] [ThreadPool]: On list_thrivedev_dev_silver: ROLLBACK
[0m23:19:04.466049 [debug] [ThreadPool]: On list_thrivedev_dev_silver: Close
[0m23:19:04.466317 [debug] [ThreadPool]: On list_thrivedev_dev_gold: Close
[0m23:19:04.473975 [debug] [MainThread]: Using redshift connection "master"
[0m23:19:04.474239 [debug] [MainThread]: On master: BEGIN
[0m23:19:04.474431 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:19:04.474645 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m23:19:04.474927 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:19:04.853355 [debug] [MainThread]: SQL status: SUCCESS in 0.378 seconds
[0m23:19:04.855437 [debug] [MainThread]: Using redshift connection "master"
[0m23:19:04.856096 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m23:19:04.999792 [debug] [MainThread]: SQL status: SUCCESS in 0.143 seconds
[0m23:19:05.006293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a43e5e0f-ea4c-4c07-a8fc-dc459de68ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d231350>]}
[0m23:19:05.006906 [debug] [MainThread]: On master: ROLLBACK
[0m23:19:05.057738 [debug] [MainThread]: On master: Close
[0m23:19:05.063568 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m23:19:05.064053 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m23:19:05.064473 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m23:19:05.064928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_silver, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_part)
[0m23:19:05.065363 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_gold, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_start)
[0m23:19:05.065848 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.stg_dim_user'
[0m23:19:05.066236 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m23:19:05.066592 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m23:19:05.066926 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m23:19:05.071263 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m23:19:05.074341 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m23:19:05.077298 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m23:19:05.078543 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m23:19:05.078832 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m23:19:05.079114 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m23:19:05.079637 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m23:19:05.080104 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m23:19:05.080543 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m23:19:05.080990 [debug] [Thread-4 (]: Began running node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m23:19:05.081380 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m23:19:05.081798 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.dim_user
[0m23:19:05.082174 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m23:19:05.082546 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.dim_conversation_part'
[0m23:19:05.082862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_conversation_part, now model.dbt_thrive1_redshift_dw.dim_conversation_start)
[0m23:19:05.083162 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_conversation_start, now model.dbt_thrive1_redshift_dw.dim_user)
[0m23:19:05.083454 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_user, now model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages)
[0m23:19:05.083700 [debug] [Thread-4 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m23:19:05.083938 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m23:19:05.084166 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_user
[0m23:19:05.084391 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m23:19:05.090777 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m23:19:05.093310 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m23:19:05.095736 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_user"
[0m23:19:05.098214 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m23:19:05.099550 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m23:19:05.099771 [debug] [Thread-4 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m23:19:05.099970 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_user
[0m23:19:05.100161 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m23:19:05.100566 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m23:19:05.100923 [debug] [Thread-4 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m23:19:05.101271 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_user
[0m23:19:05.101590 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m23:19:05.102002 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.fact_consolidated_messages
[0m23:19:05.102251 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.dim_conversation_start, now model.dbt_thrive1_redshift_dw.fact_consolidated_messages)
[0m23:19:05.102449 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.fact_consolidated_messages
[0m23:19:05.104829 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"
[0m23:19:05.105339 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.fact_consolidated_messages
[0m23:19:05.105675 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.fact_consolidated_messages
[0m23:19:05.106222 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:19:05.106390 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.fact_consolidated_messages' was properly closed.
[0m23:19:05.106534 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_user' was properly closed.
[0m23:19:05.106670 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages' was properly closed.
[0m23:19:05.106804 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_conversation_part' was properly closed.
[0m23:19:05.107484 [debug] [MainThread]: Command end result
[0m23:19:05.121004 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m23:19:05.121761 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m23:19:05.125159 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/run_results.json
[0m23:19:05.127359 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.8426563, "process_in_blocks": "0", "process_kernel_time": 0.244174, "process_mem_max_rss": "143572992", "process_out_blocks": "0", "process_user_time": 1.197092}
[0m23:19:05.127590 [debug] [MainThread]: Command `dbt compile` succeeded at 23:19:05.127547 after 1.84 seconds
[0m23:19:05.127782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eb5d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a04fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f51010>]}
[0m23:19:05.127979 [debug] [MainThread]: Flushing usage events
[0m23:19:05.358415 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:19:09.686689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109060390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108428410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090b7a10>]}


============================== 23:19:09.690128 | 7de8894f-abe1-483b-8c76-76183dffb7d4 ==============================
[0m23:19:09.690128 [info ] [MainThread]: Running with dbt=1.10.0-b2
[0m23:19:09.690572 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/logs', 'debug': 'False', 'profiles_dir': '/Users/henk/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:19:09.786454 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m23:19:09.786804 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m23:19:09.866112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7de8894f-abe1-483b-8c76-76183dffb7d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090c9c90>]}
[0m23:19:09.891934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7de8894f-abe1-483b-8c76-76183dffb7d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b91850>]}
[0m23:19:09.892812 [info ] [MainThread]: Registered adapter: redshift=1.9.3
[0m23:19:09.955749 [debug] [MainThread]: checksum: 5a225a3ea19c91174578d2c3f7f3bd92801a2649697bdcbd194e936bd8925adb, vars: {}, profile: , target: , version: 1.10.0b2
[0m23:19:10.009528 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:19:10.009752 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:19:10.022921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7de8894f-abe1-483b-8c76-76183dffb7d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e3add0>]}
[0m23:19:10.050771 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m23:19:10.052039 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m23:19:10.058435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7de8894f-abe1-483b-8c76-76183dffb7d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a663dd0>]}
[0m23:19:10.058732 [info ] [MainThread]: Found 8 models, 505 macros
[0m23:19:10.058912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7de8894f-abe1-483b-8c76-76183dffb7d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a621050>]}
[0m23:19:10.059907 [info ] [MainThread]: 
[0m23:19:10.060104 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:19:10.060260 [info ] [MainThread]: 
[0m23:19:10.060541 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m23:19:10.062601 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev'
[0m23:19:10.062865 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev'
[0m23:19:10.071347 [debug] [ThreadPool]: Using redshift connection "list_thrivedev"
[0m23:19:10.072837 [debug] [ThreadPool]: Using redshift connection "list_thrivedev"
[0m23:19:10.073159 [debug] [ThreadPool]: On list_thrivedev: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev"} */

    select distinct nspname from pg_namespace
[0m23:19:10.073375 [debug] [ThreadPool]: On list_thrivedev: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev"} */

    select distinct nspname from pg_namespace
[0m23:19:10.073537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:19:10.073674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:19:10.073856 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m23:19:10.073986 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m23:19:10.076040 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:19:10.076250 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:19:10.576761 [debug] [ThreadPool]: SQL status: SUCCESS in 0.502 seconds
[0m23:19:10.578017 [debug] [ThreadPool]: SQL status: SUCCESS in 0.504 seconds
[0m23:19:10.679581 [debug] [ThreadPool]: On list_thrivedev: Close
[0m23:19:10.680373 [debug] [ThreadPool]: On list_thrivedev: Close
[0m23:19:10.682400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrivedev, now list_thrivedev_dev_gold)
[0m23:19:10.682742 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrivedev, now list_thrivedev_dev_silver)
[0m23:19:10.686615 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_gold"
[0m23:19:10.688635 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_silver"
[0m23:19:10.688922 [debug] [ThreadPool]: On list_thrivedev_dev_gold: BEGIN
[0m23:19:10.689183 [debug] [ThreadPool]: On list_thrivedev_dev_silver: BEGIN
[0m23:19:10.689436 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:19:10.689623 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:19:10.689827 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m23:19:10.690028 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m23:19:10.690282 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:19:10.690470 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:19:11.187932 [debug] [ThreadPool]: SQL status: SUCCESS in 0.498 seconds
[0m23:19:11.189239 [debug] [ThreadPool]: SQL status: SUCCESS in 0.500 seconds
[0m23:19:11.190035 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_silver"
[0m23:19:11.190566 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_gold"
[0m23:19:11.191198 [debug] [ThreadPool]: On list_thrivedev_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_silver"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_silver'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_silver'
[0m23:19:11.191835 [debug] [ThreadPool]: On list_thrivedev_dev_gold: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_gold"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_gold'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_gold'
[0m23:19:11.343115 [debug] [ThreadPool]: SQL status: SUCCESS in 0.150 seconds
[0m23:19:11.346525 [debug] [ThreadPool]: On list_thrivedev_dev_silver: ROLLBACK
[0m23:19:11.346964 [debug] [ThreadPool]: SQL status: SUCCESS in 0.154 seconds
[0m23:19:11.348308 [debug] [ThreadPool]: On list_thrivedev_dev_gold: ROLLBACK
[0m23:19:11.405876 [debug] [ThreadPool]: On list_thrivedev_dev_silver: Close
[0m23:19:11.406264 [debug] [ThreadPool]: On list_thrivedev_dev_gold: Close
[0m23:19:11.414128 [debug] [MainThread]: Using redshift connection "master"
[0m23:19:11.414446 [debug] [MainThread]: On master: BEGIN
[0m23:19:11.414672 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:19:11.414906 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m23:19:11.415222 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:19:11.901134 [debug] [MainThread]: SQL status: SUCCESS in 0.486 seconds
[0m23:19:11.901449 [debug] [MainThread]: Using redshift connection "master"
[0m23:19:11.901632 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m23:19:12.005707 [debug] [MainThread]: SQL status: SUCCESS in 0.104 seconds
[0m23:19:12.010559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7de8894f-abe1-483b-8c76-76183dffb7d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a827e50>]}
[0m23:19:12.011381 [debug] [MainThread]: On master: ROLLBACK
[0m23:19:12.069630 [debug] [MainThread]: Using redshift connection "master"
[0m23:19:12.070607 [debug] [MainThread]: On master: BEGIN
[0m23:19:12.106393 [debug] [MainThread]: SQL status: SUCCESS in 0.034 seconds
[0m23:19:12.107776 [debug] [MainThread]: On master: COMMIT
[0m23:19:12.108674 [debug] [MainThread]: Using redshift connection "master"
[0m23:19:12.109188 [debug] [MainThread]: On master: COMMIT
[0m23:19:12.165767 [debug] [MainThread]: SQL status: SUCCESS in 0.056 seconds
[0m23:19:12.167053 [debug] [MainThread]: On master: Close
[0m23:19:12.171340 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m23:19:12.171733 [info ] [Thread-1 (]: 1 of 8 START sql incremental model dev_silver.stg_dim_conversation_part ........ [RUN]
[0m23:19:12.171983 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m23:19:12.172205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_gold, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_part)
[0m23:19:12.172361 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m23:19:12.172578 [info ] [Thread-2 (]: 2 of 8 START sql incremental model dev_silver.stg_dim_conversation_start ....... [RUN]
[0m23:19:12.172768 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m23:19:12.172969 [info ] [Thread-3 (]: 3 of 8 START sql incremental model dev_silver.stg_dim_user ..................... [RUN]
[0m23:19:12.173162 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_silver, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_start)
[0m23:19:12.174948 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m23:19:12.175209 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.stg_dim_user'
[0m23:19:12.175379 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m23:19:12.175650 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m23:19:12.177493 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m23:19:12.179221 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m23:19:12.179560 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m23:19:12.199317 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m23:19:12.205921 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m23:19:12.212785 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m23:19:12.215011 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m23:19:12.217426 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m23:19:12.217693 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"} */

    
  
    

  create temporary table
    "stg_dim_conversation_part__dbt_tmp231912193688"
    
    
    
  as (
    

select
    id, 
    conversation_id, 
    conv_dataset_email, 
    part_type, 
    message, 
    created_at,
    getdate() as get_date_at
from
    dev_bronze.ext_conversation_part
  );
[0m23:19:12.217934 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_user"} */

    
  
    

  create temporary table
    "stg_dim_user__dbt_tmp231912214000"
    
    
    
  as (
    

select
    id,
    name,
    email,
    is_customer,
    getdate() as get_date_at
from
    dev_bronze.ext_users
  );
[0m23:19:12.218158 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"} */

    
  
    

  create temporary table
    "stg_dim_conversation_start__dbt_tmp231912216142"
    
    
    
  as (
    

select
    id, 
    source_type, 
    conv_dataset_email, 
    priority, 
    message, 
    created_at,
    getdate() as get_date_at
from
    dev_bronze.ext_conversation_start
  );
[0m23:19:12.218374 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:19:12.218556 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:19:12.218737 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:19:12.218943 [debug] [Thread-1 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m23:19:12.219140 [debug] [Thread-3 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m23:19:12.219336 [debug] [Thread-2 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m23:19:12.219604 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:19:12.219841 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:19:12.220072 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:19:13.699311 [debug] [Thread-2 (]: SQL status: SUCCESS in 1.480 seconds
[0m23:19:13.719179 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m23:19:13.719725 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: BEGIN
[0m23:19:13.720208 [debug] [Thread-3 (]: SQL status: SUCCESS in 1.502 seconds
[0m23:19:13.720555 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.502 seconds
[0m23:19:13.729833 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m23:19:13.736993 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m23:19:13.737236 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: BEGIN
[0m23:19:13.737460 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: BEGIN
[0m23:19:13.775300 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.055 seconds
[0m23:19:13.775588 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m23:19:13.776001 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_start__dbt_tmp231912216142'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_start__dbt_tmp231912216142'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'stg_dim_conversation_start__dbt_tmp231912216142'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m23:19:13.786997 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.049 seconds
[0m23:19:13.787264 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m23:19:13.787697 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_user__dbt_tmp231912214000'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_user__dbt_tmp231912214000'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'stg_dim_user__dbt_tmp231912214000'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m23:19:13.794857 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.057 seconds
[0m23:19:13.795118 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m23:19:13.795552 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_part__dbt_tmp231912193688'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_part__dbt_tmp231912193688'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'stg_dim_conversation_part__dbt_tmp231912193688'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m23:19:14.300138 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.523 seconds
[0m23:19:14.301407 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.505 seconds
[0m23:19:14.302038 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.514 seconds
[0m23:19:14.317788 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m23:19:14.327038 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m23:19:14.336059 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m23:19:14.336457 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_start'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_start'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_silver'
        and tablename = 'stg_dim_conversation_start'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_silver'
    
    order by ordinal_position
[0m23:19:14.336966 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_part'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_part'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_silver'
        and tablename = 'stg_dim_conversation_part'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_silver'
    
    order by ordinal_position
[0m23:19:14.337450 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_user'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_user'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_silver'
        and tablename = 'stg_dim_user'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_silver'
    
    order by ordinal_position
[0m23:19:14.550636 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.213 seconds
[0m23:19:14.571721 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m23:19:14.572406 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_start'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_start'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_silver'
        and tablename = 'stg_dim_conversation_start'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_silver'
    
    order by ordinal_position
[0m23:19:14.823864 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.485 seconds
[0m23:19:14.839545 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m23:19:14.840220 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.502 seconds
[0m23:19:14.840811 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_conversation_part'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_conversation_part'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_silver'
        and tablename = 'stg_dim_conversation_part'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_silver'
    
    order by ordinal_position
[0m23:19:14.850738 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m23:19:14.851311 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_dim_user'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_dim_user'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_silver'
        and tablename = 'stg_dim_user'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_silver'
    
    order by ordinal_position
[0m23:19:14.860524 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.288 seconds
[0m23:19:14.872480 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m23:19:14.874932 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m23:19:14.875207 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"} */

      
        
            
        delete from "thrivedev"."dev_silver"."stg_dim_conversation_start"
    where (id) in (
        select distinct id
        from "stg_dim_conversation_start__dbt_tmp231912216142" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m23:19:15.076719 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.201 seconds
[0m23:19:15.078200 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m23:19:15.079295 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: insert into "thrivedev"."dev_silver"."stg_dim_conversation_start" ("id", "source_type", "conv_dataset_email", "priority", "message", "created_at", "get_date_at")
        (
            select "id", "source_type", "conv_dataset_email", "priority", "message", "created_at", "get_date_at"
            from "stg_dim_conversation_start__dbt_tmp231912216142"
        )
[0m23:19:15.210969 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.359 seconds
[0m23:19:15.217373 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m23:19:15.222117 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m23:19:15.222571 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"} */

      
        
            
        delete from "thrivedev"."dev_silver"."stg_dim_conversation_part"
    where (id) in (
        select distinct id
        from "stg_dim_conversation_part__dbt_tmp231912193688" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m23:19:15.224290 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.144 seconds
[0m23:19:15.239605 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: COMMIT
[0m23:19:15.239985 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.388 seconds
[0m23:19:15.240444 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m23:19:15.242100 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m23:19:15.242449 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: COMMIT
[0m23:19:15.244229 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m23:19:15.244539 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_dim_user"} */

      
        
            
        delete from "thrivedev"."dev_silver"."stg_dim_user"
    where (id) in (
        select distinct id
        from "stg_dim_user__dbt_tmp231912214000" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m23:19:15.387853 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.143 seconds
[0m23:19:15.389507 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.166 seconds
[0m23:19:15.393655 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_start: Close
[0m23:19:15.394424 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.149 seconds
[0m23:19:15.395066 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m23:19:15.396103 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m23:19:15.398395 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: insert into "thrivedev"."dev_silver"."stg_dim_conversation_part" ("id", "conversation_id", "conv_dataset_email", "part_type", "message", "created_at", "get_date_at")
        (
            select "id", "conversation_id", "conv_dataset_email", "part_type", "message", "created_at", "get_date_at"
            from "stg_dim_conversation_part__dbt_tmp231912193688"
        )
[0m23:19:15.398932 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: insert into "thrivedev"."dev_silver"."stg_dim_user" ("id", "name", "email", "is_customer", "get_date_at")
        (
            select "id", "name", "email", "is_customer", "get_date_at"
            from "stg_dim_user__dbt_tmp231912214000"
        )
[0m23:19:15.400780 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de8894f-abe1-483b-8c76-76183dffb7d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c122d50>]}
[0m23:19:15.401636 [info ] [Thread-2 (]: 2 of 8 OK created sql incremental model dev_silver.stg_dim_conversation_start .. [[32mSUCCESS[0m in 3.22s]
[0m23:19:15.402338 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m23:19:15.403135 [debug] [Thread-4 (]: Began running node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m23:19:15.403579 [info ] [Thread-4 (]: 4 of 8 START sql incremental model dev_gold.dim_conversation_start ............. [RUN]
[0m23:19:15.404075 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.dim_conversation_start'
[0m23:19:15.404396 [debug] [Thread-4 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m23:19:15.412229 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m23:19:15.413488 [debug] [Thread-4 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m23:19:15.418029 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m23:19:15.418411 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_start"} */

    
  
    

  create temporary table
    "dim_conversation_start__dbt_tmp231915415832"
    
    
    
  as (
    

select
    id, 
    source_type, 
    conv_dataset_email, 
    priority, 
    message, 
    created_at,
    get_date_at
from
    "thrivedev"."dev_silver"."stg_dim_conversation_start"


    where get_date_at > (select max(get_date_at) from "thrivedev"."dev_gold"."dim_conversation_start")

  );
[0m23:19:15.418709 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:19:15.418992 [debug] [Thread-4 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m23:19:15.419407 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:19:15.526439 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.127 seconds
[0m23:19:15.527633 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: COMMIT
[0m23:19:15.527995 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m23:19:15.528239 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: COMMIT
[0m23:19:15.544841 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.145 seconds
[0m23:19:15.546138 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: COMMIT
[0m23:19:15.546548 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m23:19:15.546838 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: COMMIT
[0m23:19:15.632323 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.104 seconds
[0m23:19:15.633105 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.stg_dim_user: Close
[0m23:19:15.633697 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de8894f-abe1-483b-8c76-76183dffb7d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d64a90>]}
[0m23:19:15.634126 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.087 seconds
[0m23:19:15.634497 [info ] [Thread-3 (]: 3 of 8 OK created sql incremental model dev_silver.stg_dim_user ................ [[32mSUCCESS[0m in 3.46s]
[0m23:19:15.635705 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_dim_conversation_part: Close
[0m23:19:15.636456 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m23:19:15.637787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de8894f-abe1-483b-8c76-76183dffb7d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a772a50>]}
[0m23:19:15.638877 [info ] [Thread-1 (]: 1 of 8 OK created sql incremental model dev_silver.stg_dim_conversation_part ... [[32mSUCCESS[0m in 3.47s]
[0m23:19:15.639483 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.dim_user
[0m23:19:15.640269 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m23:19:15.640917 [info ] [Thread-2 (]: 5 of 8 START sql incremental model dev_gold.dim_user ........................... [RUN]
[0m23:19:15.641719 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m23:19:15.642258 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_conversation_start, now model.dbt_thrive1_redshift_dw.dim_user)
[0m23:19:15.642670 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m23:19:15.643177 [info ] [Thread-3 (]: 6 of 8 START sql incremental model dev_gold.dim_conversation_part .............. [RUN]
[0m23:19:15.643616 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_user
[0m23:19:15.644088 [info ] [Thread-1 (]: 7 of 8 START sql incremental model dev_silver.stg_fact_consolidated_messages ... [RUN]
[0m23:19:15.644535 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_user, now model.dbt_thrive1_redshift_dw.dim_conversation_part)
[0m23:19:15.649214 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_user"
[0m23:19:15.649738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_conversation_part, now model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages)
[0m23:19:15.650168 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m23:19:15.650701 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m23:19:15.654513 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m23:19:15.657905 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m23:19:15.658260 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_user
[0m23:19:15.662059 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m23:19:15.662373 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_user"} */

    
  
    

  create temporary table
    "dim_user__dbt_tmp231915660164"
    
    
    
  as (
    

select
    id as user_id,
    name,
    email,
    is_customer,
    get_date_at
from
    "thrivedev"."dev_silver"."stg_dim_user"


    where get_date_at > (select max(get_date_at) from "thrivedev"."dev_gold"."dim_user")

  );
[0m23:19:15.662702 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:19:15.662979 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m23:19:15.663274 [debug] [Thread-2 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m23:19:15.663555 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m23:19:15.667867 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m23:19:15.668229 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:19:15.673000 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m23:19:15.673335 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_part"} */

    
  
    

  create temporary table
    "dim_conversation_part__dbt_tmp231915665187"
    
    
    
  as (
    

select
    id as part_id,
    conversation_id,
    conv_dataset_email,
    part_type,
    message,
    created_at,
    get_date_at
from
    "thrivedev"."dev_silver"."stg_dim_conversation_part"



    where get_date_at > (select max(get_date_at) from "thrivedev"."dev_gold"."dim_conversation_part")

  );
[0m23:19:15.674589 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"} */

    
  
    

  create temporary table
    "stg_fact_consolidated_messages__dbt_tmp231915669724"
    
    
    
  as (
    


WITH
  start_msgs AS (
    SELECT
      id           AS msg_id,
      conv_dataset_email AS email,
      id           AS conversation_id,
      message,
      'open'       AS message_type,
      created_at
    FROM 
        "thrivedev"."dev_silver"."stg_dim_conversation_start"
  ),
  part_msgs AS (
    SELECT
      id           AS msg_id,
      conv_dataset_email AS email,
      conversation_id,
      message,
      part_type    AS message_type,
      created_at
    FROM 
        "thrivedev"."dev_silver"."stg_dim_conversation_part"
  ),
  all_msgs AS (
    SELECT * FROM start_msgs
    UNION ALL
    SELECT * FROM part_msgs
  ),
  conv_customer AS (
    SELECT
      am.conversation_id,
      u.id AS user_id
    FROM all_msgs am
    INNER JOIN "thrivedev"."dev_silver"."stg_dim_user" u
      ON am.email = u.email
    WHERE u.is_customer = 1
    GROUP BY user_id, am.conversation_id
  )
SELECT
  am.msg_id      AS id,
  cc.user_id     AS user_id,
  am.email       AS email,
  am.conversation_id,
  am.message,
  am.message_type,
  am.created_at
FROM all_msgs am
INNER JOIN conv_customer cc
  ON am.conversation_id = cc.conversation_id
ORDER BY
  am.conversation_id,
  am.created_at
  );
[0m23:19:15.674950 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:19:15.675315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:19:15.675628 [debug] [Thread-3 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m23:19:15.677365 [debug] [Thread-1 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m23:19:15.678131 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:19:15.678740 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:19:15.944026 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.525 seconds
[0m23:19:15.955236 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m23:19:15.955883 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: BEGIN
[0m23:19:16.014325 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.058 seconds
[0m23:19:16.015599 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m23:19:16.016530 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_start__dbt_tmp231915415832'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_start__dbt_tmp231915415832'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'dim_conversation_start__dbt_tmp231915415832'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m23:19:16.293520 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.630 seconds
[0m23:19:16.304565 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m23:19:16.305053 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_user: BEGIN
[0m23:19:16.369010 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.064 seconds
[0m23:19:16.369679 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m23:19:16.370027 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.695 seconds
[0m23:19:16.370567 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_user__dbt_tmp231915660164'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_user__dbt_tmp231915660164'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'dim_user__dbt_tmp231915660164'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m23:19:16.384564 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m23:19:16.385135 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: BEGIN
[0m23:19:16.465260 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.079 seconds
[0m23:19:16.466622 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m23:19:16.469044 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_part__dbt_tmp231915665187'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_part__dbt_tmp231915665187'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'dim_conversation_part__dbt_tmp231915665187'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m23:19:16.488601 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.813 seconds
[0m23:19:16.498078 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m23:19:16.498544 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.481 seconds
[0m23:19:16.498801 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: BEGIN
[0m23:19:16.505465 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m23:19:16.505871 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_start'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_start'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_gold'
        and tablename = 'dim_conversation_start'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_gold'
    
    order by ordinal_position
[0m23:19:16.561812 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.056 seconds
[0m23:19:16.562508 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m23:19:16.563335 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_fact_consolidated_messages__dbt_tmp231915669724'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_fact_consolidated_messages__dbt_tmp231915669724'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'stg_fact_consolidated_messages__dbt_tmp231915669724'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m23:19:16.829516 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.446 seconds
[0m23:19:16.847304 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m23:19:16.847961 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_user'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_user'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_gold'
        and tablename = 'dim_user'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_gold'
    
    order by ordinal_position
[0m23:19:16.952143 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.446 seconds
[0m23:19:16.960975 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m23:19:16.961347 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_start"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_start'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_start'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_gold'
        and tablename = 'dim_conversation_start'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_gold'
    
    order by ordinal_position
[0m23:19:17.026529 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.557 seconds
[0m23:19:17.035953 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m23:19:17.036452 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_part'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_part'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_gold'
        and tablename = 'dim_conversation_part'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_gold'
    
    order by ordinal_position
[0m23:19:17.057576 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.494 seconds
[0m23:19:17.065395 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m23:19:17.065727 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_fact_consolidated_messages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_fact_consolidated_messages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_silver'
        and tablename = 'stg_fact_consolidated_messages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_silver'
    
    order by ordinal_position
[0m23:19:17.251914 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.403 seconds
[0m23:19:17.264089 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m23:19:17.264797 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_user"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_user'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_user'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_gold'
        and tablename = 'dim_user'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_gold'
    
    order by ordinal_position
[0m23:19:17.343268 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.381 seconds
[0m23:19:17.346512 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m23:19:17.350566 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m23:19:17.351143 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_start"} */

      
        
            
        delete from "thrivedev"."dev_gold"."dim_conversation_start"
    where (id) in (
        select distinct id
        from "dim_conversation_start__dbt_tmp231915415832" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m23:19:17.484726 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.133 seconds
[0m23:19:17.486644 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m23:19:17.487251 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: insert into "thrivedev"."dev_gold"."dim_conversation_start" ("id", "source_type", "conv_dataset_email", "priority", "message", "created_at", "get_date_at")
        (
            select "id", "source_type", "conv_dataset_email", "priority", "message", "created_at", "get_date_at"
            from "dim_conversation_start__dbt_tmp231915415832"
        )
[0m23:19:17.546045 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.480 seconds
[0m23:19:17.547287 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.510 seconds
[0m23:19:17.555609 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m23:19:17.561443 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m23:19:17.561996 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'stg_fact_consolidated_messages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'stg_fact_consolidated_messages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_silver'
        and tablename = 'stg_fact_consolidated_messages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_silver'
    
    order by ordinal_position
[0m23:19:17.562442 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_part"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'dim_conversation_part'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'dim_conversation_part'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'dev_gold'
        and tablename = 'dim_conversation_part'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'dev_gold'
    
    order by ordinal_position
[0m23:19:17.575701 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.310 seconds
[0m23:19:17.576765 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.dim_user"
[0m23:19:17.578050 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m23:19:17.578259 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_user: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_user"} */

      
        
            
        delete from "thrivedev"."dev_gold"."dim_user"
    where (user_id) in (
        select distinct user_id
        from "dim_user__dbt_tmp231915660164" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m23:19:17.644936 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.157 seconds
[0m23:19:17.649092 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: COMMIT
[0m23:19:17.649801 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m23:19:17.650261 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: COMMIT
[0m23:19:17.731798 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.153 seconds
[0m23:19:17.733316 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m23:19:17.733922 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_user: insert into "thrivedev"."dev_gold"."dim_user" ("user_id", "name", "email", "is_customer", "get_date_at")
        (
            select "user_id", "name", "email", "is_customer", "get_date_at"
            from "dim_user__dbt_tmp231915660164"
        )
[0m23:19:17.780734 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.130 seconds
[0m23:19:17.783965 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_start: Close
[0m23:19:17.785647 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de8894f-abe1-483b-8c76-76183dffb7d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c43ac90>]}
[0m23:19:17.786798 [info ] [Thread-4 (]: 4 of 8 OK created sql incremental model dev_gold.dim_conversation_start ........ [[32mSUCCESS[0m in 2.38s]
[0m23:19:17.787667 [debug] [Thread-4 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m23:19:18.014623 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.451 seconds
[0m23:19:18.016319 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.282 seconds
[0m23:19:18.019919 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m23:19:18.021994 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_user: COMMIT
[0m23:19:18.022495 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.459 seconds
[0m23:19:18.023366 [debug] [Thread-2 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_user"
[0m23:19:18.026224 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m23:19:18.026674 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_user: COMMIT
[0m23:19:18.029354 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m23:19:18.029816 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"} */

      
        
            
        delete from "thrivedev"."dev_silver"."stg_fact_consolidated_messages"
    where (id) in (
        select distinct id
        from "stg_fact_consolidated_messages__dbt_tmp231915669724" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m23:19:18.031581 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m23:19:18.031962 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.dim_conversation_part"} */

      
        
            
        delete from "thrivedev"."dev_gold"."dim_conversation_part"
    where (part_id) in (
        select distinct part_id
        from "dim_conversation_part__dbt_tmp231915665187" as DBT_INTERNAL_SOURCE
    )
    
    ;
[0m23:19:18.150480 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.123 seconds
[0m23:19:18.154210 [debug] [Thread-2 (]: On model.dbt_thrive1_redshift_dw.dim_user: Close
[0m23:19:18.155974 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de8894f-abe1-483b-8c76-76183dffb7d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090ae550>]}
[0m23:19:18.156997 [info ] [Thread-2 (]: 5 of 8 OK created sql incremental model dev_gold.dim_user ...................... [[32mSUCCESS[0m in 2.51s]
[0m23:19:18.157758 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_user
[0m23:19:18.192068 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.159 seconds
[0m23:19:18.194016 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m23:19:18.194913 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: insert into "thrivedev"."dev_gold"."dim_conversation_part" ("part_id", "conversation_id", "conv_dataset_email", "part_type", "message", "created_at", "get_date_at")
        (
            select "part_id", "conversation_id", "conv_dataset_email", "part_type", "message", "created_at", "get_date_at"
            from "dim_conversation_part__dbt_tmp231915665187"
        )
[0m23:19:18.200266 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.170 seconds
[0m23:19:18.201331 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m23:19:18.201932 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: insert into "thrivedev"."dev_silver"."stg_fact_consolidated_messages" ("id", "user_id", "email", "conversation_id", "message", "message_type", "created_at")
        (
            select "id", "user_id", "email", "conversation_id", "message", "message_type", "created_at"
            from "stg_fact_consolidated_messages__dbt_tmp231915669724"
        )
[0m23:19:18.293474 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.097 seconds
[0m23:19:18.297161 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: COMMIT
[0m23:19:18.297664 [debug] [Thread-3 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m23:19:18.297856 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: COMMIT
[0m23:19:18.343047 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.140 seconds
[0m23:19:18.344986 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: COMMIT
[0m23:19:18.345724 [debug] [Thread-1 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m23:19:18.346317 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: COMMIT
[0m23:19:18.398747 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.100 seconds
[0m23:19:18.400851 [debug] [Thread-3 (]: On model.dbt_thrive1_redshift_dw.dim_conversation_part: Close
[0m23:19:18.402373 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de8894f-abe1-483b-8c76-76183dffb7d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109af0310>]}
[0m23:19:18.403430 [info ] [Thread-3 (]: 6 of 8 OK created sql incremental model dev_gold.dim_conversation_part ......... [[32mSUCCESS[0m in 2.76s]
[0m23:19:18.404592 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m23:19:18.405425 [debug] [Thread-4 (]: Began running node model.dbt_thrive1_redshift_dw.fact_consolidated_messages
[0m23:19:18.405915 [info ] [Thread-4 (]: 8 of 8 START sql view model dev_gold.fact_consolidated_messages ................ [RUN]
[0m23:19:18.406238 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.dim_conversation_start, now model.dbt_thrive1_redshift_dw.fact_consolidated_messages)
[0m23:19:18.406485 [debug] [Thread-4 (]: Began compiling node model.dbt_thrive1_redshift_dw.fact_consolidated_messages
[0m23:19:18.410270 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"
[0m23:19:18.411165 [debug] [Thread-4 (]: Began executing node model.dbt_thrive1_redshift_dw.fact_consolidated_messages
[0m23:19:18.420261 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"
[0m23:19:18.422411 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"
[0m23:19:18.422596 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.fact_consolidated_messages: BEGIN
[0m23:19:18.422752 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:19:18.422921 [debug] [Thread-4 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m23:19:18.423144 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:19:18.424387 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.078 seconds
[0m23:19:18.424908 [debug] [Thread-1 (]: On model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages: Close
[0m23:19:18.426308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de8894f-abe1-483b-8c76-76183dffb7d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1ca790>]}
[0m23:19:18.426977 [info ] [Thread-1 (]: 7 of 8 OK created sql incremental model dev_silver.stg_fact_consolidated_messages  [[32mSUCCESS[0m in 2.78s]
[0m23:19:18.428792 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m23:19:18.824794 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.402 seconds
[0m23:19:18.825779 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"
[0m23:19:18.826476 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"} */


  create view "thrivedev"."dev_gold"."fact_consolidated_messages__dbt_tmp" as (
    

WITH
  start_msgs AS (
    SELECT
      id           AS msg_id,
      conv_dataset_email AS email,
      id           AS conversation_id,
      message,
      'open'       AS message_type,
      created_at
    FROM 
        "thrivedev"."dev_gold"."dim_conversation_start"
  ),
  part_msgs AS (
    SELECT
      part_id           AS msg_id,
      conv_dataset_email AS email,
      conversation_id,
      message,
      part_type    AS message_type,
      created_at
    FROM 
        "thrivedev"."dev_gold"."dim_conversation_part"
  ),
  all_msgs AS (
    SELECT * FROM start_msgs
    UNION ALL
    SELECT * FROM part_msgs
  ),
  conv_customer AS (
    SELECT
      u.user_id AS user_id,
      am.conversation_id
    FROM all_msgs am
    INNER JOIN "thrivedev"."dev_gold"."dim_user" u
      ON am.email = u.email
    WHERE u.is_customer = 1
    GROUP BY u.user_id, am.conversation_id
  )
SELECT
  am.msg_id      AS id,
  cc.user_id     AS user_id,
  am.email       AS email,
  am.conversation_id,
  am.message,
  am.message_type,
  am.created_at
FROM all_msgs am
INNER JOIN conv_customer cc
  ON am.conversation_id = cc.conversation_id
ORDER BY
  am.conversation_id,
  am.created_at
  ) ;
[0m23:19:18.978763 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.150 seconds
[0m23:19:18.988691 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"
[0m23:19:18.988987 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"} */
alter table "thrivedev"."dev_gold"."fact_consolidated_messages" rename to "fact_consolidated_messages__dbt_backup"
[0m23:19:19.089073 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.099 seconds
[0m23:19:19.093263 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"
[0m23:19:19.093554 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"} */
alter table "thrivedev"."dev_gold"."fact_consolidated_messages__dbt_tmp" rename to "fact_consolidated_messages"
[0m23:19:19.187213 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.093 seconds
[0m23:19:19.193044 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.fact_consolidated_messages: COMMIT
[0m23:19:19.193553 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"
[0m23:19:19.193797 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.fact_consolidated_messages: COMMIT
[0m23:19:19.279323 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.085 seconds
[0m23:19:19.280753 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"
[0m23:19:19.281364 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.fact_consolidated_messages: BEGIN
[0m23:19:19.332874 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.051 seconds
[0m23:19:19.344342 [debug] [Thread-4 (]: Applying DROP to: "thrivedev"."dev_gold"."fact_consolidated_messages__dbt_backup"
[0m23:19:19.349976 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"
[0m23:19:19.350398 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.fact_consolidated_messages: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"} */
drop view if exists "thrivedev"."dev_gold"."fact_consolidated_messages__dbt_backup" cascade
[0m23:19:19.407503 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.056 seconds
[0m23:19:19.410503 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.fact_consolidated_messages: COMMIT
[0m23:19:19.411270 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"
[0m23:19:19.411742 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.fact_consolidated_messages: COMMIT
[0m23:19:19.464311 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.052 seconds
[0m23:19:19.466889 [debug] [Thread-4 (]: Using redshift connection "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"
[0m23:19:19.467791 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.fact_consolidated_messages: BEGIN
[0m23:19:19.495612 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.027 seconds
[0m23:19:19.498155 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.fact_consolidated_messages: ROLLBACK
[0m23:19:19.551565 [debug] [Thread-4 (]: On model.dbt_thrive1_redshift_dw.fact_consolidated_messages: Close
[0m23:19:19.554901 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de8894f-abe1-483b-8c76-76183dffb7d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a716710>]}
[0m23:19:19.556605 [info ] [Thread-4 (]: 8 of 8 OK created sql view model dev_gold.fact_consolidated_messages ........... [[32mSUCCESS[0m in 1.15s]
[0m23:19:19.557872 [debug] [Thread-4 (]: Finished running node model.dbt_thrive1_redshift_dw.fact_consolidated_messages
[0m23:19:19.560094 [debug] [MainThread]: Using redshift connection "master"
[0m23:19:19.560656 [debug] [MainThread]: On master: BEGIN
[0m23:19:19.561050 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:19:19.561495 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m23:19:19.562121 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:19:19.946053 [debug] [MainThread]: SQL status: SUCCESS in 0.384 seconds
[0m23:19:19.947821 [debug] [MainThread]: On master: COMMIT
[0m23:19:19.948797 [debug] [MainThread]: Using redshift connection "master"
[0m23:19:19.949344 [debug] [MainThread]: On master: COMMIT
[0m23:19:19.992067 [debug] [MainThread]: SQL status: SUCCESS in 0.042 seconds
[0m23:19:19.993558 [debug] [MainThread]: On master: Close
[0m23:19:19.995756 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:19:19.996731 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages' was properly closed.
[0m23:19:19.997694 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_user' was properly closed.
[0m23:19:19.998158 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.dim_conversation_part' was properly closed.
[0m23:19:19.998621 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.fact_consolidated_messages' was properly closed.
[0m23:19:19.999460 [info ] [MainThread]: 
[0m23:19:20.000239 [info ] [MainThread]: Finished running 7 incremental models, 1 view model in 0 hours 0 minutes and 9.94 seconds (9.94s).
[0m23:19:20.002239 [debug] [MainThread]: Command end result
[0m23:19:20.028714 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m23:19:20.029990 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m23:19:20.034207 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/run_results.json
[0m23:19:20.034433 [info ] [MainThread]: 
[0m23:19:20.034678 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:19:20.034870 [info ] [MainThread]: 
[0m23:19:20.035068 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m23:19:20.037836 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.396593, "process_in_blocks": "0", "process_kernel_time": 0.309581, "process_mem_max_rss": "146194432", "process_out_blocks": "0", "process_user_time": 2.156164}
[0m23:19:20.038110 [debug] [MainThread]: Command `dbt run` succeeded at 23:19:20.038059 after 10.40 seconds
[0m23:19:20.038353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101005d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c485210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1010a0c90>]}
[0m23:19:20.038588 [debug] [MainThread]: Flushing usage events
[0m23:19:20.260573 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:42:32.951434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e51450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cb5650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cb7cd0>]}


============================== 23:42:32.954739 | 224ede81-fd20-463d-9a8b-0e7e888dd066 ==============================
[0m23:42:32.954739 [info ] [MainThread]: Running with dbt=1.10.0-b2
[0m23:42:32.955098 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/henk/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m23:42:33.040373 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m23:42:33.040713 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m23:42:33.130686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '224ede81-fd20-463d-9a8b-0e7e888dd066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a275f50>]}
[0m23:42:33.153923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '224ede81-fd20-463d-9a8b-0e7e888dd066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041c5cd0>]}
[0m23:42:33.154540 [info ] [MainThread]: Registered adapter: redshift=1.9.3
[0m23:42:33.214826 [debug] [MainThread]: checksum: 5a225a3ea19c91174578d2c3f7f3bd92801a2649697bdcbd194e936bd8925adb, vars: {}, profile: , target: , version: 1.10.0b2
[0m23:42:33.272909 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:42:33.273300 [debug] [MainThread]: Partial parsing: added file: dbt_thrive1_redshift_dw://models/gold/dimensions/dim_user.yml
[0m23:42:33.381705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '224ede81-fd20-463d-9a8b-0e7e888dd066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a901510>]}
[0m23:42:33.444830 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m23:42:33.446437 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m23:42:33.452840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '224ede81-fd20-463d-9a8b-0e7e888dd066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a9769d0>]}
[0m23:42:33.453105 [info ] [MainThread]: Found 8 models, 5 data tests, 505 macros
[0m23:42:33.453273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '224ede81-fd20-463d-9a8b-0e7e888dd066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ac91d50>]}
[0m23:42:33.454210 [info ] [MainThread]: 
[0m23:42:33.454371 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:42:33.454497 [info ] [MainThread]: 
[0m23:42:33.454706 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m23:42:33.456574 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev_dev_silver'
[0m23:42:33.456809 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev_dev_gold'
[0m23:42:33.464618 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_silver"
[0m23:42:33.466543 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_gold"
[0m23:42:33.466717 [debug] [ThreadPool]: On list_thrivedev_dev_silver: BEGIN
[0m23:42:33.466881 [debug] [ThreadPool]: On list_thrivedev_dev_gold: BEGIN
[0m23:42:33.467021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:42:33.467150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:42:33.467302 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m23:42:33.467433 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m23:42:33.469465 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:42:33.469727 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:42:34.019665 [debug] [ThreadPool]: SQL status: SUCCESS in 0.552 seconds
[0m23:42:34.020197 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_gold"
[0m23:42:34.020500 [debug] [ThreadPool]: On list_thrivedev_dev_gold: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_gold"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_gold'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_gold'
[0m23:42:34.024458 [debug] [ThreadPool]: SQL status: SUCCESS in 0.557 seconds
[0m23:42:34.024693 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_silver"
[0m23:42:34.024952 [debug] [ThreadPool]: On list_thrivedev_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_silver"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_silver'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_silver'
[0m23:42:34.110801 [debug] [ThreadPool]: SQL status: SUCCESS in 0.090 seconds
[0m23:42:34.113928 [debug] [ThreadPool]: SQL status: SUCCESS in 0.089 seconds
[0m23:42:34.149672 [debug] [ThreadPool]: On list_thrivedev_dev_gold: ROLLBACK
[0m23:42:34.150529 [debug] [ThreadPool]: On list_thrivedev_dev_silver: ROLLBACK
[0m23:42:34.204586 [debug] [ThreadPool]: On list_thrivedev_dev_gold: Close
[0m23:42:34.204838 [debug] [ThreadPool]: On list_thrivedev_dev_silver: Close
[0m23:42:34.213296 [debug] [MainThread]: Using redshift connection "master"
[0m23:42:34.213587 [debug] [MainThread]: On master: BEGIN
[0m23:42:34.213795 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:42:34.214018 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m23:42:34.214315 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:42:34.643355 [debug] [MainThread]: SQL status: SUCCESS in 0.429 seconds
[0m23:42:34.645536 [debug] [MainThread]: Using redshift connection "master"
[0m23:42:34.646560 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m23:42:34.762214 [debug] [MainThread]: SQL status: SUCCESS in 0.115 seconds
[0m23:42:34.767550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '224ede81-fd20-463d-9a8b-0e7e888dd066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a968150>]}
[0m23:42:34.768311 [debug] [MainThread]: On master: ROLLBACK
[0m23:42:34.827697 [debug] [MainThread]: On master: Close
[0m23:42:34.835449 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m23:42:34.835992 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m23:42:34.836442 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m23:42:34.836928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_silver, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_part)
[0m23:42:34.837374 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_gold, now model.dbt_thrive1_redshift_dw.stg_dim_conversation_start)
[0m23:42:34.837920 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.stg_dim_user'
[0m23:42:34.838335 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m23:42:34.838715 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m23:42:34.839054 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m23:42:34.843571 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_part"
[0m23:42:34.846706 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_conversation_start"
[0m23:42:34.849682 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_dim_user"
[0m23:42:34.851101 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m23:42:34.851389 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m23:42:34.851669 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m23:42:34.852177 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_user
[0m23:42:34.852643 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_part
[0m23:42:34.853085 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_dim_conversation_start
[0m23:42:34.853655 [debug] [Thread-4 (]: Began running node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m23:42:34.853916 [debug] [Thread-3 (]: Began running node model.dbt_thrive1_redshift_dw.dim_user
[0m23:42:34.854349 [debug] [Thread-2 (]: Began running node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m23:42:34.854771 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m23:42:34.855143 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.dbt_thrive1_redshift_dw.dim_conversation_part'
[0m23:42:34.855464 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_user, now model.dbt_thrive1_redshift_dw.dim_user)
[0m23:42:34.855717 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_conversation_start, now model.dbt_thrive1_redshift_dw.dim_conversation_start)
[0m23:42:34.855967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_dim_conversation_part, now model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages)
[0m23:42:34.856205 [debug] [Thread-4 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m23:42:34.856438 [debug] [Thread-3 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_user
[0m23:42:34.856667 [debug] [Thread-2 (]: Began compiling node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m23:42:34.856893 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m23:42:34.863562 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_conversation_part"
[0m23:42:34.866092 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_user"
[0m23:42:34.868555 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.dim_conversation_start"
[0m23:42:34.872222 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages"
[0m23:42:34.873917 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m23:42:34.874144 [debug] [Thread-4 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m23:42:34.874373 [debug] [Thread-2 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m23:42:34.874565 [debug] [Thread-3 (]: Began executing node model.dbt_thrive1_redshift_dw.dim_user
[0m23:42:34.874933 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages
[0m23:42:34.875269 [debug] [Thread-4 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_conversation_part
[0m23:42:34.875613 [debug] [Thread-2 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_conversation_start
[0m23:42:34.875924 [debug] [Thread-3 (]: Finished running node model.dbt_thrive1_redshift_dw.dim_user
[0m23:42:34.876492 [debug] [Thread-1 (]: Began running node model.dbt_thrive1_redshift_dw.fact_consolidated_messages
[0m23:42:34.876683 [debug] [Thread-4 (]: Began running node test.dbt_thrive1_redshift_dw.not_null_dim_user_email.0106225141
[0m23:42:34.876888 [debug] [Thread-2 (]: Began running node test.dbt_thrive1_redshift_dw.not_null_dim_user_is_customer.7081e9f4a9
[0m23:42:34.877055 [debug] [Thread-3 (]: Began running node test.dbt_thrive1_redshift_dw.not_null_dim_user_name.9399f44418
[0m23:42:34.877255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.stg_fact_consolidated_messages, now model.dbt_thrive1_redshift_dw.fact_consolidated_messages)
[0m23:42:34.877467 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.dim_conversation_part, now test.dbt_thrive1_redshift_dw.not_null_dim_user_email.0106225141)
[0m23:42:34.877665 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.dim_conversation_start, now test.dbt_thrive1_redshift_dw.not_null_dim_user_is_customer.7081e9f4a9)
[0m23:42:34.877862 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_thrive1_redshift_dw.dim_user, now test.dbt_thrive1_redshift_dw.not_null_dim_user_name.9399f44418)
[0m23:42:34.878058 [debug] [Thread-1 (]: Began compiling node model.dbt_thrive1_redshift_dw.fact_consolidated_messages
[0m23:42:34.878235 [debug] [Thread-4 (]: Began compiling node test.dbt_thrive1_redshift_dw.not_null_dim_user_email.0106225141
[0m23:42:34.878411 [debug] [Thread-2 (]: Began compiling node test.dbt_thrive1_redshift_dw.not_null_dim_user_is_customer.7081e9f4a9
[0m23:42:34.878590 [debug] [Thread-3 (]: Began compiling node test.dbt_thrive1_redshift_dw.not_null_dim_user_name.9399f44418
[0m23:42:34.880956 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_thrive1_redshift_dw.fact_consolidated_messages"
[0m23:42:34.887067 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_thrive1_redshift_dw.not_null_dim_user_email.0106225141"
[0m23:42:34.889111 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_thrive1_redshift_dw.not_null_dim_user_is_customer.7081e9f4a9"
[0m23:42:34.891045 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_thrive1_redshift_dw.not_null_dim_user_name.9399f44418"
[0m23:42:34.891701 [debug] [Thread-2 (]: Began executing node test.dbt_thrive1_redshift_dw.not_null_dim_user_is_customer.7081e9f4a9
[0m23:42:34.891897 [debug] [Thread-4 (]: Began executing node test.dbt_thrive1_redshift_dw.not_null_dim_user_email.0106225141
[0m23:42:34.892084 [debug] [Thread-1 (]: Began executing node model.dbt_thrive1_redshift_dw.fact_consolidated_messages
[0m23:42:34.892257 [debug] [Thread-3 (]: Began executing node test.dbt_thrive1_redshift_dw.not_null_dim_user_name.9399f44418
[0m23:42:34.892563 [debug] [Thread-2 (]: Finished running node test.dbt_thrive1_redshift_dw.not_null_dim_user_is_customer.7081e9f4a9
[0m23:42:34.892857 [debug] [Thread-4 (]: Finished running node test.dbt_thrive1_redshift_dw.not_null_dim_user_email.0106225141
[0m23:42:34.893148 [debug] [Thread-1 (]: Finished running node model.dbt_thrive1_redshift_dw.fact_consolidated_messages
[0m23:42:34.893407 [debug] [Thread-3 (]: Finished running node test.dbt_thrive1_redshift_dw.not_null_dim_user_name.9399f44418
[0m23:42:34.893580 [debug] [Thread-2 (]: Began running node test.dbt_thrive1_redshift_dw.not_null_dim_user_user_id.4b202b08a3
[0m23:42:34.893770 [debug] [Thread-4 (]: Began running node test.dbt_thrive1_redshift_dw.unique_dim_user_user_id.eff0a2a278
[0m23:42:34.894031 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_thrive1_redshift_dw.not_null_dim_user_is_customer.7081e9f4a9, now test.dbt_thrive1_redshift_dw.not_null_dim_user_user_id.4b202b08a3)
[0m23:42:34.894208 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_thrive1_redshift_dw.not_null_dim_user_email.0106225141, now test.dbt_thrive1_redshift_dw.unique_dim_user_user_id.eff0a2a278)
[0m23:42:34.894374 [debug] [Thread-2 (]: Began compiling node test.dbt_thrive1_redshift_dw.not_null_dim_user_user_id.4b202b08a3
[0m23:42:34.894528 [debug] [Thread-4 (]: Began compiling node test.dbt_thrive1_redshift_dw.unique_dim_user_user_id.eff0a2a278
[0m23:42:34.896433 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_thrive1_redshift_dw.not_null_dim_user_user_id.4b202b08a3"
[0m23:42:34.899280 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_thrive1_redshift_dw.unique_dim_user_user_id.eff0a2a278"
[0m23:42:34.899632 [debug] [Thread-2 (]: Began executing node test.dbt_thrive1_redshift_dw.not_null_dim_user_user_id.4b202b08a3
[0m23:42:34.899796 [debug] [Thread-4 (]: Began executing node test.dbt_thrive1_redshift_dw.unique_dim_user_user_id.eff0a2a278
[0m23:42:34.900070 [debug] [Thread-2 (]: Finished running node test.dbt_thrive1_redshift_dw.not_null_dim_user_user_id.4b202b08a3
[0m23:42:34.900334 [debug] [Thread-4 (]: Finished running node test.dbt_thrive1_redshift_dw.unique_dim_user_user_id.eff0a2a278
[0m23:42:34.900842 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:42:34.900979 [debug] [MainThread]: Connection 'model.dbt_thrive1_redshift_dw.fact_consolidated_messages' was properly closed.
[0m23:42:34.901102 [debug] [MainThread]: Connection 'test.dbt_thrive1_redshift_dw.not_null_dim_user_user_id.4b202b08a3' was properly closed.
[0m23:42:34.901219 [debug] [MainThread]: Connection 'test.dbt_thrive1_redshift_dw.not_null_dim_user_name.9399f44418' was properly closed.
[0m23:42:34.901331 [debug] [MainThread]: Connection 'test.dbt_thrive1_redshift_dw.unique_dim_user_user_id.eff0a2a278' was properly closed.
[0m23:42:34.902135 [debug] [MainThread]: Command end result
[0m23:42:34.914508 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m23:42:34.915201 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m23:42:34.918481 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/run_results.json
[0m23:42:34.920554 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.0072896, "process_in_blocks": "0", "process_kernel_time": 0.246121, "process_mem_max_rss": "142245888", "process_out_blocks": "0", "process_user_time": 1.260758}
[0m23:42:34.920763 [debug] [MainThread]: Command `dbt compile` succeeded at 23:42:34.920727 after 2.01 seconds
[0m23:42:34.920952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ccffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107caf010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046bd050>]}
[0m23:42:34.921144 [debug] [MainThread]: Flushing usage events
[0m23:42:35.161898 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:43:12.302911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105886850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105678210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058d3ad0>]}


============================== 23:43:12.305839 | 7f39b7fa-a1a1-4209-9414-1024bdd885be ==============================
[0m23:43:12.305839 [info ] [MainThread]: Running with dbt=1.10.0-b2
[0m23:43:12.306264 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/logs', 'version_check': 'True', 'profiles_dir': '/Users/henk/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:43:12.397336 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m23:43:12.397709 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m23:43:12.494452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f39b7fa-a1a1-4209-9414-1024bdd885be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105886990>]}
[0m23:43:12.519519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f39b7fa-a1a1-4209-9414-1024bdd885be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030a9050>]}
[0m23:43:12.520208 [info ] [MainThread]: Registered adapter: redshift=1.9.3
[0m23:43:12.581163 [debug] [MainThread]: checksum: 5a225a3ea19c91174578d2c3f7f3bd92801a2649697bdcbd194e936bd8925adb, vars: {}, profile: , target: , version: 1.10.0b2
[0m23:43:12.649757 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:43:12.649967 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:43:12.666647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f39b7fa-a1a1-4209-9414-1024bdd885be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bbb190>]}
[0m23:43:12.699181 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m23:43:12.702535 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m23:43:12.715196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f39b7fa-a1a1-4209-9414-1024bdd885be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eae250>]}
[0m23:43:12.715486 [info ] [MainThread]: Found 8 models, 5 data tests, 505 macros
[0m23:43:12.715663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f39b7fa-a1a1-4209-9414-1024bdd885be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10646f5d0>]}
[0m23:43:12.716608 [info ] [MainThread]: 
[0m23:43:12.716782 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:43:12.716911 [info ] [MainThread]: 
[0m23:43:12.717152 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m23:43:12.719083 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev_dev_silver'
[0m23:43:12.719319 [debug] [ThreadPool]: Acquiring new redshift connection 'list_thrivedev_dev_gold'
[0m23:43:12.728142 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_silver"
[0m23:43:12.730248 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_gold"
[0m23:43:12.730473 [debug] [ThreadPool]: On list_thrivedev_dev_silver: BEGIN
[0m23:43:12.730625 [debug] [ThreadPool]: On list_thrivedev_dev_gold: BEGIN
[0m23:43:12.730786 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:12.730916 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:12.731080 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m23:43:12.731221 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m23:43:12.733172 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:43:12.733371 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:43:13.280169 [debug] [ThreadPool]: SQL status: SUCCESS in 0.549 seconds
[0m23:43:13.282403 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_gold"
[0m23:43:13.283521 [debug] [ThreadPool]: On list_thrivedev_dev_gold: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_gold"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_gold'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_gold'
[0m23:43:13.284103 [debug] [ThreadPool]: SQL status: SUCCESS in 0.553 seconds
[0m23:43:13.284757 [debug] [ThreadPool]: Using redshift connection "list_thrivedev_dev_silver"
[0m23:43:13.285587 [debug] [ThreadPool]: On list_thrivedev_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "list_thrivedev_dev_silver"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_silver'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_silver'
[0m23:43:13.382290 [debug] [ThreadPool]: SQL status: SUCCESS in 0.096 seconds
[0m23:43:13.421811 [debug] [ThreadPool]: SQL status: SUCCESS in 0.137 seconds
[0m23:43:13.444303 [debug] [ThreadPool]: On list_thrivedev_dev_silver: ROLLBACK
[0m23:43:13.444920 [debug] [ThreadPool]: On list_thrivedev_dev_gold: ROLLBACK
[0m23:43:13.515744 [debug] [ThreadPool]: On list_thrivedev_dev_gold: Close
[0m23:43:13.515944 [debug] [ThreadPool]: On list_thrivedev_dev_silver: Close
[0m23:43:13.522292 [debug] [MainThread]: Using redshift connection "master"
[0m23:43:13.522537 [debug] [MainThread]: On master: BEGIN
[0m23:43:13.522716 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:43:13.522905 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m23:43:13.523167 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:43:13.964681 [debug] [MainThread]: SQL status: SUCCESS in 0.441 seconds
[0m23:43:13.967029 [debug] [MainThread]: Using redshift connection "master"
[0m23:43:13.968124 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m23:43:14.093535 [debug] [MainThread]: SQL status: SUCCESS in 0.124 seconds
[0m23:43:14.101666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f39b7fa-a1a1-4209-9414-1024bdd885be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071dc910>]}
[0m23:43:14.102567 [debug] [MainThread]: On master: ROLLBACK
[0m23:43:14.172994 [debug] [MainThread]: Using redshift connection "master"
[0m23:43:14.174045 [debug] [MainThread]: On master: BEGIN
[0m23:43:14.206848 [debug] [MainThread]: SQL status: SUCCESS in 0.032 seconds
[0m23:43:14.208282 [debug] [MainThread]: On master: COMMIT
[0m23:43:14.209443 [debug] [MainThread]: Using redshift connection "master"
[0m23:43:14.210477 [debug] [MainThread]: On master: COMMIT
[0m23:43:14.270605 [debug] [MainThread]: SQL status: SUCCESS in 0.059 seconds
[0m23:43:14.271991 [debug] [MainThread]: On master: Close
[0m23:43:14.278716 [debug] [Thread-1 (]: Began running node test.dbt_thrive1_redshift_dw.not_null_dim_user_email.0106225141
[0m23:43:14.279231 [debug] [Thread-2 (]: Began running node test.dbt_thrive1_redshift_dw.not_null_dim_user_is_customer.7081e9f4a9
[0m23:43:14.279701 [debug] [Thread-3 (]: Began running node test.dbt_thrive1_redshift_dw.not_null_dim_user_name.9399f44418
[0m23:43:14.280431 [debug] [Thread-4 (]: Began running node test.dbt_thrive1_redshift_dw.not_null_dim_user_user_id.4b202b08a3
[0m23:43:14.280100 [info ] [Thread-1 (]: 1 of 5 START test not_null_dim_user_email ...................................... [RUN]
[0m23:43:14.280958 [info ] [Thread-2 (]: 2 of 5 START test not_null_dim_user_is_customer ................................ [RUN]
[0m23:43:14.281347 [info ] [Thread-3 (]: 3 of 5 START test not_null_dim_user_name ....................................... [RUN]
[0m23:43:14.281831 [info ] [Thread-4 (]: 4 of 5 START test not_null_dim_user_user_id .................................... [RUN]
[0m23:43:14.282454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_silver, now test.dbt_thrive1_redshift_dw.not_null_dim_user_email.0106225141)
[0m23:43:14.282909 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_thrivedev_dev_gold, now test.dbt_thrive1_redshift_dw.not_null_dim_user_is_customer.7081e9f4a9)
[0m23:43:14.283405 [debug] [Thread-3 (]: Acquiring new redshift connection 'test.dbt_thrive1_redshift_dw.not_null_dim_user_name.9399f44418'
[0m23:43:14.283868 [debug] [Thread-4 (]: Acquiring new redshift connection 'test.dbt_thrive1_redshift_dw.not_null_dim_user_user_id.4b202b08a3'
[0m23:43:14.284543 [debug] [Thread-1 (]: Began compiling node test.dbt_thrive1_redshift_dw.not_null_dim_user_email.0106225141
[0m23:43:14.284907 [debug] [Thread-2 (]: Began compiling node test.dbt_thrive1_redshift_dw.not_null_dim_user_is_customer.7081e9f4a9
[0m23:43:14.285210 [debug] [Thread-3 (]: Began compiling node test.dbt_thrive1_redshift_dw.not_null_dim_user_name.9399f44418
[0m23:43:14.285497 [debug] [Thread-4 (]: Began compiling node test.dbt_thrive1_redshift_dw.not_null_dim_user_user_id.4b202b08a3
[0m23:43:14.297506 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_thrive1_redshift_dw.not_null_dim_user_email.0106225141"
[0m23:43:14.300928 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_thrive1_redshift_dw.not_null_dim_user_is_customer.7081e9f4a9"
[0m23:43:14.303714 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_thrive1_redshift_dw.not_null_dim_user_name.9399f44418"
[0m23:43:14.306519 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_thrive1_redshift_dw.not_null_dim_user_user_id.4b202b08a3"
[0m23:43:14.307324 [debug] [Thread-1 (]: Began executing node test.dbt_thrive1_redshift_dw.not_null_dim_user_email.0106225141
[0m23:43:14.307665 [debug] [Thread-2 (]: Began executing node test.dbt_thrive1_redshift_dw.not_null_dim_user_is_customer.7081e9f4a9
[0m23:43:14.323142 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_thrive1_redshift_dw.not_null_dim_user_email.0106225141"
[0m23:43:14.323441 [debug] [Thread-3 (]: Began executing node test.dbt_thrive1_redshift_dw.not_null_dim_user_name.9399f44418
[0m23:43:14.323827 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_thrive1_redshift_dw.not_null_dim_user_is_customer.7081e9f4a9"
[0m23:43:14.324053 [debug] [Thread-4 (]: Began executing node test.dbt_thrive1_redshift_dw.not_null_dim_user_user_id.4b202b08a3
[0m23:43:14.325402 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_thrive1_redshift_dw.not_null_dim_user_name.9399f44418"
[0m23:43:14.326823 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_thrive1_redshift_dw.not_null_dim_user_user_id.4b202b08a3"
[0m23:43:14.327836 [debug] [Thread-1 (]: Using redshift connection "test.dbt_thrive1_redshift_dw.not_null_dim_user_email.0106225141"
[0m23:43:14.328560 [debug] [Thread-4 (]: Using redshift connection "test.dbt_thrive1_redshift_dw.not_null_dim_user_user_id.4b202b08a3"
[0m23:43:14.329193 [debug] [Thread-3 (]: Using redshift connection "test.dbt_thrive1_redshift_dw.not_null_dim_user_name.9399f44418"
[0m23:43:14.329357 [debug] [Thread-1 (]: On test.dbt_thrive1_redshift_dw.not_null_dim_user_email.0106225141: BEGIN
[0m23:43:14.330011 [debug] [Thread-2 (]: Using redshift connection "test.dbt_thrive1_redshift_dw.not_null_dim_user_is_customer.7081e9f4a9"
[0m23:43:14.330212 [debug] [Thread-4 (]: On test.dbt_thrive1_redshift_dw.not_null_dim_user_user_id.4b202b08a3: BEGIN
[0m23:43:14.330403 [debug] [Thread-3 (]: On test.dbt_thrive1_redshift_dw.not_null_dim_user_name.9399f44418: BEGIN
[0m23:43:14.330586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:43:14.330759 [debug] [Thread-2 (]: On test.dbt_thrive1_redshift_dw.not_null_dim_user_is_customer.7081e9f4a9: BEGIN
[0m23:43:14.330924 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:43:14.331083 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:43:14.332297 [debug] [Thread-1 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m23:43:14.332470 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:43:14.332649 [debug] [Thread-4 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m23:43:14.332823 [debug] [Thread-3 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m23:43:14.333081 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:43:14.333263 [debug] [Thread-2 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m23:43:14.333487 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:43:14.333700 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:43:14.334971 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:43:14.799246 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.468 seconds
[0m23:43:14.799702 [debug] [Thread-4 (]: Using redshift connection "test.dbt_thrive1_redshift_dw.not_null_dim_user_user_id.4b202b08a3"
[0m23:43:14.799977 [debug] [Thread-4 (]: On test.dbt_thrive1_redshift_dw.not_null_dim_user_user_id.4b202b08a3: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "test.dbt_thrive1_redshift_dw.not_null_dim_user_user_id.4b202b08a3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "thrivedev"."dev_gold"."dim_user"
where user_id is null



      
    ) dbt_internal_test
[0m23:43:14.864311 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.532 seconds
[0m23:43:14.864825 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.534 seconds
[0m23:43:14.865304 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.534 seconds
[0m23:43:14.865665 [debug] [Thread-2 (]: Using redshift connection "test.dbt_thrive1_redshift_dw.not_null_dim_user_is_customer.7081e9f4a9"
[0m23:43:14.866071 [debug] [Thread-1 (]: Using redshift connection "test.dbt_thrive1_redshift_dw.not_null_dim_user_email.0106225141"
[0m23:43:14.866454 [debug] [Thread-3 (]: Using redshift connection "test.dbt_thrive1_redshift_dw.not_null_dim_user_name.9399f44418"
[0m23:43:14.866852 [debug] [Thread-2 (]: On test.dbt_thrive1_redshift_dw.not_null_dim_user_is_customer.7081e9f4a9: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "test.dbt_thrive1_redshift_dw.not_null_dim_user_is_customer.7081e9f4a9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_customer
from "thrivedev"."dev_gold"."dim_user"
where is_customer is null



      
    ) dbt_internal_test
[0m23:43:14.867283 [debug] [Thread-1 (]: On test.dbt_thrive1_redshift_dw.not_null_dim_user_email.0106225141: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "test.dbt_thrive1_redshift_dw.not_null_dim_user_email.0106225141"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select email
from "thrivedev"."dev_gold"."dim_user"
where email is null



      
    ) dbt_internal_test
[0m23:43:14.867684 [debug] [Thread-3 (]: On test.dbt_thrive1_redshift_dw.not_null_dim_user_name.9399f44418: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "test.dbt_thrive1_redshift_dw.not_null_dim_user_name.9399f44418"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "thrivedev"."dev_gold"."dim_user"
where name is null



      
    ) dbt_internal_test
[0m23:43:19.194208 [debug] [Thread-4 (]: SQL status: SUCCESS in 4.393 seconds
[0m23:43:19.195716 [debug] [Thread-2 (]: SQL status: SUCCESS in 4.328 seconds
[0m23:43:19.196171 [debug] [Thread-1 (]: SQL status: SUCCESS in 4.328 seconds
[0m23:43:19.196607 [debug] [Thread-3 (]: SQL status: SUCCESS in 4.328 seconds
[0m23:43:19.203269 [debug] [Thread-4 (]: On test.dbt_thrive1_redshift_dw.not_null_dim_user_user_id.4b202b08a3: ROLLBACK
[0m23:43:19.205150 [debug] [Thread-2 (]: On test.dbt_thrive1_redshift_dw.not_null_dim_user_is_customer.7081e9f4a9: ROLLBACK
[0m23:43:19.206648 [debug] [Thread-1 (]: On test.dbt_thrive1_redshift_dw.not_null_dim_user_email.0106225141: ROLLBACK
[0m23:43:19.207923 [debug] [Thread-3 (]: On test.dbt_thrive1_redshift_dw.not_null_dim_user_name.9399f44418: ROLLBACK
[0m23:43:19.359893 [debug] [Thread-1 (]: On test.dbt_thrive1_redshift_dw.not_null_dim_user_email.0106225141: Close
[0m23:43:19.363236 [info ] [Thread-1 (]: 1 of 5 PASS not_null_dim_user_email ............................................ [[32mPASS[0m in 5.08s]
[0m23:43:19.364603 [debug] [Thread-1 (]: Finished running node test.dbt_thrive1_redshift_dw.not_null_dim_user_email.0106225141
[0m23:43:19.365232 [debug] [Thread-1 (]: Began running node test.dbt_thrive1_redshift_dw.unique_dim_user_user_id.eff0a2a278
[0m23:43:19.365881 [info ] [Thread-1 (]: 5 of 5 START test unique_dim_user_user_id ...................................... [RUN]
[0m23:43:19.366564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_thrive1_redshift_dw.not_null_dim_user_email.0106225141, now test.dbt_thrive1_redshift_dw.unique_dim_user_user_id.eff0a2a278)
[0m23:43:19.367052 [debug] [Thread-1 (]: Began compiling node test.dbt_thrive1_redshift_dw.unique_dim_user_user_id.eff0a2a278
[0m23:43:19.375811 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_thrive1_redshift_dw.unique_dim_user_user_id.eff0a2a278"
[0m23:43:19.376234 [debug] [Thread-4 (]: On test.dbt_thrive1_redshift_dw.not_null_dim_user_user_id.4b202b08a3: Close
[0m23:43:19.376434 [debug] [Thread-2 (]: On test.dbt_thrive1_redshift_dw.not_null_dim_user_is_customer.7081e9f4a9: Close
[0m23:43:19.376601 [debug] [Thread-3 (]: On test.dbt_thrive1_redshift_dw.not_null_dim_user_name.9399f44418: Close
[0m23:43:19.377793 [info ] [Thread-4 (]: 4 of 5 PASS not_null_dim_user_user_id .......................................... [[32mPASS[0m in 5.09s]
[0m23:43:19.380249 [debug] [Thread-4 (]: Finished running node test.dbt_thrive1_redshift_dw.not_null_dim_user_user_id.4b202b08a3
[0m23:43:19.380606 [debug] [Thread-1 (]: Began executing node test.dbt_thrive1_redshift_dw.unique_dim_user_user_id.eff0a2a278
[0m23:43:19.378746 [info ] [Thread-2 (]: 2 of 5 PASS not_null_dim_user_is_customer ...................................... [[32mPASS[0m in 5.10s]
[0m23:43:19.379712 [info ] [Thread-3 (]: 3 of 5 PASS not_null_dim_user_name ............................................. [[32mPASS[0m in 5.10s]
[0m23:43:19.383490 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_thrive1_redshift_dw.unique_dim_user_user_id.eff0a2a278"
[0m23:43:19.383993 [debug] [Thread-2 (]: Finished running node test.dbt_thrive1_redshift_dw.not_null_dim_user_is_customer.7081e9f4a9
[0m23:43:19.384397 [debug] [Thread-3 (]: Finished running node test.dbt_thrive1_redshift_dw.not_null_dim_user_name.9399f44418
[0m23:43:19.386412 [debug] [Thread-1 (]: Using redshift connection "test.dbt_thrive1_redshift_dw.unique_dim_user_user_id.eff0a2a278"
[0m23:43:19.386789 [debug] [Thread-1 (]: On test.dbt_thrive1_redshift_dw.unique_dim_user_user_id.eff0a2a278: BEGIN
[0m23:43:19.387068 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:43:19.387354 [debug] [Thread-1 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m23:43:19.387723 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:43:19.909462 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.521 seconds
[0m23:43:19.911607 [debug] [Thread-1 (]: Using redshift connection "test.dbt_thrive1_redshift_dw.unique_dim_user_user_id.eff0a2a278"
[0m23:43:19.912530 [debug] [Thread-1 (]: On test.dbt_thrive1_redshift_dw.unique_dim_user_user_id.eff0a2a278: /* {"app": "dbt", "dbt_version": "1.10.0b2", "profile_name": "dbt_thrive1_redshift_dw", "target_name": "dev", "node_id": "test.dbt_thrive1_redshift_dw.unique_dim_user_user_id.eff0a2a278"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "thrivedev"."dev_gold"."dim_user"
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:43:24.689419 [debug] [Thread-1 (]: SQL status: SUCCESS in 4.776 seconds
[0m23:43:24.692348 [debug] [Thread-1 (]: On test.dbt_thrive1_redshift_dw.unique_dim_user_user_id.eff0a2a278: ROLLBACK
[0m23:43:24.751352 [debug] [Thread-1 (]: On test.dbt_thrive1_redshift_dw.unique_dim_user_user_id.eff0a2a278: Close
[0m23:43:24.752021 [info ] [Thread-1 (]: 5 of 5 PASS unique_dim_user_user_id ............................................ [[32mPASS[0m in 5.39s]
[0m23:43:24.752356 [debug] [Thread-1 (]: Finished running node test.dbt_thrive1_redshift_dw.unique_dim_user_user_id.eff0a2a278
[0m23:43:24.753193 [debug] [MainThread]: Using redshift connection "master"
[0m23:43:24.753379 [debug] [MainThread]: On master: BEGIN
[0m23:43:24.753535 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:43:24.753705 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m23:43:24.753944 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:43:25.162069 [debug] [MainThread]: SQL status: SUCCESS in 0.408 seconds
[0m23:43:25.164111 [debug] [MainThread]: On master: COMMIT
[0m23:43:25.165461 [debug] [MainThread]: Using redshift connection "master"
[0m23:43:25.165917 [debug] [MainThread]: On master: COMMIT
[0m23:43:25.217233 [debug] [MainThread]: SQL status: SUCCESS in 0.051 seconds
[0m23:43:25.218726 [debug] [MainThread]: On master: Close
[0m23:43:25.220577 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:43:25.221044 [debug] [MainThread]: Connection 'test.dbt_thrive1_redshift_dw.unique_dim_user_user_id.eff0a2a278' was properly closed.
[0m23:43:25.221407 [debug] [MainThread]: Connection 'test.dbt_thrive1_redshift_dw.not_null_dim_user_is_customer.7081e9f4a9' was properly closed.
[0m23:43:25.221796 [debug] [MainThread]: Connection 'test.dbt_thrive1_redshift_dw.not_null_dim_user_name.9399f44418' was properly closed.
[0m23:43:25.222539 [debug] [MainThread]: Connection 'test.dbt_thrive1_redshift_dw.not_null_dim_user_user_id.4b202b08a3' was properly closed.
[0m23:43:25.223269 [info ] [MainThread]: 
[0m23:43:25.223780 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 12.51 seconds (12.51s).
[0m23:43:25.225311 [debug] [MainThread]: Command end result
[0m23:43:25.260366 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/manifest.json
[0m23:43:25.261951 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/semantic_manifest.json
[0m23:43:25.266137 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/henk/Documents/DataProjects/Projects/dbt-thrive-eng/dbt_thrive1_redshift_dw/target/run_results.json
[0m23:43:25.266343 [info ] [MainThread]: 
[0m23:43:25.266562 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:43:25.266737 [info ] [MainThread]: 
[0m23:43:25.266923 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m23:43:25.269471 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 13.001876, "process_in_blocks": "0", "process_kernel_time": 0.269943, "process_mem_max_rss": "144982016", "process_out_blocks": "0", "process_user_time": 1.682672}
[0m23:43:25.269721 [debug] [MainThread]: Command `dbt test` succeeded at 23:43:25.269666 after 13.00 seconds
[0m23:43:25.269940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10172dd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1017c8390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1017c8dd0>]}
[0m23:43:25.270163 [debug] [MainThread]: Flushing usage events
[0m23:43:25.435900 [debug] [MainThread]: An error was encountered while trying to flush usage events
